#include "../inst/include/etr.hpp"
using namespace etr;
#include <cstring>

template<typename T>
auto compare_result(const T& etr, const std::vector<double>& expected) {
  auto compare = [](double l, double r) {
    double TOL = 1e-5;
    return std::abs(l - r) < TOL;
  };
  if (etr.size() != expected.size()) return false;
  for (std::size_t i = 0; i < etr.size(); i++) {
    if(!compare(get_val(etr.get(i)), expected[i])) return false;
  }
  return true;
}
template<typename T>
auto compare_result_dual(const T& etr,
                         const std::vector<double>& expected_val,
                         const std::vector<double>& expected_dot) {
  auto compare = [](double l, double r) {
    double TOL = 1e-5;
    return std::abs(l - r) < TOL;
  };
  if (etr.size() != expected_val.size()) return false;
  for (std::size_t i = 0; i < etr.size(); i++) {
    if(!compare(get_val(etr.get(i)), expected_val[i])) return false;
    if(!compare(etr.get(i).dot, expected_dot[i])) return false;
  }
  return true;
}
template<typename T, typename T2>
auto compare_result_reverse_ad(const T& etr, const T2& etr_expr,
                         const std::vector<double>& expected_val,
                         const std::vector<double>& expected_dot) {
  auto compare = [](double l, double r) {
    double TOL = 1e-5;
    return std::abs(l - r) < TOL;
  };
  if (etr.size() != expected_val.size()) return false;
  for (std::size_t i = 0; i < etr.size(); i++) {
    var temp = etr_expr.get(i);
    if(!compare(get_val(temp), expected_val[i])) return false;
    auto d = derivatives(temp, wrt(etr.get(i)));
    if(!compare(get_val(d[0]), expected_dot[i])) return false;
  }
  return true;
}

template<typename T1, typename T2, typename T3>
auto compare_result_reverse_ad_binary(const T1& etr1, const T2& etr2, const T3& etr_expr,
                                      const std::vector<double>& expected_val,
                                      const std::vector<double>& expected_dot1,
                                      const std::vector<double>& expected_dot2) {
  auto compare = [](double l, double r) {
    double TOL = 1e-5;
    return std::abs(l - r) < TOL;
  };

  if (etr_expr.size() != expected_val.size()) return false;
  for (std::size_t i = 0; i < etr_expr.size(); i++) {
    if(!compare(get_val(etr_expr.get(i)), expected_val[i])) return false;
  }

  // One is scalar
  if constexpr (IsADType<T1> || IsADType<T2> || IsArithV<T1> || IsArithV<T2>) {
    constexpr bool is_scalar_l = IsADType<T1> || IsArithV<T1>;
    constexpr bool is_scalar_r = IsADType<T2> || IsArithV<T2>;
    if constexpr (is_scalar_l && !is_scalar_r) {
      using DataTypeR = typename ExtractDataType<Decayed<T2>>::value_type;
      // Case 1: AD scalar && IsArray<ADType>
      if constexpr (IsADType<T1> && IsADType<DataTypeR>) {
        for (std::size_t i = 0; i < etr_expr.size(); i++) {
          var temp = etr_expr.get(i);
          auto d1 = derivatives(temp, wrt(etr1));
          auto d2 = derivatives(temp, wrt(etr2.get(i)));
          if(!compare(get_val(d1[0]), expected_dot1[i])) return false;
          if(!compare(get_val(d2[0]), expected_dot2[i])) return false;
        }
        return true;
      }
      // Case 2: AD scalar && IsArray<Other>
      else if constexpr (IsADType<T1> && !IsADType<DataTypeR>) {
        for (std::size_t i = 0; i < etr_expr.size(); i++) {
          var temp = etr_expr.get(i);
          auto d1 = derivatives(temp, wrt(etr1));
          if(!compare(get_val(d1[0]), expected_dot1[i])) return false;
        }
        return true;
      }
      // Case 3: Other && IsArray<ADType>
      else if constexpr (!IsADType<T1> && IsADType<DataTypeR>) {
        for (std::size_t i = 0; i < etr_expr.size(); i++) {
          var temp = etr_expr.get(i);
          auto d2 = derivatives(temp, wrt(etr2.get(i)));
          if(!compare(get_val(d2[0]), expected_dot2[i])) return false;
        }
        return true;
      }
    }
    else if constexpr (!is_scalar_l && is_scalar_r) {
      using DataTypeL = typename ExtractDataType<Decayed<T1>>::value_type;
      // Case 4: IsArray<ADType> && AD scalar
      if constexpr (IsADType<DataTypeL> && IsADType<T2>) {
        for (std::size_t i = 0; i < etr_expr.size(); i++) {
          var temp = etr_expr.get(i);
          auto d1 = derivatives(temp, wrt(etr1.get(i)));
          auto d2 = derivatives(temp, wrt(etr2));
          if(!compare(get_val(d1[0]), expected_dot1[i])) return false;
          if(!compare(get_val(d2[0]), expected_dot2[i])) return false;
        }
        return true;
      }
      // Case 5: IsArray<Other> && AD scalar
      if constexpr (!IsADType<DataTypeL> && IsADType<T2>) {
        for (std::size_t i = 0; i < etr_expr.size(); i++) {
          var temp = etr_expr.get(i);
          auto d2 = derivatives(temp, wrt(etr2));
          if(!compare(get_val(d2[0]), expected_dot2[i])) return false;
        }
        return true;
      }
      // Case 6: IsArray<ADType> && Other
      if constexpr (IsADType<DataTypeL> && !IsADType<T2>) {
        for (std::size_t i = 0; i < etr_expr.size(); i++) {
          var temp = etr_expr.get(i);
          auto d1 = derivatives(temp, wrt(etr1.get(i)));
          if(!compare(get_val(d1[0]), expected_dot1[i])) return false;
        }
        return true;
      }
    }
  }

  // Only arrays
  else {
    using DataTypeL = typename ExtractDataType<Decayed<T1>>::value_type;
    using DataTypeR = typename ExtractDataType<Decayed<T2>>::value_type;

    // Case1: Array<AD> && Array<AD>
    if constexpr (IsADType<DataTypeL> && IsADType<DataTypeR>) {
      for (std::size_t i = 0; i < etr1.size(); i++) {
        var temp = etr_expr.get(i);
        auto d1 = derivatives(temp, wrt(etr1.get(i)));
        auto d2 = derivatives(temp, wrt(etr2.get(i)));
        if(!compare(get_val(d1[0]), expected_dot1[i])) return false;
        if(!compare(get_val(d2[0]), expected_dot2[i])) return false;
      }
      return true;
    }

    // Case2: Array<AD> && !Array<AD>
    else if constexpr (IsADType<DataTypeL> && !IsADType<DataTypeR>) {
      for (std::size_t i = 0; i < etr1.size(); i++) {
        var temp = etr_expr.get(i);
        if(!compare(get_val(temp), expected_val[i])) return false;
        auto d1 = derivatives(temp, wrt(etr1.get(i)));
        if(!compare(get_val(d1[0]), expected_dot1[i])) return false;
      }
      return true;
    }

    // Case3: !Array<AD> && Array<AD>
    else if constexpr (!IsADType<DataTypeL> && IsADType<DataTypeR>) {
      for (std::size_t i = 0; i < etr1.size(); i++) {
        var temp = etr_expr.get(i);
        if(!compare(get_val(temp), expected_val[i])) return false;
        auto d2 = derivatives(temp, wrt(etr2.get(i)));
        if(!compare(get_val(d2[0]), expected_dot2[i])) return false;
      }
      return true;
    }

  }
}

// [[Rcpp::export]]
void test_calculation() {
  auto create_r_array = []() {
    Array<Double, Buffer<Double, RBufferTrait>> a_r(SI{60});
    for (std::size_t i = 0; i <a_r.size(); i++) {
      a_r.set(i, static_cast<double>(i) + 0.1);
    }
    a_r.dim.resize(3);
    a_r.dim[0] = 3;
    a_r.dim[1] = 4;
    a_r.dim[2] = 5;
    return a_r;
  };
  std::vector<double> expected_sin_logical_arr {
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000,
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000,
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000,
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000
  };
  std::vector<double> expected_sin_integer_arr {
    0.000000000,  0.841470985,  0.909297427,  0.141120008, -0.756802495, -0.958924275, -0.279415498,  0.656986599,  0.989358247,  0.412118485,
    -0.544021111, -0.999990207, -0.536572918,  0.420167037,  0.990607356,  0.650287840, -0.287903317, -0.961397492, -0.750987247,  0.149877210,
    0.912945251,  0.836655639, -0.008851309, -0.846220404, -0.905578362, -0.132351750,  0.762558450,  0.956375928,  0.270905788, -0.663633884,
    -0.988031624, -0.404037645,  0.551426681,  0.999911860,  0.529082686, -0.428182669, -0.991778853, -0.643538133,  0.296368579,  0.963795386,
    0.745113160, -0.158622669, -0.916521548, -0.831774743,  0.017701925,  0.850903525,  0.901788348,  0.123573123, -0.768254661, -0.953752653,
    -0.262374854,  0.670229176,  0.986627592,  0.395925150, -0.558789049, -0.999755173, -0.521551002,  0.436164755,  0.992872648,  0.636738007
  };
  std::vector<double> expected_sin_double_arr {
    0.09983342,  0.89120736,  0.86320937,  0.04158066, -0.81827711, -0.92581468, -0.18216250,  0.72896904,  0.96988981,  0.31909836, -0.62507065,
    -0.99455259, -0.44964746,  0.50866146,  0.99930939,  0.57119687, -0.38207142, -0.98406501, -0.68131377,  0.24783421,  0.94912455,  0.77779416,
    -0.10863660, -0.89518737, -0.85870700, -0.03273538,  0.82333300,  0.92243282,  0.17345216, -0.73499962, -0.96769613, -0.31069729,  0.63195521,
    0.99359100,  0.44172381, -0.51626222, -0.99959914, -0.56390922,  0.39023624,  0.98560030,  0.67480799, -0.25639967, -0.95187466, -0.77220048,
    0.11743126,  0.89909724,  0.85413736,  0.02388753, -0.82832438, -0.91897868, -0.16472822,  0.74097261,  0.96542664,  0.30227187, -0.63879027,
    -0.99255157, -0.43376554,  0.52382253,  0.99981058,  0.55657740
  };
  std::vector<double> expected_sin_dual_dot_arr {
    0.99500417,  0.45359612, -0.50484610, -0.99913515, -0.57482395,  0.37797774,  0.98326844,  0.68454667, -0.24354415, -0.94772160, -0.78056818,
    0.10423603,  0.89320611,  0.86096662,  0.03715838, -0.82081309, -0.92413280, -0.17780907,  0.73199150,  0.96880246,  0.31490091, -0.62851909,
    -0.99408153, -0.44569000,  0.51246686,  0.99946405,  0.56755860, -0.38615761, -0.98484230, -0.67806752,  0.25211941,  0.95050891,  0.77500491,
    -0.11303504, -0.89715109, -0.85643057, -0.02831173,  0.82583678,  0.92071477,  0.16909184, -0.73799334, -0.96657085, -0.30648758,  0.63537896,
    0.99308101,  0.43774896, -0.52004747, -0.99971465, -0.56024880,  0.39430722,  0.98633900,  0.67153525, -0.26067491, -0.95322176, -0.76938092,
    0.12182519,  0.90102578,  0.85182742,  0.01946286, -0.83079576
  };
  std::vector<double> expected_sin_of_unary_minus {
    -0.09983342, -0.89120736, -0.86320937, -0.04158066,  0.81827711,  0.92581468,  0.18216250, -0.72896904, -0.96988981, -0.31909836,
    0.62507065,  0.99455259,  0.44964746, -0.50866146, -0.99930939, -0.57119687,  0.38207142,  0.98406501,  0.68131377, -0.24783421,
    -0.94912455, -0.77779416,  0.10863660,  0.89518737,  0.85870700,  0.03273538, -0.82333300, -0.92243282, -0.17345216,  0.73499962,
    0.96769613,  0.31069729, -0.63195521, -0.99359100, -0.44172381,  0.51626222,  0.99959914,  0.56390922, -0.39023624, -0.98560030,
    -0.67480799,  0.25639967,  0.95187466,  0.77220048, -0.11743126, -0.89909724, -0.85413736, -0.02388753,  0.82832438,  0.91897868,
    0.16472822, -0.74097261, -0.96542664, -0.30227187,  0.63879027,  0.99255157,  0.43376554, -0.52382253, -0.99981058, -0.55657740
  };
  std::vector<double> expected_sin_of_plus {
    0.19866933,  0.80849640, -0.87157577, -0.08308940,  0.94073056, -0.69987469, -0.35822928,  0.99802665, -0.47242199, -0.60483282,
    0.97582052, -0.20733642, -0.80325573,  0.87588108,  0.07426545, -0.93769174,  0.70616946,  0.34995137, -0.99743177,  0.48020478,
    0.59776037, -0.97771695,  0.21598727,  0.79795212, -0.88011776, -0.06543567,  0.93457946, -0.71240890, -0.34164604,  0.99675874,
    -0.48794995, -0.59064108,  0.97953678, -0.22462119, -0.79258599,  0.88428549,  0.05660077, -0.93139395,  0.71859253,  0.33331394,
    -0.99600761,  0.49565689,  0.58347552, -0.98127987,  0.23323751,  0.78715777, -0.88838394, -0.04776143,  0.92813548, -0.72471986,
    -0.32495573,  0.99517845, -0.50332500, -0.57626424,  0.98294608, -0.24183557, -0.78166787,  0.89241279,  0.03891835, -0.92480429
  };

  const std::size_t N = 60;
  const std::vector<std::size_t> dim{3, 4, 5};
  //BinaryOperation, SubsetView, ConstSubsetView

  // 3 Scalar types
  Logical logical_etr = true;
  Integer integer_etr = 101;
  Double double_etr = 3.14;
  Dual dual_etr(3.14, 2.0);
  Variable<Double> rev_ad_etr = 3.14;

  // Buffers
  Array<Logical, Buffer<Logical, LBufferTrait>> Logical_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) {
    if (i % 3 == 0) Logical_arr.set(i, true);
  }
  Logical_arr.dim = dim;

  Array<Integer, Buffer<Integer, LBufferTrait>> Integer_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Integer_arr.set(i, i);
  Integer_arr.dim = dim;

  Array<Double, Buffer<Double, LBufferTrait>> Double_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Double_arr.set(i, static_cast<double>(i) + 0.1);
  Double_arr.dim = dim;

  Array<Dual, Buffer<Dual, LBufferTrait>> Dual_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Dual_arr.set(i, Dual(static_cast<double>(i) + 0.1, 2.0));
  Dual_arr.dim = dim;

  using RealType = Variable<Double>;
  Array<RealType, Buffer<RealType, LBufferTrait>> rev_ad_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) rev_ad_arr.set(i, Double(static_cast<double>(i) + 0.1));
   rev_ad_arr.dim = dim;

  // R Buffers
  Array<Logical, Buffer<Logical, RBufferTrait>> Logical_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) {
    if (i % 3 == 0) Logical_r_arr.set(i, true);
  }
  Logical_r_arr.dim = dim;

  Array<Integer, Buffer<Integer, RBufferTrait>> Integer_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Integer_r_arr.set(i, i);
  Integer_r_arr.dim = dim;

  Array<Double, Buffer<Double, RBufferTrait>> Double_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Double_r_arr.set(i, static_cast<double>(i) + 0.1);
  Double_r_arr.dim = dim;

  Array<Dual, Buffer<Dual, RBufferTrait>> Dual_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Dual_r_arr.set(i, Dual(static_cast<double>(i) + 0.1, 2.0));
  Dual_r_arr.dim = dim;

  Array<RealType, Buffer<RealType, RBufferTrait>> rev_ad_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) rev_ad_r_arr.set(i, Double(static_cast<double>(i) + 0.1));
  rev_ad_r_arr.dim = dim;

  // Borrows
  std::array<bool, N> logical_owner;
  std::vector<int> integer_owner(N);
  std::vector<double> double_owner(N);
  std::vector<double> dual_val_owner(N);
  std::vector<double> dual_dot_owner(N);
  std::vector<double> ad_owner(N);
  for (std::size_t i = 0; i < N; i++) {
    if (i % 3 == 0) logical_owner[i] = true; else logical_owner[i] = false;
    integer_owner[i] = i;
    double_owner[i] = static_cast<double>(i) + 0.1;
    ad_owner[i] = static_cast<double>(i) + 0.1;
    dual_val_owner[i] = static_cast<double>(i) + 0.1;
    dual_dot_owner[i] = 2.0;
  }
  Array<Logical, Borrow<Logical, BorrowTrait>> Logical_borrowed_arr(logical_owner.data(), N, dim);
  Array<Integer, Borrow<Integer, BorrowTrait>> Integer_borrowed_arr(integer_owner.data(), N, dim);
  Array<Double, Borrow<Double, BorrowTrait>> Double_borrowed_arr(double_owner.data(), N, dim);
  Array<Dual, Borrow<Dual, BorrowTrait>> Dual_borrowed_arr(dual_val_owner.data(), dual_dot_owner.data(), N, dim);

  // Unary Operation
  auto unary = sin(Double_arr);

  // BinaryOperation
  auto binary = Double_arr + Double_arr;

  // SubsetView
  auto sub = subset(Double_arr, true, true, true);

  // Unary Operation combinations
  ass<"sin logical arr">(compare_result(sin(Logical_arr), expected_sin_logical_arr));
  ass<"sin integer arr">(compare_result(sin(Integer_arr), expected_sin_integer_arr));
  ass<"sin double arr">(compare_result(sin(Double_arr), expected_sin_double_arr));
  ass<"sin dual arr">(compare_result_dual(sin(Dual_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));
  ass<"sin AD arr">(compare_result_reverse_ad(rev_ad_arr, sin(rev_ad_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));

  ass<"sin logical r arr">(compare_result(sin(Logical_r_arr), expected_sin_logical_arr));
  ass<"sin integer r arr">(compare_result(sin(Integer_r_arr), expected_sin_integer_arr));
  ass<"sin double r arr">(compare_result(sin(Double_r_arr), expected_sin_double_arr));
  ass<"sin dual r arr">(compare_result_dual(sin(Dual_r_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));
  ass<"sin AD r arr">(compare_result_reverse_ad(rev_ad_arr, sin(rev_ad_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));

  ass<"sin logical borrow arr">(compare_result(sin(Logical_borrowed_arr), expected_sin_logical_arr));
  ass<"sin integer borrow arr">(compare_result(sin(Integer_borrowed_arr), expected_sin_integer_arr));
  ass<"sin double borrow arr">(compare_result(sin(Double_borrowed_arr), expected_sin_double_arr));
  ass<"sin dual borrow arr">(compare_result_dual(sin(Dual_borrowed_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));

  ass<"sin of unary">(compare_result(sin(-Double_arr), expected_sin_of_unary_minus));
  ass<"sin of binary">(compare_result(sin(Double_arr + Double_arr), expected_sin_of_plus));
  ass<"sin of subset">(compare_result(sin(sub), expected_sin_double_arr));
  ass<"sin of r array (R value in the C++ sense)">(compare_result(sin(create_r_array()), expected_sin_double_arr));
  ass<"sin of const sub">(compare_result(sin(subset(create_r_array(), true, true, true)), expected_sin_double_arr));
  ass<"sin of r valeu">(compare_result(sin(create_r_array()), expected_sin_double_arr));

  // --------------------------------------------------------------------------------
  // Generated by: generate_tests_calculations.R
  // --------------------------------------------------------------------------------
  std::vector<double> expected1{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * logical_etr">(compare_result(Logical_arr * logical_etr, expected1));
      
  std::vector<double> expected2{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"Integer_arr * logical_etr">(compare_result(Integer_arr * logical_etr, expected2));
      
  std::vector<double> expected3{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"Double_arr * logical_etr">(compare_result(Double_arr * logical_etr, expected3));
      
  std::vector<double> expected4{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot4{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: Dual_arr * logical_etr">(compare_result_dual(Dual_arr * logical_etr, expected4, expected_dot4));
        
  std::vector<double> expected5{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot_l5{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
 std::vector<double> expected_dot_r5{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * logical_etr">(compare_result_reverse_ad_binary(rev_ad_arr, logical_etr, rev_ad_arr * logical_etr, expected5, expected_dot_l5, expected_dot_r5));
        
  std::vector<double> expected6{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * logical_etr">(compare_result(Logical_r_arr * logical_etr, expected6));
      
  std::vector<double> expected7{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"Integer_r_arr * logical_etr">(compare_result(Integer_r_arr * logical_etr, expected7));
      
  std::vector<double> expected8{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"Double_r_arr * logical_etr">(compare_result(Double_r_arr * logical_etr, expected8));
      
  std::vector<double> expected9{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot9{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: Dual_r_arr * logical_etr">(compare_result_dual(Dual_r_arr * logical_etr, expected9, expected_dot9));
        
  std::vector<double> expected10{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot_l10{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
 std::vector<double> expected_dot_r10{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * logical_etr">(compare_result_reverse_ad_binary(rev_ad_r_arr, logical_etr, rev_ad_r_arr * logical_etr, expected10, expected_dot_l10, expected_dot_r10));
        
  std::vector<double> expected11{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * logical_etr">(compare_result(Logical_borrowed_arr * logical_etr, expected11));
      
  std::vector<double> expected12{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"Integer_borrowed_arr * logical_etr">(compare_result(Integer_borrowed_arr * logical_etr, expected12));
      
  std::vector<double> expected13{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"Double_borrowed_arr * logical_etr">(compare_result(Double_borrowed_arr * logical_etr, expected13));
      
  std::vector<double> expected14{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot14{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: Dual_borrowed_arr * logical_etr">(compare_result_dual(Dual_borrowed_arr * logical_etr, expected14, expected_dot14));
        
  std::vector<double> expected15{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"unary * logical_etr">(compare_result(unary * logical_etr, expected15));
      
  std::vector<double> expected16{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"binary * logical_etr">(compare_result(binary * logical_etr, expected16));
      
  std::vector<double> expected17{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"sub * logical_etr">(compare_result(sub * logical_etr, expected17));
      
  std::vector<double> expected18{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"subset(create_r_array(), true, true, true) * logical_etr">(compare_result(subset(create_r_array(), true, true, true) * logical_etr, expected18));
      
  std::vector<double> expected19{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"create_r_array() * logical_etr">(compare_result(create_r_array() * logical_etr, expected19));
      
  std::vector<double> expected20{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"Logical_arr * integer_etr">(compare_result(Logical_arr * integer_etr, expected20));
      
  std::vector<double> expected21{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"Integer_arr * integer_etr">(compare_result(Integer_arr * integer_etr, expected21));
      
  std::vector<double> expected22{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"Double_arr * integer_etr">(compare_result(Double_arr * integer_etr, expected22));
      
  std::vector<double> expected23{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot23{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: Dual_arr * integer_etr">(compare_result_dual(Dual_arr * integer_etr, expected23, expected_dot23));
        
  std::vector<double> expected24{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot_l24{101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101};
 std::vector<double> expected_dot_r24{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * integer_etr">(compare_result_reverse_ad_binary(rev_ad_arr, integer_etr, rev_ad_arr * integer_etr, expected24, expected_dot_l24, expected_dot_r24));
        
  std::vector<double> expected25{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"Logical_r_arr * integer_etr">(compare_result(Logical_r_arr * integer_etr, expected25));
      
  std::vector<double> expected26{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"Integer_r_arr * integer_etr">(compare_result(Integer_r_arr * integer_etr, expected26));
      
  std::vector<double> expected27{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"Double_r_arr * integer_etr">(compare_result(Double_r_arr * integer_etr, expected27));
      
  std::vector<double> expected28{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot28{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: Dual_r_arr * integer_etr">(compare_result_dual(Dual_r_arr * integer_etr, expected28, expected_dot28));
        
  std::vector<double> expected29{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot_l29{101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101};
 std::vector<double> expected_dot_r29{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * integer_etr">(compare_result_reverse_ad_binary(rev_ad_r_arr, integer_etr, rev_ad_r_arr * integer_etr, expected29, expected_dot_l29, expected_dot_r29));
        
  std::vector<double> expected30{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"Logical_borrowed_arr * integer_etr">(compare_result(Logical_borrowed_arr * integer_etr, expected30));
      
  std::vector<double> expected31{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"Integer_borrowed_arr * integer_etr">(compare_result(Integer_borrowed_arr * integer_etr, expected31));
      
  std::vector<double> expected32{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"Double_borrowed_arr * integer_etr">(compare_result(Double_borrowed_arr * integer_etr, expected32));
      
  std::vector<double> expected33{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot33{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: Dual_borrowed_arr * integer_etr">(compare_result_dual(Dual_borrowed_arr * integer_etr, expected33, expected_dot33));
        
  std::vector<double> expected34{10.0831750813296, 90.011943366205, 87.1841460315362, 4.19964690576234, -82.6459882175054, -93.507282915101, -18.3984129314817, 73.6258730527135, 97.9588708953537, 32.2289345972846, -63.1321355381811, -100.449811408603, -45.4143939179948, 51.3748079016097, 100.93024826354, 57.6908838356589, -38.5892131355849, -99.390565513246, -68.8126903211055, 25.0312550062789, 95.8615799184374, 78.5572103419104, -10.9722961378321, -90.4139241497879, -86.7294072636029, -3.30627331241538, 83.1566330745462, 93.1657145092317, 17.5186676798351, -74.2349614229265, -97.7373093455143, -31.3804257945316, 63.8274765136954, 100.35269127072, 44.6141044735916, -52.1424842280726, -100.959513397833, -56.9548315482765, 39.4138597661026, 99.5456301778539, 68.1556072822806, -25.8963666329348, -96.1393404930434, -77.9922480731323, 11.8605575455367, 90.8088212546028, 86.2678734885226, 2.41264068177662, -83.6607628413322, -92.8168468294954, -16.6375498894404, 74.8382336909737, 97.5080903501039, 30.5294584229464, -64.517816784457, -100.247708779387, -43.8103196385441, 52.9060753363358, 100.980868635856, 56.2143170087052};
  ass<"unary * integer_etr">(compare_result(unary * integer_etr, expected34));
      
  std::vector<double> expected35{20.2, 222.2, 424.2, 626.2, 828.2, 1030.2, 1232.2, 1434.2, 1636.2, 1838.2, 2040.2, 2242.2, 2444.2, 2646.2, 2848.2, 3050.2, 3252.2, 3454.2, 3656.2, 3858.2, 4060.2, 4262.2, 4464.2, 4666.2, 4868.2, 5070.2, 5272.2, 5474.2, 5676.2, 5878.2, 6080.2, 6282.2, 6484.2, 6686.2, 6888.2, 7090.2, 7292.2, 7494.2, 7696.2, 7898.2, 8100.2, 8302.2, 8504.2, 8706.2, 8908.2, 9110.2, 9312.2, 9514.2, 9716.2, 9918.2, 10120.2, 10322.2, 10524.2, 10726.2, 10928.2, 11130.2, 11332.2, 11534.2, 11736.2, 11938.2};
  ass<"binary * integer_etr">(compare_result(binary * integer_etr, expected35));
      
  std::vector<double> expected36{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"sub * integer_etr">(compare_result(sub * integer_etr, expected36));
      
  std::vector<double> expected37{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"subset(create_r_array(), true, true, true) * integer_etr">(compare_result(subset(create_r_array(), true, true, true) * integer_etr, expected37));
      
  std::vector<double> expected38{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"create_r_array() * integer_etr">(compare_result(create_r_array() * integer_etr, expected38));
      
  std::vector<double> expected39{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"Logical_arr * double_etr">(compare_result(Logical_arr * double_etr, expected39));
      
  std::vector<double> expected40{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"Integer_arr * double_etr">(compare_result(Integer_arr * double_etr, expected40));
      
  std::vector<double> expected41{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"Double_arr * double_etr">(compare_result(Double_arr * double_etr, expected41));
      
  std::vector<double> expected42{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot42{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: Dual_arr * double_etr">(compare_result_dual(Dual_arr * double_etr, expected42, expected_dot42));
        
  std::vector<double> expected43{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l43{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
 std::vector<double> expected_dot_r43{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * double_etr">(compare_result_reverse_ad_binary(rev_ad_arr, double_etr, rev_ad_arr * double_etr, expected43, expected_dot_l43, expected_dot_r43));
        
  std::vector<double> expected44{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"Logical_r_arr * double_etr">(compare_result(Logical_r_arr * double_etr, expected44));
      
  std::vector<double> expected45{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"Integer_r_arr * double_etr">(compare_result(Integer_r_arr * double_etr, expected45));
      
  std::vector<double> expected46{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"Double_r_arr * double_etr">(compare_result(Double_r_arr * double_etr, expected46));
      
  std::vector<double> expected47{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot47{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: Dual_r_arr * double_etr">(compare_result_dual(Dual_r_arr * double_etr, expected47, expected_dot47));
        
  std::vector<double> expected48{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l48{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
 std::vector<double> expected_dot_r48{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * double_etr">(compare_result_reverse_ad_binary(rev_ad_r_arr, double_etr, rev_ad_r_arr * double_etr, expected48, expected_dot_l48, expected_dot_r48));
        
  std::vector<double> expected49{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"Logical_borrowed_arr * double_etr">(compare_result(Logical_borrowed_arr * double_etr, expected49));
      
  std::vector<double> expected50{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"Integer_borrowed_arr * double_etr">(compare_result(Integer_borrowed_arr * double_etr, expected50));
      
  std::vector<double> expected51{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"Double_borrowed_arr * double_etr">(compare_result(Double_borrowed_arr * double_etr, expected51));
      
  std::vector<double> expected52{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot52{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: Dual_borrowed_arr * double_etr">(compare_result_dual(Dual_borrowed_arr * double_etr, expected52, expected_dot52));
        
  std::vector<double> expected53{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  ass<"unary * double_etr">(compare_result(unary * double_etr, expected53));
      
  std::vector<double> expected54{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  ass<"binary * double_etr">(compare_result(binary * double_etr, expected54));
      
  std::vector<double> expected55{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"sub * double_etr">(compare_result(sub * double_etr, expected55));
      
  std::vector<double> expected56{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"subset(create_r_array(), true, true, true) * double_etr">(compare_result(subset(create_r_array(), true, true, true) * double_etr, expected56));
      
  std::vector<double> expected57{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"create_r_array() * double_etr">(compare_result(create_r_array() * double_etr, expected57));
      
  std::vector<double> expected58{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot58{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * dual_etr">(compare_result_dual(Logical_arr * dual_etr, expected58, expected_dot58));
        
  std::vector<double> expected59{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot59{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * dual_etr">(compare_result_dual(Integer_arr * dual_etr, expected59, expected_dot59));
        
  std::vector<double> expected60{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot60{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * dual_etr">(compare_result_dual(Double_arr * dual_etr, expected60, expected_dot60));
        
  std::vector<double> expected61{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot61{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: Dual_arr * dual_etr">(compare_result_dual(Dual_arr * dual_etr, expected61, expected_dot61));
        
  std::vector<double> expected62{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot62{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * dual_etr">(compare_result_dual(Logical_r_arr * dual_etr, expected62, expected_dot62));
        
  std::vector<double> expected63{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot63{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * dual_etr">(compare_result_dual(Integer_r_arr * dual_etr, expected63, expected_dot63));
        
  std::vector<double> expected64{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot64{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * dual_etr">(compare_result_dual(Double_r_arr * dual_etr, expected64, expected_dot64));
        
  std::vector<double> expected65{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot65{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: Dual_r_arr * dual_etr">(compare_result_dual(Dual_r_arr * dual_etr, expected65, expected_dot65));
        
  std::vector<double> expected66{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot66{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * dual_etr">(compare_result_dual(Logical_borrowed_arr * dual_etr, expected66, expected_dot66));
        
  std::vector<double> expected67{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot67{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * dual_etr">(compare_result_dual(Integer_borrowed_arr * dual_etr, expected67, expected_dot67));
        
  std::vector<double> expected68{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot68{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * dual_etr">(compare_result_dual(Double_borrowed_arr * dual_etr, expected68, expected_dot68));
        
  std::vector<double> expected69{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot69{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: Dual_borrowed_arr * dual_etr">(compare_result_dual(Dual_borrowed_arr * dual_etr, expected69, expected_dot69));
        
  std::vector<double> expected70{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  std::vector<double> expected_dot70{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * dual_etr">(compare_result_dual(unary * dual_etr, expected70, expected_dot70));
        
  std::vector<double> expected71{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  std::vector<double> expected_dot71{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * dual_etr">(compare_result_dual(binary * dual_etr, expected71, expected_dot71));
        
  std::vector<double> expected72{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot72{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * dual_etr">(compare_result_dual(sub * dual_etr, expected72, expected_dot72));
        
  std::vector<double> expected73{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot73{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * dual_etr">(compare_result_dual(subset(create_r_array(), true, true, true) * dual_etr, expected73, expected_dot73));
        
  std::vector<double> expected74{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot74{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * dual_etr">(compare_result_dual(create_r_array() * dual_etr, expected74, expected_dot74));
        
  std::vector<double> expected75{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot_l75{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r75{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Logical_arr, rev_ad_etr, Logical_arr * rev_ad_etr, expected75, expected_dot_l75, expected_dot_r75));
        
  std::vector<double> expected76{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot_l76{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r76{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Integer_arr, rev_ad_etr, Integer_arr * rev_ad_etr, expected76, expected_dot_l76, expected_dot_r76));
        
  std::vector<double> expected77{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l77{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r77{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Double_arr, rev_ad_etr, Double_arr * rev_ad_etr, expected77, expected_dot_l77, expected_dot_r77));
        
  std::vector<double> expected78{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l78{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
 std::vector<double> expected_dot_r78{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: rev_ad_arr * rev_ad_etr">(compare_result_reverse_ad_binary(rev_ad_arr, rev_ad_etr, rev_ad_arr * rev_ad_etr, expected78, expected_dot_l78, expected_dot_r78));
        
  std::vector<double> expected79{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot_l79{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r79{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_r_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Logical_r_arr, rev_ad_etr, Logical_r_arr * rev_ad_etr, expected79, expected_dot_l79, expected_dot_r79));
        
  std::vector<double> expected80{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot_l80{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r80{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_r_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Integer_r_arr, rev_ad_etr, Integer_r_arr * rev_ad_etr, expected80, expected_dot_l80, expected_dot_r80));
        
  std::vector<double> expected81{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l81{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r81{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_r_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Double_r_arr, rev_ad_etr, Double_r_arr * rev_ad_etr, expected81, expected_dot_l81, expected_dot_r81));
        
  std::vector<double> expected82{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l82{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
 std::vector<double> expected_dot_r82{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: rev_ad_r_arr * rev_ad_etr">(compare_result_reverse_ad_binary(rev_ad_r_arr, rev_ad_etr, rev_ad_r_arr * rev_ad_etr, expected82, expected_dot_l82, expected_dot_r82));
        
  std::vector<double> expected83{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot_l83{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r83{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Logical_borrowed_arr, rev_ad_etr, Logical_borrowed_arr * rev_ad_etr, expected83, expected_dot_l83, expected_dot_r83));
        
  std::vector<double> expected84{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot_l84{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r84{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_borrowed_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Integer_borrowed_arr, rev_ad_etr, Integer_borrowed_arr * rev_ad_etr, expected84, expected_dot_l84, expected_dot_r84));
        
  std::vector<double> expected85{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l85{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r85{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_borrowed_arr * rev_ad_etr">(compare_result_reverse_ad_binary(Double_borrowed_arr, rev_ad_etr, Double_borrowed_arr * rev_ad_etr, expected85, expected_dot_l85, expected_dot_r85));
        
  std::vector<double> expected86{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  std::vector<double> expected_dot_l86{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r86{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"deriv of: unary * rev_ad_etr">(compare_result_reverse_ad_binary(unary, rev_ad_etr, unary * rev_ad_etr, expected86, expected_dot_l86, expected_dot_r86));
        
  std::vector<double> expected87{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  std::vector<double> expected_dot_l87{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r87{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: binary * rev_ad_etr">(compare_result_reverse_ad_binary(binary, rev_ad_etr, binary * rev_ad_etr, expected87, expected_dot_l87, expected_dot_r87));
        
  std::vector<double> expected88{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l88{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r88{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: sub * rev_ad_etr">(compare_result_reverse_ad_binary(sub, rev_ad_etr, sub * rev_ad_etr, expected88, expected_dot_l88, expected_dot_r88));
        
  std::vector<double> expected89{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l89{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r89{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: subset(create_r_array(), true, true, true) * rev_ad_etr">(compare_result_reverse_ad_binary(subset(create_r_array(), true, true, true), rev_ad_etr, subset(create_r_array(), true, true, true) * rev_ad_etr, expected89, expected_dot_l89, expected_dot_r89));
        
  std::vector<double> expected90{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l90{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r90{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: create_r_array() * rev_ad_etr">(compare_result_reverse_ad_binary(create_r_array(), rev_ad_etr, create_r_array() * rev_ad_etr, expected90, expected_dot_l90, expected_dot_r90));
        
  std::vector<double> expected91{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"logical_etr * Logical_arr">(compare_result(logical_etr * Logical_arr, expected91));
      
  std::vector<double> expected92{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"integer_etr * Logical_arr">(compare_result(integer_etr * Logical_arr, expected92));
      
  std::vector<double> expected93{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"double_etr * Logical_arr">(compare_result(double_etr * Logical_arr, expected93));
      
  std::vector<double> expected94{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot94{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: dual_etr * Logical_arr">(compare_result_dual(dual_etr * Logical_arr, expected94, expected_dot94));
        
  std::vector<double> expected95{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot_l95{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r95{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Logical_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Logical_arr, rev_ad_etr * Logical_arr, expected95, expected_dot_l95, expected_dot_r95));
        
  std::vector<double> expected96{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * Logical_arr">(compare_result(Logical_arr * Logical_arr, expected96));
      
  std::vector<double> expected97{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_arr * Logical_arr">(compare_result(Integer_arr * Logical_arr, expected97));
      
  std::vector<double> expected98{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_arr * Logical_arr">(compare_result(Double_arr * Logical_arr, expected98));
      
  std::vector<double> expected99{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot99{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_arr * Logical_arr">(compare_result_dual(Dual_arr * Logical_arr, expected99, expected_dot99));
        
  std::vector<double> expected100{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l100{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r100{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Logical_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Logical_arr, rev_ad_arr * Logical_arr, expected100, expected_dot_l100, expected_dot_r100));
        
  std::vector<double> expected101{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * Logical_arr">(compare_result(Logical_r_arr * Logical_arr, expected101));
      
  std::vector<double> expected102{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_r_arr * Logical_arr">(compare_result(Integer_r_arr * Logical_arr, expected102));
      
  std::vector<double> expected103{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_r_arr * Logical_arr">(compare_result(Double_r_arr * Logical_arr, expected103));
      
  std::vector<double> expected104{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot104{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_r_arr * Logical_arr">(compare_result_dual(Dual_r_arr * Logical_arr, expected104, expected_dot104));
        
  std::vector<double> expected105{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l105{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r105{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Logical_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Logical_arr, rev_ad_r_arr * Logical_arr, expected105, expected_dot_l105, expected_dot_r105));
        
  std::vector<double> expected106{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * Logical_arr">(compare_result(Logical_borrowed_arr * Logical_arr, expected106));
      
  std::vector<double> expected107{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_borrowed_arr * Logical_arr">(compare_result(Integer_borrowed_arr * Logical_arr, expected107));
      
  std::vector<double> expected108{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_borrowed_arr * Logical_arr">(compare_result(Double_borrowed_arr * Logical_arr, expected108));
      
  std::vector<double> expected109{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot109{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_borrowed_arr * Logical_arr">(compare_result_dual(Dual_borrowed_arr * Logical_arr, expected109, expected_dot109));
        
  std::vector<double> expected110{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"unary * Logical_arr">(compare_result(unary * Logical_arr, expected110));
      
  std::vector<double> expected111{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"binary * Logical_arr">(compare_result(binary * Logical_arr, expected111));
      
  std::vector<double> expected112{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"sub * Logical_arr">(compare_result(sub * Logical_arr, expected112));
      
  std::vector<double> expected113{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"subset(create_r_array(), true, true, true) * Logical_arr">(compare_result(subset(create_r_array(), true, true, true) * Logical_arr, expected113));
      
  std::vector<double> expected114{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"create_r_array() * Logical_arr">(compare_result(create_r_array() * Logical_arr, expected114));
      
  std::vector<double> expected115{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"logical_etr * Integer_arr">(compare_result(logical_etr * Integer_arr, expected115));
      
  std::vector<double> expected116{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"integer_etr * Integer_arr">(compare_result(integer_etr * Integer_arr, expected116));
      
  std::vector<double> expected117{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"double_etr * Integer_arr">(compare_result(double_etr * Integer_arr, expected117));
      
  std::vector<double> expected118{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot118{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: dual_etr * Integer_arr">(compare_result_dual(dual_etr * Integer_arr, expected118, expected_dot118));
        
  std::vector<double> expected119{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot_l119{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r119{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Integer_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Integer_arr, rev_ad_etr * Integer_arr, expected119, expected_dot_l119, expected_dot_r119));
        
  std::vector<double> expected120{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_arr * Integer_arr">(compare_result(Logical_arr * Integer_arr, expected120));
      
  std::vector<double> expected121{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_arr * Integer_arr">(compare_result(Integer_arr * Integer_arr, expected121));
      
  std::vector<double> expected122{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_arr * Integer_arr">(compare_result(Double_arr * Integer_arr, expected122));
      
  std::vector<double> expected123{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot123{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_arr * Integer_arr">(compare_result_dual(Dual_arr * Integer_arr, expected123, expected_dot123));
        
  std::vector<double> expected124{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l124{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r124{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Integer_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Integer_arr, rev_ad_arr * Integer_arr, expected124, expected_dot_l124, expected_dot_r124));
        
  std::vector<double> expected125{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_r_arr * Integer_arr">(compare_result(Logical_r_arr * Integer_arr, expected125));
      
  std::vector<double> expected126{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_r_arr * Integer_arr">(compare_result(Integer_r_arr * Integer_arr, expected126));
      
  std::vector<double> expected127{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_r_arr * Integer_arr">(compare_result(Double_r_arr * Integer_arr, expected127));
      
  std::vector<double> expected128{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot128{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_r_arr * Integer_arr">(compare_result_dual(Dual_r_arr * Integer_arr, expected128, expected_dot128));
        
  std::vector<double> expected129{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l129{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r129{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Integer_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Integer_arr, rev_ad_r_arr * Integer_arr, expected129, expected_dot_l129, expected_dot_r129));
        
  std::vector<double> expected130{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_borrowed_arr * Integer_arr">(compare_result(Logical_borrowed_arr * Integer_arr, expected130));
      
  std::vector<double> expected131{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_borrowed_arr * Integer_arr">(compare_result(Integer_borrowed_arr * Integer_arr, expected131));
      
  std::vector<double> expected132{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_borrowed_arr * Integer_arr">(compare_result(Double_borrowed_arr * Integer_arr, expected132));
      
  std::vector<double> expected133{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot133{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_borrowed_arr * Integer_arr">(compare_result_dual(Dual_borrowed_arr * Integer_arr, expected133, expected_dot133));
        
  std::vector<double> expected134{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"unary * Integer_arr">(compare_result(unary * Integer_arr, expected134));
      
  std::vector<double> expected135{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"binary * Integer_arr">(compare_result(binary * Integer_arr, expected135));
      
  std::vector<double> expected136{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"sub * Integer_arr">(compare_result(sub * Integer_arr, expected136));
      
  std::vector<double> expected137{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"subset(create_r_array(), true, true, true) * Integer_arr">(compare_result(subset(create_r_array(), true, true, true) * Integer_arr, expected137));
      
  std::vector<double> expected138{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"create_r_array() * Integer_arr">(compare_result(create_r_array() * Integer_arr, expected138));
      
  std::vector<double> expected139{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * Double_arr">(compare_result(logical_etr * Double_arr, expected139));
      
  std::vector<double> expected140{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * Double_arr">(compare_result(integer_etr * Double_arr, expected140));
      
  std::vector<double> expected141{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * Double_arr">(compare_result(double_etr * Double_arr, expected141));
      
  std::vector<double> expected142{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot142{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * Double_arr">(compare_result_dual(dual_etr * Double_arr, expected142, expected_dot142));
        
  std::vector<double> expected143{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l143{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r143{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Double_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Double_arr, rev_ad_etr * Double_arr, expected143, expected_dot_l143, expected_dot_r143));
        
  std::vector<double> expected144{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * Double_arr">(compare_result(Logical_arr * Double_arr, expected144));
      
  std::vector<double> expected145{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * Double_arr">(compare_result(Integer_arr * Double_arr, expected145));
      
  std::vector<double> expected146{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * Double_arr">(compare_result(Double_arr * Double_arr, expected146));
      
  std::vector<double> expected147{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot147{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * Double_arr">(compare_result_dual(Dual_arr * Double_arr, expected147, expected_dot147));
        
  std::vector<double> expected148{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l148{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r148{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Double_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Double_arr, rev_ad_arr * Double_arr, expected148, expected_dot_l148, expected_dot_r148));
        
  std::vector<double> expected149{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * Double_arr">(compare_result(Logical_r_arr * Double_arr, expected149));
      
  std::vector<double> expected150{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * Double_arr">(compare_result(Integer_r_arr * Double_arr, expected150));
      
  std::vector<double> expected151{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * Double_arr">(compare_result(Double_r_arr * Double_arr, expected151));
      
  std::vector<double> expected152{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot152{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * Double_arr">(compare_result_dual(Dual_r_arr * Double_arr, expected152, expected_dot152));
        
  std::vector<double> expected153{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l153{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r153{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Double_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Double_arr, rev_ad_r_arr * Double_arr, expected153, expected_dot_l153, expected_dot_r153));
        
  std::vector<double> expected154{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * Double_arr">(compare_result(Logical_borrowed_arr * Double_arr, expected154));
      
  std::vector<double> expected155{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * Double_arr">(compare_result(Integer_borrowed_arr * Double_arr, expected155));
      
  std::vector<double> expected156{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * Double_arr">(compare_result(Double_borrowed_arr * Double_arr, expected156));
      
  std::vector<double> expected157{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot157{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * Double_arr">(compare_result_dual(Dual_borrowed_arr * Double_arr, expected157, expected_dot157));
        
  std::vector<double> expected158{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * Double_arr">(compare_result(unary * Double_arr, expected158));
      
  std::vector<double> expected159{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * Double_arr">(compare_result(binary * Double_arr, expected159));
      
  std::vector<double> expected160{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * Double_arr">(compare_result(sub * Double_arr, expected160));
      
  std::vector<double> expected161{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * Double_arr">(compare_result(subset(create_r_array(), true, true, true) * Double_arr, expected161));
      
  std::vector<double> expected162{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * Double_arr">(compare_result(create_r_array() * Double_arr, expected162));
      
  std::vector<double> expected163{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot163{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: logical_etr * Dual_arr">(compare_result_dual(logical_etr * Dual_arr, expected163, expected_dot163));
        
  std::vector<double> expected164{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot164{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: integer_etr * Dual_arr">(compare_result_dual(integer_etr * Dual_arr, expected164, expected_dot164));
        
  std::vector<double> expected165{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot165{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: double_etr * Dual_arr">(compare_result_dual(double_etr * Dual_arr, expected165, expected_dot165));
        
  std::vector<double> expected166{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot166{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: dual_etr * Dual_arr">(compare_result_dual(dual_etr * Dual_arr, expected166, expected_dot166));
        
  std::vector<double> expected167{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot167{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * Dual_arr">(compare_result_dual(Logical_arr * Dual_arr, expected167, expected_dot167));
        
  std::vector<double> expected168{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot168{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * Dual_arr">(compare_result_dual(Integer_arr * Dual_arr, expected168, expected_dot168));
        
  std::vector<double> expected169{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot169{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * Dual_arr">(compare_result_dual(Double_arr * Dual_arr, expected169, expected_dot169));
        
  std::vector<double> expected170{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot170{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * Dual_arr">(compare_result_dual(Dual_arr * Dual_arr, expected170, expected_dot170));
        
  std::vector<double> expected171{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot171{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * Dual_arr">(compare_result_dual(Logical_r_arr * Dual_arr, expected171, expected_dot171));
        
  std::vector<double> expected172{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot172{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * Dual_arr">(compare_result_dual(Integer_r_arr * Dual_arr, expected172, expected_dot172));
        
  std::vector<double> expected173{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot173{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * Dual_arr">(compare_result_dual(Double_r_arr * Dual_arr, expected173, expected_dot173));
        
  std::vector<double> expected174{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot174{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * Dual_arr">(compare_result_dual(Dual_r_arr * Dual_arr, expected174, expected_dot174));
        
  std::vector<double> expected175{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot175{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * Dual_arr">(compare_result_dual(Logical_borrowed_arr * Dual_arr, expected175, expected_dot175));
        
  std::vector<double> expected176{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot176{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * Dual_arr">(compare_result_dual(Integer_borrowed_arr * Dual_arr, expected176, expected_dot176));
        
  std::vector<double> expected177{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot177{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * Dual_arr">(compare_result_dual(Double_borrowed_arr * Dual_arr, expected177, expected_dot177));
        
  std::vector<double> expected178{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot178{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * Dual_arr">(compare_result_dual(Dual_borrowed_arr * Dual_arr, expected178, expected_dot178));
        
  std::vector<double> expected179{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot179{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * Dual_arr">(compare_result_dual(unary * Dual_arr, expected179, expected_dot179));
        
  std::vector<double> expected180{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot180{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * Dual_arr">(compare_result_dual(binary * Dual_arr, expected180, expected_dot180));
        
  std::vector<double> expected181{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot181{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * Dual_arr">(compare_result_dual(sub * Dual_arr, expected181, expected_dot181));
        
  std::vector<double> expected182{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot182{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * Dual_arr">(compare_result_dual(subset(create_r_array(), true, true, true) * Dual_arr, expected182, expected_dot182));
        
  std::vector<double> expected183{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot183{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * Dual_arr">(compare_result_dual(create_r_array() * Dual_arr, expected183, expected_dot183));
        
  std::vector<double> expected184{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot_l184{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r184{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
  ass<"deriv of: logical_etr * rev_ad_arr">(compare_result_reverse_ad_binary(logical_etr, rev_ad_arr, logical_etr * rev_ad_arr, expected184, expected_dot_l184, expected_dot_r184));
        
  std::vector<double> expected185{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot_l185{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r185{101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101};
  ass<"deriv of: integer_etr * rev_ad_arr">(compare_result_reverse_ad_binary(integer_etr, rev_ad_arr, integer_etr * rev_ad_arr, expected185, expected_dot_l185, expected_dot_r185));
        
  std::vector<double> expected186{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l186{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r186{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
  ass<"deriv of: double_etr * rev_ad_arr">(compare_result_reverse_ad_binary(double_etr, rev_ad_arr, double_etr * rev_ad_arr, expected186, expected_dot_l186, expected_dot_r186));
        
  std::vector<double> expected187{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l187{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r187{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
  ass<"deriv of: rev_ad_etr * rev_ad_arr">(compare_result_reverse_ad_binary(rev_ad_etr, rev_ad_arr, rev_ad_etr * rev_ad_arr, expected187, expected_dot_l187, expected_dot_r187));
        
  std::vector<double> expected188{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l188{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r188{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Logical_arr, rev_ad_arr, Logical_arr * rev_ad_arr, expected188, expected_dot_l188, expected_dot_r188));
        
  std::vector<double> expected189{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l189{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r189{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Integer_arr, rev_ad_arr, Integer_arr * rev_ad_arr, expected189, expected_dot_l189, expected_dot_r189));
        
  std::vector<double> expected190{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l190{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r190{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Double_arr, rev_ad_arr, Double_arr * rev_ad_arr, expected190, expected_dot_l190, expected_dot_r190));
        
  std::vector<double> expected191{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l191{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
 std::vector<double> expected_dot_r191{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: rev_ad_arr * rev_ad_arr">(compare_result_reverse_ad_binary(rev_ad_arr, rev_ad_arr, rev_ad_arr * rev_ad_arr, expected191, expected_dot_l191, expected_dot_r191));
        
  std::vector<double> expected192{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l192{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r192{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_r_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Logical_r_arr, rev_ad_arr, Logical_r_arr * rev_ad_arr, expected192, expected_dot_l192, expected_dot_r192));
        
  std::vector<double> expected193{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l193{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r193{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_r_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Integer_r_arr, rev_ad_arr, Integer_r_arr * rev_ad_arr, expected193, expected_dot_l193, expected_dot_r193));
        
  std::vector<double> expected194{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l194{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r194{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_r_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Double_r_arr, rev_ad_arr, Double_r_arr * rev_ad_arr, expected194, expected_dot_l194, expected_dot_r194));
        
  std::vector<double> expected195{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l195{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r195{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: rev_ad_r_arr * rev_ad_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, rev_ad_arr, rev_ad_r_arr * rev_ad_arr, expected195, expected_dot_l195, expected_dot_r195));
        
  std::vector<double> expected196{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l196{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r196{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Logical_borrowed_arr, rev_ad_arr, Logical_borrowed_arr * rev_ad_arr, expected196, expected_dot_l196, expected_dot_r196));
        
  std::vector<double> expected197{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l197{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r197{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_borrowed_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Integer_borrowed_arr, rev_ad_arr, Integer_borrowed_arr * rev_ad_arr, expected197, expected_dot_l197, expected_dot_r197));
        
  std::vector<double> expected198{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l198{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r198{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_borrowed_arr * rev_ad_arr">(compare_result_reverse_ad_binary(Double_borrowed_arr, rev_ad_arr, Double_borrowed_arr * rev_ad_arr, expected198, expected_dot_l198, expected_dot_r198));
        
  std::vector<double> expected199{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot_l199{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r199{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"deriv of: unary * rev_ad_arr">(compare_result_reverse_ad_binary(unary, rev_ad_arr, unary * rev_ad_arr, expected199, expected_dot_l199, expected_dot_r199));
        
  std::vector<double> expected200{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot_l200{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r200{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: binary * rev_ad_arr">(compare_result_reverse_ad_binary(binary, rev_ad_arr, binary * rev_ad_arr, expected200, expected_dot_l200, expected_dot_r200));
        
  std::vector<double> expected201{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l201{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r201{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: sub * rev_ad_arr">(compare_result_reverse_ad_binary(sub, rev_ad_arr, sub * rev_ad_arr, expected201, expected_dot_l201, expected_dot_r201));
        
  std::vector<double> expected202{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l202{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r202{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: subset(create_r_array(), true, true, true) * rev_ad_arr">(compare_result_reverse_ad_binary(subset(create_r_array(), true, true, true), rev_ad_arr, subset(create_r_array(), true, true, true) * rev_ad_arr, expected202, expected_dot_l202, expected_dot_r202));
        
  std::vector<double> expected203{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l203{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r203{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: create_r_array() * rev_ad_arr">(compare_result_reverse_ad_binary(create_r_array(), rev_ad_arr, create_r_array() * rev_ad_arr, expected203, expected_dot_l203, expected_dot_r203));
        
  std::vector<double> expected204{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"logical_etr * Logical_r_arr">(compare_result(logical_etr * Logical_r_arr, expected204));
      
  std::vector<double> expected205{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"integer_etr * Logical_r_arr">(compare_result(integer_etr * Logical_r_arr, expected205));
      
  std::vector<double> expected206{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"double_etr * Logical_r_arr">(compare_result(double_etr * Logical_r_arr, expected206));
      
  std::vector<double> expected207{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot207{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: dual_etr * Logical_r_arr">(compare_result_dual(dual_etr * Logical_r_arr, expected207, expected_dot207));
        
  std::vector<double> expected208{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot_l208{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r208{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Logical_r_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Logical_r_arr, rev_ad_etr * Logical_r_arr, expected208, expected_dot_l208, expected_dot_r208));
        
  std::vector<double> expected209{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * Logical_r_arr">(compare_result(Logical_arr * Logical_r_arr, expected209));
      
  std::vector<double> expected210{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_arr * Logical_r_arr">(compare_result(Integer_arr * Logical_r_arr, expected210));
      
  std::vector<double> expected211{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_arr * Logical_r_arr">(compare_result(Double_arr * Logical_r_arr, expected211));
      
  std::vector<double> expected212{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot212{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_arr * Logical_r_arr">(compare_result_dual(Dual_arr * Logical_r_arr, expected212, expected_dot212));
        
  std::vector<double> expected213{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l213{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r213{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Logical_r_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Logical_r_arr, rev_ad_arr * Logical_r_arr, expected213, expected_dot_l213, expected_dot_r213));
        
  std::vector<double> expected214{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * Logical_r_arr">(compare_result(Logical_r_arr * Logical_r_arr, expected214));
      
  std::vector<double> expected215{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_r_arr * Logical_r_arr">(compare_result(Integer_r_arr * Logical_r_arr, expected215));
      
  std::vector<double> expected216{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_r_arr * Logical_r_arr">(compare_result(Double_r_arr * Logical_r_arr, expected216));
      
  std::vector<double> expected217{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot217{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_r_arr * Logical_r_arr">(compare_result_dual(Dual_r_arr * Logical_r_arr, expected217, expected_dot217));
        
  std::vector<double> expected218{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l218{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r218{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Logical_r_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Logical_r_arr, rev_ad_r_arr * Logical_r_arr, expected218, expected_dot_l218, expected_dot_r218));
        
  std::vector<double> expected219{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * Logical_r_arr">(compare_result(Logical_borrowed_arr * Logical_r_arr, expected219));
      
  std::vector<double> expected220{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_borrowed_arr * Logical_r_arr">(compare_result(Integer_borrowed_arr * Logical_r_arr, expected220));
      
  std::vector<double> expected221{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_borrowed_arr * Logical_r_arr">(compare_result(Double_borrowed_arr * Logical_r_arr, expected221));
      
  std::vector<double> expected222{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot222{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_borrowed_arr * Logical_r_arr">(compare_result_dual(Dual_borrowed_arr * Logical_r_arr, expected222, expected_dot222));
        
  std::vector<double> expected223{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"unary * Logical_r_arr">(compare_result(unary * Logical_r_arr, expected223));
      
  std::vector<double> expected224{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"binary * Logical_r_arr">(compare_result(binary * Logical_r_arr, expected224));
      
  std::vector<double> expected225{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"sub * Logical_r_arr">(compare_result(sub * Logical_r_arr, expected225));
      
  std::vector<double> expected226{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"subset(create_r_array(), true, true, true) * Logical_r_arr">(compare_result(subset(create_r_array(), true, true, true) * Logical_r_arr, expected226));
      
  std::vector<double> expected227{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"create_r_array() * Logical_r_arr">(compare_result(create_r_array() * Logical_r_arr, expected227));
      
  std::vector<double> expected228{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"logical_etr * Integer_r_arr">(compare_result(logical_etr * Integer_r_arr, expected228));
      
  std::vector<double> expected229{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"integer_etr * Integer_r_arr">(compare_result(integer_etr * Integer_r_arr, expected229));
      
  std::vector<double> expected230{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"double_etr * Integer_r_arr">(compare_result(double_etr * Integer_r_arr, expected230));
      
  std::vector<double> expected231{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot231{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: dual_etr * Integer_r_arr">(compare_result_dual(dual_etr * Integer_r_arr, expected231, expected_dot231));
        
  std::vector<double> expected232{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot_l232{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r232{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Integer_r_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Integer_r_arr, rev_ad_etr * Integer_r_arr, expected232, expected_dot_l232, expected_dot_r232));
        
  std::vector<double> expected233{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_arr * Integer_r_arr">(compare_result(Logical_arr * Integer_r_arr, expected233));
      
  std::vector<double> expected234{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_arr * Integer_r_arr">(compare_result(Integer_arr * Integer_r_arr, expected234));
      
  std::vector<double> expected235{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_arr * Integer_r_arr">(compare_result(Double_arr * Integer_r_arr, expected235));
      
  std::vector<double> expected236{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot236{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_arr * Integer_r_arr">(compare_result_dual(Dual_arr * Integer_r_arr, expected236, expected_dot236));
        
  std::vector<double> expected237{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l237{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r237{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Integer_r_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Integer_r_arr, rev_ad_arr * Integer_r_arr, expected237, expected_dot_l237, expected_dot_r237));
        
  std::vector<double> expected238{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_r_arr * Integer_r_arr">(compare_result(Logical_r_arr * Integer_r_arr, expected238));
      
  std::vector<double> expected239{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_r_arr * Integer_r_arr">(compare_result(Integer_r_arr * Integer_r_arr, expected239));
      
  std::vector<double> expected240{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_r_arr * Integer_r_arr">(compare_result(Double_r_arr * Integer_r_arr, expected240));
      
  std::vector<double> expected241{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot241{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_r_arr * Integer_r_arr">(compare_result_dual(Dual_r_arr * Integer_r_arr, expected241, expected_dot241));
        
  std::vector<double> expected242{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l242{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r242{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Integer_r_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Integer_r_arr, rev_ad_r_arr * Integer_r_arr, expected242, expected_dot_l242, expected_dot_r242));
        
  std::vector<double> expected243{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_borrowed_arr * Integer_r_arr">(compare_result(Logical_borrowed_arr * Integer_r_arr, expected243));
      
  std::vector<double> expected244{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_borrowed_arr * Integer_r_arr">(compare_result(Integer_borrowed_arr * Integer_r_arr, expected244));
      
  std::vector<double> expected245{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_borrowed_arr * Integer_r_arr">(compare_result(Double_borrowed_arr * Integer_r_arr, expected245));
      
  std::vector<double> expected246{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot246{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_borrowed_arr * Integer_r_arr">(compare_result_dual(Dual_borrowed_arr * Integer_r_arr, expected246, expected_dot246));
        
  std::vector<double> expected247{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"unary * Integer_r_arr">(compare_result(unary * Integer_r_arr, expected247));
      
  std::vector<double> expected248{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"binary * Integer_r_arr">(compare_result(binary * Integer_r_arr, expected248));
      
  std::vector<double> expected249{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"sub * Integer_r_arr">(compare_result(sub * Integer_r_arr, expected249));
      
  std::vector<double> expected250{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"subset(create_r_array(), true, true, true) * Integer_r_arr">(compare_result(subset(create_r_array(), true, true, true) * Integer_r_arr, expected250));
      
  std::vector<double> expected251{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"create_r_array() * Integer_r_arr">(compare_result(create_r_array() * Integer_r_arr, expected251));
      
  std::vector<double> expected252{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * Double_r_arr">(compare_result(logical_etr * Double_r_arr, expected252));
      
  std::vector<double> expected253{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * Double_r_arr">(compare_result(integer_etr * Double_r_arr, expected253));
      
  std::vector<double> expected254{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * Double_r_arr">(compare_result(double_etr * Double_r_arr, expected254));
      
  std::vector<double> expected255{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot255{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * Double_r_arr">(compare_result_dual(dual_etr * Double_r_arr, expected255, expected_dot255));
        
  std::vector<double> expected256{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l256{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r256{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Double_r_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Double_r_arr, rev_ad_etr * Double_r_arr, expected256, expected_dot_l256, expected_dot_r256));
        
  std::vector<double> expected257{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * Double_r_arr">(compare_result(Logical_arr * Double_r_arr, expected257));
      
  std::vector<double> expected258{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * Double_r_arr">(compare_result(Integer_arr * Double_r_arr, expected258));
      
  std::vector<double> expected259{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * Double_r_arr">(compare_result(Double_arr * Double_r_arr, expected259));
      
  std::vector<double> expected260{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot260{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * Double_r_arr">(compare_result_dual(Dual_arr * Double_r_arr, expected260, expected_dot260));
        
  std::vector<double> expected261{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l261{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r261{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Double_r_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Double_r_arr, rev_ad_arr * Double_r_arr, expected261, expected_dot_l261, expected_dot_r261));
        
  std::vector<double> expected262{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * Double_r_arr">(compare_result(Logical_r_arr * Double_r_arr, expected262));
      
  std::vector<double> expected263{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * Double_r_arr">(compare_result(Integer_r_arr * Double_r_arr, expected263));
      
  std::vector<double> expected264{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * Double_r_arr">(compare_result(Double_r_arr * Double_r_arr, expected264));
      
  std::vector<double> expected265{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot265{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * Double_r_arr">(compare_result_dual(Dual_r_arr * Double_r_arr, expected265, expected_dot265));
        
  std::vector<double> expected266{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l266{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r266{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Double_r_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Double_r_arr, rev_ad_r_arr * Double_r_arr, expected266, expected_dot_l266, expected_dot_r266));
        
  std::vector<double> expected267{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * Double_r_arr">(compare_result(Logical_borrowed_arr * Double_r_arr, expected267));
      
  std::vector<double> expected268{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * Double_r_arr">(compare_result(Integer_borrowed_arr * Double_r_arr, expected268));
      
  std::vector<double> expected269{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * Double_r_arr">(compare_result(Double_borrowed_arr * Double_r_arr, expected269));
      
  std::vector<double> expected270{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot270{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * Double_r_arr">(compare_result_dual(Dual_borrowed_arr * Double_r_arr, expected270, expected_dot270));
        
  std::vector<double> expected271{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * Double_r_arr">(compare_result(unary * Double_r_arr, expected271));
      
  std::vector<double> expected272{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * Double_r_arr">(compare_result(binary * Double_r_arr, expected272));
      
  std::vector<double> expected273{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * Double_r_arr">(compare_result(sub * Double_r_arr, expected273));
      
  std::vector<double> expected274{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * Double_r_arr">(compare_result(subset(create_r_array(), true, true, true) * Double_r_arr, expected274));
      
  std::vector<double> expected275{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * Double_r_arr">(compare_result(create_r_array() * Double_r_arr, expected275));
      
  std::vector<double> expected276{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot276{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: logical_etr * Dual_r_arr">(compare_result_dual(logical_etr * Dual_r_arr, expected276, expected_dot276));
        
  std::vector<double> expected277{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot277{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: integer_etr * Dual_r_arr">(compare_result_dual(integer_etr * Dual_r_arr, expected277, expected_dot277));
        
  std::vector<double> expected278{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot278{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: double_etr * Dual_r_arr">(compare_result_dual(double_etr * Dual_r_arr, expected278, expected_dot278));
        
  std::vector<double> expected279{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot279{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: dual_etr * Dual_r_arr">(compare_result_dual(dual_etr * Dual_r_arr, expected279, expected_dot279));
        
  std::vector<double> expected280{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot280{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * Dual_r_arr">(compare_result_dual(Logical_arr * Dual_r_arr, expected280, expected_dot280));
        
  std::vector<double> expected281{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot281{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * Dual_r_arr">(compare_result_dual(Integer_arr * Dual_r_arr, expected281, expected_dot281));
        
  std::vector<double> expected282{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot282{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * Dual_r_arr">(compare_result_dual(Double_arr * Dual_r_arr, expected282, expected_dot282));
        
  std::vector<double> expected283{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot283{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * Dual_r_arr">(compare_result_dual(Dual_arr * Dual_r_arr, expected283, expected_dot283));
        
  std::vector<double> expected284{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot284{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * Dual_r_arr">(compare_result_dual(Logical_r_arr * Dual_r_arr, expected284, expected_dot284));
        
  std::vector<double> expected285{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot285{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * Dual_r_arr">(compare_result_dual(Integer_r_arr * Dual_r_arr, expected285, expected_dot285));
        
  std::vector<double> expected286{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot286{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * Dual_r_arr">(compare_result_dual(Double_r_arr * Dual_r_arr, expected286, expected_dot286));
        
  std::vector<double> expected287{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot287{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * Dual_r_arr">(compare_result_dual(Dual_r_arr * Dual_r_arr, expected287, expected_dot287));
        
  std::vector<double> expected288{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot288{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * Dual_r_arr">(compare_result_dual(Logical_borrowed_arr * Dual_r_arr, expected288, expected_dot288));
        
  std::vector<double> expected289{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot289{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * Dual_r_arr">(compare_result_dual(Integer_borrowed_arr * Dual_r_arr, expected289, expected_dot289));
        
  std::vector<double> expected290{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot290{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * Dual_r_arr">(compare_result_dual(Double_borrowed_arr * Dual_r_arr, expected290, expected_dot290));
        
  std::vector<double> expected291{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot291{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * Dual_r_arr">(compare_result_dual(Dual_borrowed_arr * Dual_r_arr, expected291, expected_dot291));
        
  std::vector<double> expected292{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot292{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * Dual_r_arr">(compare_result_dual(unary * Dual_r_arr, expected292, expected_dot292));
        
  std::vector<double> expected293{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot293{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * Dual_r_arr">(compare_result_dual(binary * Dual_r_arr, expected293, expected_dot293));
        
  std::vector<double> expected294{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot294{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * Dual_r_arr">(compare_result_dual(sub * Dual_r_arr, expected294, expected_dot294));
        
  std::vector<double> expected295{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot295{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * Dual_r_arr">(compare_result_dual(subset(create_r_array(), true, true, true) * Dual_r_arr, expected295, expected_dot295));
        
  std::vector<double> expected296{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot296{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * Dual_r_arr">(compare_result_dual(create_r_array() * Dual_r_arr, expected296, expected_dot296));
        
  std::vector<double> expected297{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot_l297{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r297{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
  ass<"deriv of: logical_etr * rev_ad_r_arr">(compare_result_reverse_ad_binary(logical_etr, rev_ad_r_arr, logical_etr * rev_ad_r_arr, expected297, expected_dot_l297, expected_dot_r297));
        
  std::vector<double> expected298{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot_l298{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r298{101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101};
  ass<"deriv of: integer_etr * rev_ad_r_arr">(compare_result_reverse_ad_binary(integer_etr, rev_ad_r_arr, integer_etr * rev_ad_r_arr, expected298, expected_dot_l298, expected_dot_r298));
        
  std::vector<double> expected299{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l299{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r299{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
  ass<"deriv of: double_etr * rev_ad_r_arr">(compare_result_reverse_ad_binary(double_etr, rev_ad_r_arr, double_etr * rev_ad_r_arr, expected299, expected_dot_l299, expected_dot_r299));
        
  std::vector<double> expected300{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l300{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r300{3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14};
  ass<"deriv of: rev_ad_etr * rev_ad_r_arr">(compare_result_reverse_ad_binary(rev_ad_etr, rev_ad_r_arr, rev_ad_etr * rev_ad_r_arr, expected300, expected_dot_l300, expected_dot_r300));
        
  std::vector<double> expected301{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l301{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r301{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Logical_arr, rev_ad_r_arr, Logical_arr * rev_ad_r_arr, expected301, expected_dot_l301, expected_dot_r301));
        
  std::vector<double> expected302{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l302{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r302{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Integer_arr, rev_ad_r_arr, Integer_arr * rev_ad_r_arr, expected302, expected_dot_l302, expected_dot_r302));
        
  std::vector<double> expected303{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l303{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r303{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Double_arr, rev_ad_r_arr, Double_arr * rev_ad_r_arr, expected303, expected_dot_l303, expected_dot_r303));
        
  std::vector<double> expected304{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l304{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r304{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: rev_ad_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(rev_ad_arr, rev_ad_r_arr, rev_ad_arr * rev_ad_r_arr, expected304, expected_dot_l304, expected_dot_r304));
        
  std::vector<double> expected305{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l305{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r305{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_r_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Logical_r_arr, rev_ad_r_arr, Logical_r_arr * rev_ad_r_arr, expected305, expected_dot_l305, expected_dot_r305));
        
  std::vector<double> expected306{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l306{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r306{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_r_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Integer_r_arr, rev_ad_r_arr, Integer_r_arr * rev_ad_r_arr, expected306, expected_dot_l306, expected_dot_r306));
        
  std::vector<double> expected307{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l307{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r307{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_r_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Double_r_arr, rev_ad_r_arr, Double_r_arr * rev_ad_r_arr, expected307, expected_dot_l307, expected_dot_r307));
        
  std::vector<double> expected308{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l308{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
 std::vector<double> expected_dot_r308{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: rev_ad_r_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, rev_ad_r_arr, rev_ad_r_arr * rev_ad_r_arr, expected308, expected_dot_l308, expected_dot_r308));
        
  std::vector<double> expected309{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l309{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r309{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Logical_borrowed_arr, rev_ad_r_arr, Logical_borrowed_arr * rev_ad_r_arr, expected309, expected_dot_l309, expected_dot_r309));
        
  std::vector<double> expected310{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l310{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r310{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"deriv of: Integer_borrowed_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Integer_borrowed_arr, rev_ad_r_arr, Integer_borrowed_arr * rev_ad_r_arr, expected310, expected_dot_l310, expected_dot_r310));
        
  std::vector<double> expected311{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l311{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r311{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: Double_borrowed_arr * rev_ad_r_arr">(compare_result_reverse_ad_binary(Double_borrowed_arr, rev_ad_r_arr, Double_borrowed_arr * rev_ad_r_arr, expected311, expected_dot_l311, expected_dot_r311));
        
  std::vector<double> expected312{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot_l312{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r312{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"deriv of: unary * rev_ad_r_arr">(compare_result_reverse_ad_binary(unary, rev_ad_r_arr, unary * rev_ad_r_arr, expected312, expected_dot_l312, expected_dot_r312));
        
  std::vector<double> expected313{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot_l313{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r313{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: binary * rev_ad_r_arr">(compare_result_reverse_ad_binary(binary, rev_ad_r_arr, binary * rev_ad_r_arr, expected313, expected_dot_l313, expected_dot_r313));
        
  std::vector<double> expected314{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l314{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r314{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: sub * rev_ad_r_arr">(compare_result_reverse_ad_binary(sub, rev_ad_r_arr, sub * rev_ad_r_arr, expected314, expected_dot_l314, expected_dot_r314));
        
  std::vector<double> expected315{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l315{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r315{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: subset(create_r_array(), true, true, true) * rev_ad_r_arr">(compare_result_reverse_ad_binary(subset(create_r_array(), true, true, true), rev_ad_r_arr, subset(create_r_array(), true, true, true) * rev_ad_r_arr, expected315, expected_dot_l315, expected_dot_r315));
        
  std::vector<double> expected316{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l316{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
 std::vector<double> expected_dot_r316{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"deriv of: create_r_array() * rev_ad_r_arr">(compare_result_reverse_ad_binary(create_r_array(), rev_ad_r_arr, create_r_array() * rev_ad_r_arr, expected316, expected_dot_l316, expected_dot_r316));
        
  std::vector<double> expected317{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"logical_etr * Logical_borrowed_arr">(compare_result(logical_etr * Logical_borrowed_arr, expected317));
      
  std::vector<double> expected318{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"integer_etr * Logical_borrowed_arr">(compare_result(integer_etr * Logical_borrowed_arr, expected318));
      
  std::vector<double> expected319{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"double_etr * Logical_borrowed_arr">(compare_result(double_etr * Logical_borrowed_arr, expected319));
      
  std::vector<double> expected320{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot320{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: dual_etr * Logical_borrowed_arr">(compare_result_dual(dual_etr * Logical_borrowed_arr, expected320, expected_dot320));
        
  std::vector<double> expected321{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot_l321{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r321{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Logical_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Logical_borrowed_arr, rev_ad_etr * Logical_borrowed_arr, expected321, expected_dot_l321, expected_dot_r321));
        
  std::vector<double> expected322{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * Logical_borrowed_arr">(compare_result(Logical_arr * Logical_borrowed_arr, expected322));
      
  std::vector<double> expected323{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_arr * Logical_borrowed_arr">(compare_result(Integer_arr * Logical_borrowed_arr, expected323));
      
  std::vector<double> expected324{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_arr * Logical_borrowed_arr">(compare_result(Double_arr * Logical_borrowed_arr, expected324));
      
  std::vector<double> expected325{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot325{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_arr * Logical_borrowed_arr">(compare_result_dual(Dual_arr * Logical_borrowed_arr, expected325, expected_dot325));
        
  std::vector<double> expected326{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l326{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r326{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Logical_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Logical_borrowed_arr, rev_ad_arr * Logical_borrowed_arr, expected326, expected_dot_l326, expected_dot_r326));
        
  std::vector<double> expected327{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * Logical_borrowed_arr">(compare_result(Logical_r_arr * Logical_borrowed_arr, expected327));
      
  std::vector<double> expected328{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_r_arr * Logical_borrowed_arr">(compare_result(Integer_r_arr * Logical_borrowed_arr, expected328));
      
  std::vector<double> expected329{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_r_arr * Logical_borrowed_arr">(compare_result(Double_r_arr * Logical_borrowed_arr, expected329));
      
  std::vector<double> expected330{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot330{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_r_arr * Logical_borrowed_arr">(compare_result_dual(Dual_r_arr * Logical_borrowed_arr, expected330, expected_dot330));
        
  std::vector<double> expected331{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot_l331{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
 std::vector<double> expected_dot_r331{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Logical_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Logical_borrowed_arr, rev_ad_r_arr * Logical_borrowed_arr, expected331, expected_dot_l331, expected_dot_r331));
        
  std::vector<double> expected332{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * Logical_borrowed_arr">(compare_result(Logical_borrowed_arr * Logical_borrowed_arr, expected332));
      
  std::vector<double> expected333{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_borrowed_arr * Logical_borrowed_arr">(compare_result(Integer_borrowed_arr * Logical_borrowed_arr, expected333));
      
  std::vector<double> expected334{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_borrowed_arr * Logical_borrowed_arr">(compare_result(Double_borrowed_arr * Logical_borrowed_arr, expected334));
      
  std::vector<double> expected335{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot335{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_borrowed_arr * Logical_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Logical_borrowed_arr, expected335, expected_dot335));
        
  std::vector<double> expected336{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"unary * Logical_borrowed_arr">(compare_result(unary * Logical_borrowed_arr, expected336));
      
  std::vector<double> expected337{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"binary * Logical_borrowed_arr">(compare_result(binary * Logical_borrowed_arr, expected337));
      
  std::vector<double> expected338{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"sub * Logical_borrowed_arr">(compare_result(sub * Logical_borrowed_arr, expected338));
      
  std::vector<double> expected339{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"subset(create_r_array(), true, true, true) * Logical_borrowed_arr">(compare_result(subset(create_r_array(), true, true, true) * Logical_borrowed_arr, expected339));
      
  std::vector<double> expected340{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"create_r_array() * Logical_borrowed_arr">(compare_result(create_r_array() * Logical_borrowed_arr, expected340));
      
  std::vector<double> expected341{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"logical_etr * Integer_borrowed_arr">(compare_result(logical_etr * Integer_borrowed_arr, expected341));
      
  std::vector<double> expected342{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"integer_etr * Integer_borrowed_arr">(compare_result(integer_etr * Integer_borrowed_arr, expected342));
      
  std::vector<double> expected343{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"double_etr * Integer_borrowed_arr">(compare_result(double_etr * Integer_borrowed_arr, expected343));
      
  std::vector<double> expected344{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot344{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: dual_etr * Integer_borrowed_arr">(compare_result_dual(dual_etr * Integer_borrowed_arr, expected344, expected_dot344));
        
  std::vector<double> expected345{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot_l345{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r345{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Integer_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Integer_borrowed_arr, rev_ad_etr * Integer_borrowed_arr, expected345, expected_dot_l345, expected_dot_r345));
        
  std::vector<double> expected346{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_arr * Integer_borrowed_arr">(compare_result(Logical_arr * Integer_borrowed_arr, expected346));
      
  std::vector<double> expected347{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_arr * Integer_borrowed_arr">(compare_result(Integer_arr * Integer_borrowed_arr, expected347));
      
  std::vector<double> expected348{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_arr * Integer_borrowed_arr">(compare_result(Double_arr * Integer_borrowed_arr, expected348));
      
  std::vector<double> expected349{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot349{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_arr * Integer_borrowed_arr">(compare_result_dual(Dual_arr * Integer_borrowed_arr, expected349, expected_dot349));
        
  std::vector<double> expected350{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l350{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r350{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Integer_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Integer_borrowed_arr, rev_ad_arr * Integer_borrowed_arr, expected350, expected_dot_l350, expected_dot_r350));
        
  std::vector<double> expected351{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_r_arr * Integer_borrowed_arr">(compare_result(Logical_r_arr * Integer_borrowed_arr, expected351));
      
  std::vector<double> expected352{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_r_arr * Integer_borrowed_arr">(compare_result(Integer_r_arr * Integer_borrowed_arr, expected352));
      
  std::vector<double> expected353{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_r_arr * Integer_borrowed_arr">(compare_result(Double_r_arr * Integer_borrowed_arr, expected353));
      
  std::vector<double> expected354{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot354{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_r_arr * Integer_borrowed_arr">(compare_result_dual(Dual_r_arr * Integer_borrowed_arr, expected354, expected_dot354));
        
  std::vector<double> expected355{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot_l355{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
 std::vector<double> expected_dot_r355{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Integer_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Integer_borrowed_arr, rev_ad_r_arr * Integer_borrowed_arr, expected355, expected_dot_l355, expected_dot_r355));
        
  std::vector<double> expected356{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_borrowed_arr * Integer_borrowed_arr">(compare_result(Logical_borrowed_arr * Integer_borrowed_arr, expected356));
      
  std::vector<double> expected357{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_borrowed_arr * Integer_borrowed_arr">(compare_result(Integer_borrowed_arr * Integer_borrowed_arr, expected357));
      
  std::vector<double> expected358{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_borrowed_arr * Integer_borrowed_arr">(compare_result(Double_borrowed_arr * Integer_borrowed_arr, expected358));
      
  std::vector<double> expected359{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot359{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_borrowed_arr * Integer_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Integer_borrowed_arr, expected359, expected_dot359));
        
  std::vector<double> expected360{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"unary * Integer_borrowed_arr">(compare_result(unary * Integer_borrowed_arr, expected360));
      
  std::vector<double> expected361{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"binary * Integer_borrowed_arr">(compare_result(binary * Integer_borrowed_arr, expected361));
      
  std::vector<double> expected362{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"sub * Integer_borrowed_arr">(compare_result(sub * Integer_borrowed_arr, expected362));
      
  std::vector<double> expected363{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"subset(create_r_array(), true, true, true) * Integer_borrowed_arr">(compare_result(subset(create_r_array(), true, true, true) * Integer_borrowed_arr, expected363));
      
  std::vector<double> expected364{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"create_r_array() * Integer_borrowed_arr">(compare_result(create_r_array() * Integer_borrowed_arr, expected364));
      
  std::vector<double> expected365{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * Double_borrowed_arr">(compare_result(logical_etr * Double_borrowed_arr, expected365));
      
  std::vector<double> expected366{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * Double_borrowed_arr">(compare_result(integer_etr * Double_borrowed_arr, expected366));
      
  std::vector<double> expected367{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * Double_borrowed_arr">(compare_result(double_etr * Double_borrowed_arr, expected367));
      
  std::vector<double> expected368{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot368{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * Double_borrowed_arr">(compare_result_dual(dual_etr * Double_borrowed_arr, expected368, expected_dot368));
        
  std::vector<double> expected369{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l369{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r369{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * Double_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_etr, Double_borrowed_arr, rev_ad_etr * Double_borrowed_arr, expected369, expected_dot_l369, expected_dot_r369));
        
  std::vector<double> expected370{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * Double_borrowed_arr">(compare_result(Logical_arr * Double_borrowed_arr, expected370));
      
  std::vector<double> expected371{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * Double_borrowed_arr">(compare_result(Integer_arr * Double_borrowed_arr, expected371));
      
  std::vector<double> expected372{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * Double_borrowed_arr">(compare_result(Double_arr * Double_borrowed_arr, expected372));
      
  std::vector<double> expected373{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot373{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * Double_borrowed_arr">(compare_result_dual(Dual_arr * Double_borrowed_arr, expected373, expected_dot373));
        
  std::vector<double> expected374{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l374{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r374{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * Double_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_arr, Double_borrowed_arr, rev_ad_arr * Double_borrowed_arr, expected374, expected_dot_l374, expected_dot_r374));
        
  std::vector<double> expected375{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * Double_borrowed_arr">(compare_result(Logical_r_arr * Double_borrowed_arr, expected375));
      
  std::vector<double> expected376{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * Double_borrowed_arr">(compare_result(Integer_r_arr * Double_borrowed_arr, expected376));
      
  std::vector<double> expected377{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * Double_borrowed_arr">(compare_result(Double_r_arr * Double_borrowed_arr, expected377));
      
  std::vector<double> expected378{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot378{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * Double_borrowed_arr">(compare_result_dual(Dual_r_arr * Double_borrowed_arr, expected378, expected_dot378));
        
  std::vector<double> expected379{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l379{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r379{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * Double_borrowed_arr">(compare_result_reverse_ad_binary(rev_ad_r_arr, Double_borrowed_arr, rev_ad_r_arr * Double_borrowed_arr, expected379, expected_dot_l379, expected_dot_r379));
        
  std::vector<double> expected380{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * Double_borrowed_arr">(compare_result(Logical_borrowed_arr * Double_borrowed_arr, expected380));
      
  std::vector<double> expected381{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * Double_borrowed_arr">(compare_result(Integer_borrowed_arr * Double_borrowed_arr, expected381));
      
  std::vector<double> expected382{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * Double_borrowed_arr">(compare_result(Double_borrowed_arr * Double_borrowed_arr, expected382));
      
  std::vector<double> expected383{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot383{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * Double_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Double_borrowed_arr, expected383, expected_dot383));
        
  std::vector<double> expected384{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * Double_borrowed_arr">(compare_result(unary * Double_borrowed_arr, expected384));
      
  std::vector<double> expected385{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * Double_borrowed_arr">(compare_result(binary * Double_borrowed_arr, expected385));
      
  std::vector<double> expected386{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * Double_borrowed_arr">(compare_result(sub * Double_borrowed_arr, expected386));
      
  std::vector<double> expected387{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * Double_borrowed_arr">(compare_result(subset(create_r_array(), true, true, true) * Double_borrowed_arr, expected387));
      
  std::vector<double> expected388{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * Double_borrowed_arr">(compare_result(create_r_array() * Double_borrowed_arr, expected388));
      
  std::vector<double> expected389{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot389{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: logical_etr * Dual_borrowed_arr">(compare_result_dual(logical_etr * Dual_borrowed_arr, expected389, expected_dot389));
        
  std::vector<double> expected390{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot390{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: integer_etr * Dual_borrowed_arr">(compare_result_dual(integer_etr * Dual_borrowed_arr, expected390, expected_dot390));
        
  std::vector<double> expected391{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot391{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: double_etr * Dual_borrowed_arr">(compare_result_dual(double_etr * Dual_borrowed_arr, expected391, expected_dot391));
        
  std::vector<double> expected392{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot392{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: dual_etr * Dual_borrowed_arr">(compare_result_dual(dual_etr * Dual_borrowed_arr, expected392, expected_dot392));
        
  std::vector<double> expected393{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot393{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * Dual_borrowed_arr">(compare_result_dual(Logical_arr * Dual_borrowed_arr, expected393, expected_dot393));
        
  std::vector<double> expected394{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot394{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * Dual_borrowed_arr">(compare_result_dual(Integer_arr * Dual_borrowed_arr, expected394, expected_dot394));
        
  std::vector<double> expected395{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot395{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * Dual_borrowed_arr">(compare_result_dual(Double_arr * Dual_borrowed_arr, expected395, expected_dot395));
        
  std::vector<double> expected396{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot396{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * Dual_borrowed_arr">(compare_result_dual(Dual_arr * Dual_borrowed_arr, expected396, expected_dot396));
        
  std::vector<double> expected397{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot397{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * Dual_borrowed_arr">(compare_result_dual(Logical_r_arr * Dual_borrowed_arr, expected397, expected_dot397));
        
  std::vector<double> expected398{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot398{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * Dual_borrowed_arr">(compare_result_dual(Integer_r_arr * Dual_borrowed_arr, expected398, expected_dot398));
        
  std::vector<double> expected399{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot399{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * Dual_borrowed_arr">(compare_result_dual(Double_r_arr * Dual_borrowed_arr, expected399, expected_dot399));
        
  std::vector<double> expected400{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot400{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * Dual_borrowed_arr">(compare_result_dual(Dual_r_arr * Dual_borrowed_arr, expected400, expected_dot400));
        
  std::vector<double> expected401{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot401{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Logical_borrowed_arr * Dual_borrowed_arr, expected401, expected_dot401));
        
  std::vector<double> expected402{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot402{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Integer_borrowed_arr * Dual_borrowed_arr, expected402, expected_dot402));
        
  std::vector<double> expected403{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot403{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Double_borrowed_arr * Dual_borrowed_arr, expected403, expected_dot403));
        
  std::vector<double> expected404{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot404{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Dual_borrowed_arr, expected404, expected_dot404));
        
  std::vector<double> expected405{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot405{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * Dual_borrowed_arr">(compare_result_dual(unary * Dual_borrowed_arr, expected405, expected_dot405));
        
  std::vector<double> expected406{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot406{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * Dual_borrowed_arr">(compare_result_dual(binary * Dual_borrowed_arr, expected406, expected_dot406));
        
  std::vector<double> expected407{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot407{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * Dual_borrowed_arr">(compare_result_dual(sub * Dual_borrowed_arr, expected407, expected_dot407));
        
  std::vector<double> expected408{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot408{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * Dual_borrowed_arr">(compare_result_dual(subset(create_r_array(), true, true, true) * Dual_borrowed_arr, expected408, expected_dot408));
        
  std::vector<double> expected409{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot409{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * Dual_borrowed_arr">(compare_result_dual(create_r_array() * Dual_borrowed_arr, expected409, expected_dot409));
        
  std::vector<double> expected410{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"logical_etr * unary">(compare_result(logical_etr * unary, expected410));
      
  std::vector<double> expected411{10.0831750813296, 90.011943366205, 87.1841460315362, 4.19964690576234, -82.6459882175054, -93.507282915101, -18.3984129314817, 73.6258730527135, 97.9588708953537, 32.2289345972846, -63.1321355381811, -100.449811408603, -45.4143939179948, 51.3748079016097, 100.93024826354, 57.6908838356589, -38.5892131355849, -99.390565513246, -68.8126903211055, 25.0312550062789, 95.8615799184374, 78.5572103419104, -10.9722961378321, -90.4139241497879, -86.7294072636029, -3.30627331241538, 83.1566330745462, 93.1657145092317, 17.5186676798351, -74.2349614229265, -97.7373093455143, -31.3804257945316, 63.8274765136954, 100.35269127072, 44.6141044735916, -52.1424842280726, -100.959513397833, -56.9548315482765, 39.4138597661026, 99.5456301778539, 68.1556072822806, -25.8963666329348, -96.1393404930434, -77.9922480731323, 11.8605575455367, 90.8088212546028, 86.2678734885226, 2.41264068177662, -83.6607628413322, -92.8168468294954, -16.6375498894404, 74.8382336909737, 97.5080903501039, 30.5294584229464, -64.517816784457, -100.247708779387, -43.8103196385441, 52.9060753363358, 100.980868635856, 56.2143170087052};
  ass<"integer_etr * unary">(compare_result(integer_etr * unary, expected411));
      
  std::vector<double> expected412{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  ass<"double_etr * unary">(compare_result(double_etr * unary, expected412));
      
  std::vector<double> expected413{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  std::vector<double> expected_dot413{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: dual_etr * unary">(compare_result_dual(dual_etr * unary, expected413, expected_dot413));
        
  std::vector<double> expected414{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  std::vector<double> expected_dot_l414{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
 std::vector<double> expected_dot_r414{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * unary">(compare_result_reverse_ad_binary(rev_ad_etr, unary, rev_ad_etr * unary, expected414, expected_dot_l414, expected_dot_r414));
        
  std::vector<double> expected415{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"Logical_arr * unary">(compare_result(Logical_arr * unary, expected415));
      
  std::vector<double> expected416{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"Integer_arr * unary">(compare_result(Integer_arr * unary, expected416));
      
  std::vector<double> expected417{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"Double_arr * unary">(compare_result(Double_arr * unary, expected417));
      
  std::vector<double> expected418{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot418{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: Dual_arr * unary">(compare_result_dual(Dual_arr * unary, expected418, expected_dot418));
        
  std::vector<double> expected419{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot_l419{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
 std::vector<double> expected_dot_r419{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * unary">(compare_result_reverse_ad_binary(rev_ad_arr, unary, rev_ad_arr * unary, expected419, expected_dot_l419, expected_dot_r419));
        
  std::vector<double> expected420{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"Logical_r_arr * unary">(compare_result(Logical_r_arr * unary, expected420));
      
  std::vector<double> expected421{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"Integer_r_arr * unary">(compare_result(Integer_r_arr * unary, expected421));
      
  std::vector<double> expected422{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"Double_r_arr * unary">(compare_result(Double_r_arr * unary, expected422));
      
  std::vector<double> expected423{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot423{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: Dual_r_arr * unary">(compare_result_dual(Dual_r_arr * unary, expected423, expected_dot423));
        
  std::vector<double> expected424{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot_l424{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
 std::vector<double> expected_dot_r424{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * unary">(compare_result_reverse_ad_binary(rev_ad_r_arr, unary, rev_ad_r_arr * unary, expected424, expected_dot_l424, expected_dot_r424));
        
  std::vector<double> expected425{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"Logical_borrowed_arr * unary">(compare_result(Logical_borrowed_arr * unary, expected425));
      
  std::vector<double> expected426{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"Integer_borrowed_arr * unary">(compare_result(Integer_borrowed_arr * unary, expected426));
      
  std::vector<double> expected427{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"Double_borrowed_arr * unary">(compare_result(Double_borrowed_arr * unary, expected427));
      
  std::vector<double> expected428{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot428{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: Dual_borrowed_arr * unary">(compare_result_dual(Dual_borrowed_arr * unary, expected428, expected_dot428));
        
  std::vector<double> expected429{0.00996671107937919, 0.794250558627673, 0.74513041067035, 0.00172895148839126, 0.669577430491917, 0.8571328260136, 0.0331831779626813, 0.531395861462041, 0.940686245181117, 0.101823764854038, 0.390713316107369, 0.989134850703254, 0.202182842362396, 0.258736485337448, 0.998619254439737, 0.32626586390937, 0.145978567828997, 0.968383934226335, 0.464188447135415, 0.061421794646541, 0.900837418337315, 0.604963758131865, 0.0118019098653352, 0.80136042350393, 0.737377716331329, 0.00107160505993433, 0.677877230104374, 0.850882301736659, 0.0300856501594451, 0.540224438531849, 0.936435804146727, 0.0965328029650136, 0.399367391246577, 0.987223080607432, 0.19511992137835, 0.266526679881855, 0.999198445792299, 0.317993612066714, 0.152284319347319, 0.971407948976185, 0.455365827273449, 0.0657407905879208, 0.906065365203151, 0.596293575090777, 0.0137901014891664, 0.808375847235604, 0.72955063192155, 0.000570614161294341, 0.686121286069369, 0.844521817014999, 0.027135385386101, 0.549040409958317, 0.932048591679642, 0.0913682807174212, 0.408053002904888, 0.985158623224859, 0.188152544537928, 0.274390040926775, 0.999621196985777, 0.309778397878169};
  ass<"unary * unary">(compare_result(unary * unary, expected429));
      
  std::vector<double> expected430{0.0199666833293656, 1.96065619213516, 3.62547933992527, 0.257800107086401, -6.70987231072816, -9.44330975974287, -2.22238255211957, 10.3513603697874, 15.7122149356904, 5.80759019475821, -12.6264271076362, -22.0790674581286, -10.8814686417374, 13.3269303665562, 28.1805247626913, 17.2501454637317, -12.3026996333251, -33.6550231737922, -24.6635583131091, 9.46726674494907, 38.1548070566454, 32.8229136280061, -4.80173751774433, -41.3576563932693, -41.3896775257986, -1.64331604240843, 42.9779826385279, 49.9958586772313, 9.74801112481914, -42.7769777704389, -58.2553071544551, -19.32537113287, 40.571524675042, 65.7757243774421, 30.1255636148411, -36.2416078496109, -72.1710580923124, -41.8420643651695, 29.7360011304655, 77.0739433654275, 54.1196010300881, -21.0760528438341, -80.1478462328144, -66.5636810287525, 10.3574373813498, 81.0985710610413, 78.7514647093246, 2.250205467558, -79.6848057954075, -90.2437065213509, -16.5057673160586, 75.7274008239358, 100.597455588919, 32.1012721239298, -69.1171066938441, -109.37918324246, -48.6684936974718, 59.8205327070252, 116.177989460262, 65.7874482220688};
  ass<"binary * unary">(compare_result(binary * unary, expected430));
      
  std::vector<double> expected431{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"sub * unary">(compare_result(sub * unary, expected431));
      
  std::vector<double> expected432{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"subset(create_r_array(), true, true, true) * unary">(compare_result(subset(create_r_array(), true, true, true) * unary, expected432));
      
  std::vector<double> expected433{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"create_r_array() * unary">(compare_result(create_r_array() * unary, expected433));
      
  std::vector<double> expected434{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"logical_etr * binary">(compare_result(logical_etr * binary, expected434));
      
  std::vector<double> expected435{20.2, 222.2, 424.2, 626.2, 828.2, 1030.2, 1232.2, 1434.2, 1636.2, 1838.2, 2040.2, 2242.2, 2444.2, 2646.2, 2848.2, 3050.2, 3252.2, 3454.2, 3656.2, 3858.2, 4060.2, 4262.2, 4464.2, 4666.2, 4868.2, 5070.2, 5272.2, 5474.2, 5676.2, 5878.2, 6080.2, 6282.2, 6484.2, 6686.2, 6888.2, 7090.2, 7292.2, 7494.2, 7696.2, 7898.2, 8100.2, 8302.2, 8504.2, 8706.2, 8908.2, 9110.2, 9312.2, 9514.2, 9716.2, 9918.2, 10120.2, 10322.2, 10524.2, 10726.2, 10928.2, 11130.2, 11332.2, 11534.2, 11736.2, 11938.2};
  ass<"integer_etr * binary">(compare_result(integer_etr * binary, expected435));
      
  std::vector<double> expected436{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  ass<"double_etr * binary">(compare_result(double_etr * binary, expected436));
      
  std::vector<double> expected437{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  std::vector<double> expected_dot437{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: dual_etr * binary">(compare_result_dual(dual_etr * binary, expected437, expected_dot437));
        
  std::vector<double> expected438{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  std::vector<double> expected_dot_l438{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
 std::vector<double> expected_dot_r438{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * binary">(compare_result_reverse_ad_binary(rev_ad_etr, binary, rev_ad_etr * binary, expected438, expected_dot_l438, expected_dot_r438));
        
  std::vector<double> expected439{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"Logical_arr * binary">(compare_result(Logical_arr * binary, expected439));
      
  std::vector<double> expected440{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"Integer_arr * binary">(compare_result(Integer_arr * binary, expected440));
      
  std::vector<double> expected441{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"Double_arr * binary">(compare_result(Double_arr * binary, expected441));
      
  std::vector<double> expected442{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot442{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * binary">(compare_result_dual(Dual_arr * binary, expected442, expected_dot442));
        
  std::vector<double> expected443{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot_l443{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
 std::vector<double> expected_dot_r443{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * binary">(compare_result_reverse_ad_binary(rev_ad_arr, binary, rev_ad_arr * binary, expected443, expected_dot_l443, expected_dot_r443));
        
  std::vector<double> expected444{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"Logical_r_arr * binary">(compare_result(Logical_r_arr * binary, expected444));
      
  std::vector<double> expected445{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"Integer_r_arr * binary">(compare_result(Integer_r_arr * binary, expected445));
      
  std::vector<double> expected446{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"Double_r_arr * binary">(compare_result(Double_r_arr * binary, expected446));
      
  std::vector<double> expected447{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot447{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * binary">(compare_result_dual(Dual_r_arr * binary, expected447, expected_dot447));
        
  std::vector<double> expected448{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot_l448{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
 std::vector<double> expected_dot_r448{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * binary">(compare_result_reverse_ad_binary(rev_ad_r_arr, binary, rev_ad_r_arr * binary, expected448, expected_dot_l448, expected_dot_r448));
        
  std::vector<double> expected449{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"Logical_borrowed_arr * binary">(compare_result(Logical_borrowed_arr * binary, expected449));
      
  std::vector<double> expected450{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"Integer_borrowed_arr * binary">(compare_result(Integer_borrowed_arr * binary, expected450));
      
  std::vector<double> expected451{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"Double_borrowed_arr * binary">(compare_result(Double_borrowed_arr * binary, expected451));
      
  std::vector<double> expected452{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot452{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * binary">(compare_result_dual(Dual_borrowed_arr * binary, expected452, expected_dot452));
        
  std::vector<double> expected453{0.0199666833293656, 1.96065619213516, 3.62547933992527, 0.257800107086401, -6.70987231072816, -9.44330975974287, -2.22238255211957, 10.3513603697874, 15.7122149356904, 5.80759019475821, -12.6264271076362, -22.0790674581286, -10.8814686417374, 13.3269303665562, 28.1805247626913, 17.2501454637317, -12.3026996333251, -33.6550231737922, -24.6635583131091, 9.46726674494907, 38.1548070566454, 32.8229136280061, -4.80173751774433, -41.3576563932693, -41.3896775257986, -1.64331604240843, 42.9779826385279, 49.9958586772313, 9.74801112481914, -42.7769777704389, -58.2553071544551, -19.32537113287, 40.571524675042, 65.7757243774421, 30.1255636148411, -36.2416078496109, -72.1710580923124, -41.8420643651695, 29.7360011304655, 77.0739433654275, 54.1196010300881, -21.0760528438341, -80.1478462328144, -66.5636810287525, 10.3574373813498, 81.0985710610413, 78.7514647093246, 2.250205467558, -79.6848057954075, -90.2437065213509, -16.5057673160586, 75.7274008239358, 100.597455588919, 32.1012721239298, -69.1171066938441, -109.37918324246, -48.6684936974718, 59.8205327070252, 116.177989460262, 65.7874482220688};
  ass<"unary * binary">(compare_result(unary * binary, expected453));
      
  std::vector<double> expected454{0.04, 4.84, 17.64, 38.44, 67.24, 104.04, 148.84, 201.64, 262.44, 331.24, 408.04, 492.84, 585.64, 686.44, 795.24, 912.04, 1036.84, 1169.64, 1310.44, 1459.24, 1616.04, 1780.84, 1953.64, 2134.44, 2323.24, 2520.04, 2724.84, 2937.64, 3158.44, 3387.24, 3624.04, 3868.84, 4121.64, 4382.44, 4651.24, 4928.04, 5212.84, 5505.64, 5806.44, 6115.24, 6432.04, 6756.84, 7089.64, 7430.44, 7779.24, 8136.04, 8500.84, 8873.64, 9254.44, 9643.24, 10040.04, 10444.84, 10857.64, 11278.44, 11707.24, 12144.04, 12588.84, 13041.64, 13502.44, 13971.24};
  ass<"binary * binary">(compare_result(binary * binary, expected454));
      
  std::vector<double> expected455{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"sub * binary">(compare_result(sub * binary, expected455));
      
  std::vector<double> expected456{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"subset(create_r_array(), true, true, true) * binary">(compare_result(subset(create_r_array(), true, true, true) * binary, expected456));
      
  std::vector<double> expected457{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"create_r_array() * binary">(compare_result(create_r_array() * binary, expected457));
      
  std::vector<double> expected458{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * sub">(compare_result(logical_etr * sub, expected458));
      
  std::vector<double> expected459{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * sub">(compare_result(integer_etr * sub, expected459));
      
  std::vector<double> expected460{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * sub">(compare_result(double_etr * sub, expected460));
      
  std::vector<double> expected461{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot461{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * sub">(compare_result_dual(dual_etr * sub, expected461, expected_dot461));
        
  std::vector<double> expected462{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l462{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r462{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * sub">(compare_result_reverse_ad_binary(rev_ad_etr, sub, rev_ad_etr * sub, expected462, expected_dot_l462, expected_dot_r462));
        
  std::vector<double> expected463{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * sub">(compare_result(Logical_arr * sub, expected463));
      
  std::vector<double> expected464{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * sub">(compare_result(Integer_arr * sub, expected464));
      
  std::vector<double> expected465{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * sub">(compare_result(Double_arr * sub, expected465));
      
  std::vector<double> expected466{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot466{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * sub">(compare_result_dual(Dual_arr * sub, expected466, expected_dot466));
        
  std::vector<double> expected467{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l467{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r467{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * sub">(compare_result_reverse_ad_binary(rev_ad_arr, sub, rev_ad_arr * sub, expected467, expected_dot_l467, expected_dot_r467));
        
  std::vector<double> expected468{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * sub">(compare_result(Logical_r_arr * sub, expected468));
      
  std::vector<double> expected469{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * sub">(compare_result(Integer_r_arr * sub, expected469));
      
  std::vector<double> expected470{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * sub">(compare_result(Double_r_arr * sub, expected470));
      
  std::vector<double> expected471{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot471{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * sub">(compare_result_dual(Dual_r_arr * sub, expected471, expected_dot471));
        
  std::vector<double> expected472{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l472{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r472{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * sub">(compare_result_reverse_ad_binary(rev_ad_r_arr, sub, rev_ad_r_arr * sub, expected472, expected_dot_l472, expected_dot_r472));
        
  std::vector<double> expected473{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * sub">(compare_result(Logical_borrowed_arr * sub, expected473));
      
  std::vector<double> expected474{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * sub">(compare_result(Integer_borrowed_arr * sub, expected474));
      
  std::vector<double> expected475{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * sub">(compare_result(Double_borrowed_arr * sub, expected475));
      
  std::vector<double> expected476{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot476{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * sub">(compare_result_dual(Dual_borrowed_arr * sub, expected476, expected_dot476));
        
  std::vector<double> expected477{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * sub">(compare_result(unary * sub, expected477));
      
  std::vector<double> expected478{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * sub">(compare_result(binary * sub, expected478));
      
  std::vector<double> expected479{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * sub">(compare_result(sub * sub, expected479));
      
  std::vector<double> expected480{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * sub">(compare_result(subset(create_r_array(), true, true, true) * sub, expected480));
      
  std::vector<double> expected481{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * sub">(compare_result(create_r_array() * sub, expected481));
      
  std::vector<double> expected482{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * subset(create_r_array(), true, true, true)">(compare_result(logical_etr * subset(create_r_array(), true, true, true), expected482));
      
  std::vector<double> expected483{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * subset(create_r_array(), true, true, true)">(compare_result(integer_etr * subset(create_r_array(), true, true, true), expected483));
      
  std::vector<double> expected484{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * subset(create_r_array(), true, true, true)">(compare_result(double_etr * subset(create_r_array(), true, true, true), expected484));
      
  std::vector<double> expected485{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot485{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * subset(create_r_array(), true, true, true)">(compare_result_dual(dual_etr * subset(create_r_array(), true, true, true), expected485, expected_dot485));
        
  std::vector<double> expected486{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l486{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r486{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * subset(create_r_array(), true, true, true)">(compare_result_reverse_ad_binary(rev_ad_etr, subset(create_r_array(), true, true, true), rev_ad_etr * subset(create_r_array(), true, true, true), expected486, expected_dot_l486, expected_dot_r486));
        
  std::vector<double> expected487{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * subset(create_r_array(), true, true, true)">(compare_result(Logical_arr * subset(create_r_array(), true, true, true), expected487));
      
  std::vector<double> expected488{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * subset(create_r_array(), true, true, true)">(compare_result(Integer_arr * subset(create_r_array(), true, true, true), expected488));
      
  std::vector<double> expected489{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * subset(create_r_array(), true, true, true)">(compare_result(Double_arr * subset(create_r_array(), true, true, true), expected489));
      
  std::vector<double> expected490{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot490{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * subset(create_r_array(), true, true, true)">(compare_result_dual(Dual_arr * subset(create_r_array(), true, true, true), expected490, expected_dot490));
        
  std::vector<double> expected491{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l491{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r491{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * subset(create_r_array(), true, true, true)">(compare_result_reverse_ad_binary(rev_ad_arr, subset(create_r_array(), true, true, true), rev_ad_arr * subset(create_r_array(), true, true, true), expected491, expected_dot_l491, expected_dot_r491));
        
  std::vector<double> expected492{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * subset(create_r_array(), true, true, true)">(compare_result(Logical_r_arr * subset(create_r_array(), true, true, true), expected492));
      
  std::vector<double> expected493{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * subset(create_r_array(), true, true, true)">(compare_result(Integer_r_arr * subset(create_r_array(), true, true, true), expected493));
      
  std::vector<double> expected494{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * subset(create_r_array(), true, true, true)">(compare_result(Double_r_arr * subset(create_r_array(), true, true, true), expected494));
      
  std::vector<double> expected495{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot495{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * subset(create_r_array(), true, true, true)">(compare_result_dual(Dual_r_arr * subset(create_r_array(), true, true, true), expected495, expected_dot495));
        
  std::vector<double> expected496{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l496{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r496{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * subset(create_r_array(), true, true, true)">(compare_result_reverse_ad_binary(rev_ad_r_arr, subset(create_r_array(), true, true, true), rev_ad_r_arr * subset(create_r_array(), true, true, true), expected496, expected_dot_l496, expected_dot_r496));
        
  std::vector<double> expected497{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result(Logical_borrowed_arr * subset(create_r_array(), true, true, true), expected497));
      
  std::vector<double> expected498{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result(Integer_borrowed_arr * subset(create_r_array(), true, true, true), expected498));
      
  std::vector<double> expected499{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result(Double_borrowed_arr * subset(create_r_array(), true, true, true), expected499));
      
  std::vector<double> expected500{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot500{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result_dual(Dual_borrowed_arr * subset(create_r_array(), true, true, true), expected500, expected_dot500));
        
  std::vector<double> expected501{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * subset(create_r_array(), true, true, true)">(compare_result(unary * subset(create_r_array(), true, true, true), expected501));
      
  std::vector<double> expected502{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * subset(create_r_array(), true, true, true)">(compare_result(binary * subset(create_r_array(), true, true, true), expected502));
      
  std::vector<double> expected503{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * subset(create_r_array(), true, true, true)">(compare_result(sub * subset(create_r_array(), true, true, true), expected503));
      
  std::vector<double> expected504{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * subset(create_r_array(), true, true, true)">(compare_result(subset(create_r_array(), true, true, true) * subset(create_r_array(), true, true, true), expected504));
      
  std::vector<double> expected505{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * subset(create_r_array(), true, true, true)">(compare_result(create_r_array() * subset(create_r_array(), true, true, true), expected505));
      
  std::vector<double> expected506{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * create_r_array()">(compare_result(logical_etr * create_r_array(), expected506));
      
  std::vector<double> expected507{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * create_r_array()">(compare_result(integer_etr * create_r_array(), expected507));
      
  std::vector<double> expected508{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * create_r_array()">(compare_result(double_etr * create_r_array(), expected508));
      
  std::vector<double> expected509{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot509{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * create_r_array()">(compare_result_dual(dual_etr * create_r_array(), expected509, expected_dot509));
        
  std::vector<double> expected510{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot_l510{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r510{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_etr * create_r_array()">(compare_result_reverse_ad_binary(rev_ad_etr, create_r_array(), rev_ad_etr * create_r_array(), expected510, expected_dot_l510, expected_dot_r510));
        
  std::vector<double> expected511{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * create_r_array()">(compare_result(Logical_arr * create_r_array(), expected511));
      
  std::vector<double> expected512{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * create_r_array()">(compare_result(Integer_arr * create_r_array(), expected512));
      
  std::vector<double> expected513{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * create_r_array()">(compare_result(Double_arr * create_r_array(), expected513));
      
  std::vector<double> expected514{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot514{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * create_r_array()">(compare_result_dual(Dual_arr * create_r_array(), expected514, expected_dot514));
        
  std::vector<double> expected515{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l515{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r515{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_arr * create_r_array()">(compare_result_reverse_ad_binary(rev_ad_arr, create_r_array(), rev_ad_arr * create_r_array(), expected515, expected_dot_l515, expected_dot_r515));
        
  std::vector<double> expected516{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * create_r_array()">(compare_result(Logical_r_arr * create_r_array(), expected516));
      
  std::vector<double> expected517{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * create_r_array()">(compare_result(Integer_r_arr * create_r_array(), expected517));
      
  std::vector<double> expected518{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * create_r_array()">(compare_result(Double_r_arr * create_r_array(), expected518));
      
  std::vector<double> expected519{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot519{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * create_r_array()">(compare_result_dual(Dual_r_arr * create_r_array(), expected519, expected_dot519));
        
  std::vector<double> expected520{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot_l520{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
 std::vector<double> expected_dot_r520{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  ass<"deriv of: rev_ad_r_arr * create_r_array()">(compare_result_reverse_ad_binary(rev_ad_r_arr, create_r_array(), rev_ad_r_arr * create_r_array(), expected520, expected_dot_l520, expected_dot_r520));
        
  std::vector<double> expected521{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * create_r_array()">(compare_result(Logical_borrowed_arr * create_r_array(), expected521));
      
  std::vector<double> expected522{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * create_r_array()">(compare_result(Integer_borrowed_arr * create_r_array(), expected522));
      
  std::vector<double> expected523{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * create_r_array()">(compare_result(Double_borrowed_arr * create_r_array(), expected523));
      
  std::vector<double> expected524{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot524{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * create_r_array()">(compare_result_dual(Dual_borrowed_arr * create_r_array(), expected524, expected_dot524));
        
  std::vector<double> expected525{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * create_r_array()">(compare_result(unary * create_r_array(), expected525));
      
  std::vector<double> expected526{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * create_r_array()">(compare_result(binary * create_r_array(), expected526));
      
  std::vector<double> expected527{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * create_r_array()">(compare_result(sub * create_r_array(), expected527));
      
  std::vector<double> expected528{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * create_r_array()">(compare_result(subset(create_r_array(), true, true, true) * create_r_array(), expected528));
      
  std::vector<double> expected529{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * create_r_array()">(compare_result(create_r_array() * create_r_array(), expected529));
      
}
