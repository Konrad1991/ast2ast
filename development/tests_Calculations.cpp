#define STANDALONE_ETR
#include "../inst/include/etr_bits/Core.hpp"
#include "../inst/include/etr_bits/Calculations/BinaryCalculations.hpp"
#include "../inst/include/etr_bits/Calculations/UnaryCalculations.hpp"
#include "../inst/include/etr_bits/Subsetting/PreservingSubsetting.hpp"
using namespace etr;
#include <cstring>

template<typename T>
auto compare_result(const T& etr, const std::vector<double>& expected) {
  auto compare = [](double l, double r) {
    double TOL = 1e-5;
    return std::abs(l - r) < TOL;
  };
  if (etr.size() != expected.size()) return false;
  for (std::size_t i = 0; i < etr.size(); i++) {
    if(!compare(etr.get(i).val, expected[i])) return false;
  }
  return true;
}
template<typename T>
auto compare_result_dual(const T& etr,
                         const std::vector<double>& expected_val,
                         const std::vector<double>& expected_dot) {
  auto compare = [](double l, double r) {
    double TOL = 1e-5;
    return std::abs(l - r) < TOL;
  };
  if (etr.size() != expected_val.size()) return false;
  for (std::size_t i = 0; i < etr.size(); i++) {
    if(!compare(etr.get(i).val, expected_val[i])) return false;
    if(!compare(etr.get(i).dot, expected_dot[i])) return false;
  }
  return true;
}

int main() {
  auto compare = [](double l, double r) {
    double TOL = 1e-12;
    return std::abs(l - r) < TOL;
  };
  auto create_r_array = []() {
    Array<Double, Buffer<Double, RBufferTrait>> a_r(SI{60});
    for (std::size_t i = 0; i <a_r.size(); i++) {
      a_r.set(i, static_cast<double>(i) + 0.1);
    }
    a_r.dim.resize(3);
    a_r.dim[0] = 3;
    a_r.dim[1] = 4;
    a_r.dim[2] = 5;
    return a_r;
  };
  std::vector<double> expected_sin_logical_arr {
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000,
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000,
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000,
    0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000, 0.841471, 0.000000, 0.000000
  };
  std::vector<double> expected_sin_integer_arr {
    0.000000000,  0.841470985,  0.909297427,  0.141120008, -0.756802495, -0.958924275, -0.279415498,  0.656986599,  0.989358247,  0.412118485,
    -0.544021111, -0.999990207, -0.536572918,  0.420167037,  0.990607356,  0.650287840, -0.287903317, -0.961397492, -0.750987247,  0.149877210,
    0.912945251,  0.836655639, -0.008851309, -0.846220404, -0.905578362, -0.132351750,  0.762558450,  0.956375928,  0.270905788, -0.663633884,
    -0.988031624, -0.404037645,  0.551426681,  0.999911860,  0.529082686, -0.428182669, -0.991778853, -0.643538133,  0.296368579,  0.963795386,
    0.745113160, -0.158622669, -0.916521548, -0.831774743,  0.017701925,  0.850903525,  0.901788348,  0.123573123, -0.768254661, -0.953752653,
    -0.262374854,  0.670229176,  0.986627592,  0.395925150, -0.558789049, -0.999755173, -0.521551002,  0.436164755,  0.992872648,  0.636738007
  };
  std::vector<double> expected_sin_double_arr {
    0.09983342,  0.89120736,  0.86320937,  0.04158066, -0.81827711, -0.92581468, -0.18216250,  0.72896904,  0.96988981,  0.31909836, -0.62507065,
    -0.99455259, -0.44964746,  0.50866146,  0.99930939,  0.57119687, -0.38207142, -0.98406501, -0.68131377,  0.24783421,  0.94912455,  0.77779416,
    -0.10863660, -0.89518737, -0.85870700, -0.03273538,  0.82333300,  0.92243282,  0.17345216, -0.73499962, -0.96769613, -0.31069729,  0.63195521,
    0.99359100,  0.44172381, -0.51626222, -0.99959914, -0.56390922,  0.39023624,  0.98560030,  0.67480799, -0.25639967, -0.95187466, -0.77220048,
    0.11743126,  0.89909724,  0.85413736,  0.02388753, -0.82832438, -0.91897868, -0.16472822,  0.74097261,  0.96542664,  0.30227187, -0.63879027,
    -0.99255157, -0.43376554,  0.52382253,  0.99981058,  0.55657740
  };
  std::vector<double> expected_sin_dual_dot_arr {
    0.99500417,  0.45359612, -0.50484610, -0.99913515, -0.57482395,  0.37797774,  0.98326844,  0.68454667, -0.24354415, -0.94772160, -0.78056818,
    0.10423603,  0.89320611,  0.86096662,  0.03715838, -0.82081309, -0.92413280, -0.17780907,  0.73199150,  0.96880246,  0.31490091, -0.62851909,
    -0.99408153, -0.44569000,  0.51246686,  0.99946405,  0.56755860, -0.38615761, -0.98484230, -0.67806752,  0.25211941,  0.95050891,  0.77500491,
    -0.11303504, -0.89715109, -0.85643057, -0.02831173,  0.82583678,  0.92071477,  0.16909184, -0.73799334, -0.96657085, -0.30648758,  0.63537896,
    0.99308101,  0.43774896, -0.52004747, -0.99971465, -0.56024880,  0.39430722,  0.98633900,  0.67153525, -0.26067491, -0.95322176, -0.76938092,
    0.12182519,  0.90102578,  0.85182742,  0.01946286, -0.83079576
  };
  std::vector<double> expected_sin_of_unary_minus {
    -0.09983342, -0.89120736, -0.86320937, -0.04158066,  0.81827711,  0.92581468,  0.18216250, -0.72896904, -0.96988981, -0.31909836,
    0.62507065,  0.99455259,  0.44964746, -0.50866146, -0.99930939, -0.57119687,  0.38207142,  0.98406501,  0.68131377, -0.24783421,
    -0.94912455, -0.77779416,  0.10863660,  0.89518737,  0.85870700,  0.03273538, -0.82333300, -0.92243282, -0.17345216,  0.73499962,
    0.96769613,  0.31069729, -0.63195521, -0.99359100, -0.44172381,  0.51626222,  0.99959914,  0.56390922, -0.39023624, -0.98560030,
    -0.67480799,  0.25639967,  0.95187466,  0.77220048, -0.11743126, -0.89909724, -0.85413736, -0.02388753,  0.82832438,  0.91897868,
    0.16472822, -0.74097261, -0.96542664, -0.30227187,  0.63879027,  0.99255157,  0.43376554, -0.52382253, -0.99981058, -0.55657740
  };
  std::vector<double> expected_sin_of_plus {
    0.19866933,  0.80849640, -0.87157577, -0.08308940,  0.94073056, -0.69987469, -0.35822928,  0.99802665, -0.47242199, -0.60483282,
    0.97582052, -0.20733642, -0.80325573,  0.87588108,  0.07426545, -0.93769174,  0.70616946,  0.34995137, -0.99743177,  0.48020478,
    0.59776037, -0.97771695,  0.21598727,  0.79795212, -0.88011776, -0.06543567,  0.93457946, -0.71240890, -0.34164604,  0.99675874,
    -0.48794995, -0.59064108,  0.97953678, -0.22462119, -0.79258599,  0.88428549,  0.05660077, -0.93139395,  0.71859253,  0.33331394,
    -0.99600761,  0.49565689,  0.58347552, -0.98127987,  0.23323751,  0.78715777, -0.88838394, -0.04776143,  0.92813548, -0.72471986,
    -0.32495573,  0.99517845, -0.50332500, -0.57626424,  0.98294608, -0.24183557, -0.78166787,  0.89241279,  0.03891835, -0.92480429
  };

  const std::size_t N = 60;
  const std::vector<std::size_t> dim{3, 4, 5};
  //BinaryOperation, SubsetView, ConstSubsetView

  // 3 C++ scalar types
  bool logical_cpp = true;
  int integer_cpp = 101;
  double double_cpp = 3.14;

  // 4 Scalar types
  Logical logical_etr = true;
  Integer integer_etr = 101;
  Double double_etr = 3.14;
  Dual dual_etr(3.14, 2.0);

  // Buffers
  Array<Logical, Buffer<Logical, LBufferTrait>> Logical_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) {
    if (i % 3 == 0) Logical_arr.set(i, true);
  }
  Logical_arr.dim = dim;

  Array<Integer, Buffer<Integer, LBufferTrait>> Integer_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Integer_arr.set(i, i);
  Integer_arr.dim = dim;

  Array<Double, Buffer<Double, LBufferTrait>> Double_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Double_arr.set(i, static_cast<double>(i) + 0.1);
  Double_arr.dim = dim;

  Array<Dual, Buffer<Dual, LBufferTrait>> Dual_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Dual_arr.set(i, Dual(static_cast<double>(i) + 0.1, 2.0));
  Dual_arr.dim = dim;

  // R Buffers
  Array<Logical, Buffer<Logical, RBufferTrait>> Logical_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) {
    if (i % 3 == 0) Logical_r_arr.set(i, true);
  }
  Logical_r_arr.dim = dim;

  Array<Integer, Buffer<Integer, RBufferTrait>> Integer_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Integer_r_arr.set(i, i);
  Integer_r_arr.dim = dim;

  Array<Double, Buffer<Double, RBufferTrait>> Double_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Double_r_arr.set(i, static_cast<double>(i) + 0.1);
  Double_r_arr.dim = dim;

  Array<Dual, Buffer<Dual, RBufferTrait>> Dual_r_arr(SI{N});
  for (std::size_t i = 0; i < N; i++) Dual_r_arr.set(i, Dual(static_cast<double>(i) + 0.1, 2.0));
  Dual_r_arr.dim = dim;

  // Borrows
  std::array<bool, N> logical_owner;
  std::vector<int> integer_owner(N);
  std::vector<double> double_owner(N);
  std::vector<double> dual_val_owner(N);
  std::vector<double> dual_dot_owner(N);
  for (std::size_t i = 0; i < N; i++) {
    if (i % 3 == 0) logical_owner[i] = true; else logical_owner[i] = false;
    integer_owner[i] = i;
    double_owner[i] = static_cast<double>(i) + 0.1;
    dual_val_owner[i] = static_cast<double>(i) + 0.1;
    dual_dot_owner[i] = 2.0;
  }
  Array<Logical, Borrow<Logical, BorrowTrait>> Logical_borrowed_arr(logical_owner.data(), N, dim);
  Array<Integer, Borrow<Integer, BorrowTrait>> Integer_borrowed_arr(integer_owner.data(), N, dim);
  Array<Double, Borrow<Double, BorrowTrait>> Double_borrowed_arr(double_owner.data(), N, dim);
  Array<Dual, Borrow<Dual, BorrowTrait>> Dual_borrowed_arr(dual_val_owner.data(), dual_dot_owner.data(), N, dim);

  // Unary Operation
  auto unary = sin(Double_arr);

  // BinaryOperation
  auto binary = Double_arr + Double_arr;

  // SubsetView
  auto sub = subset(Double_arr, true, true, true);

  // Unary Operation combinations
  ass<"sin logical arr">(compare_result(sin(Logical_arr), expected_sin_logical_arr));
  ass<"sin integer arr">(compare_result(sin(Integer_arr), expected_sin_integer_arr));
  ass<"sin double arr">(compare_result(sin(Double_arr), expected_sin_double_arr));
  ass<"sin dual arr">(compare_result_dual(sin(Dual_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));

  ass<"sin logical r arr">(compare_result(sin(Logical_r_arr), expected_sin_logical_arr));
  ass<"sin integer r arr">(compare_result(sin(Integer_r_arr), expected_sin_integer_arr));
  ass<"sin double r arr">(compare_result(sin(Double_r_arr), expected_sin_double_arr));
  ass<"sin dual r arr">(compare_result_dual(sin(Dual_r_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));

  ass<"sin logical borrow arr">(compare_result(sin(Logical_borrowed_arr), expected_sin_logical_arr));
  ass<"sin integer borrow arr">(compare_result(sin(Integer_borrowed_arr), expected_sin_integer_arr));
  ass<"sin double borrow arr">(compare_result(sin(Double_borrowed_arr), expected_sin_double_arr));
  ass<"sin dual borrow arr">(compare_result_dual(sin(Dual_borrowed_arr), expected_sin_double_arr, expected_sin_dual_dot_arr));

  ass<"sin of unary">(compare_result(sin(-Double_arr), expected_sin_of_unary_minus));
  ass<"sin of binary">(compare_result(sin(Double_arr + Double_arr), expected_sin_of_plus));
  ass<"sin of subset">(compare_result(sin(sub), expected_sin_double_arr));
  ass<"sin of r array (R value in the C++ sense)">(compare_result(sin(create_r_array()), expected_sin_double_arr));
  ass<"sin of const sub">(compare_result(sin(subset(create_r_array(), true, true, true)), expected_sin_double_arr));
  ass<"sin of r valeu">(compare_result(sin(create_r_array()), expected_sin_double_arr));

  std::vector<double> expected1{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * logical_etr">(compare_result(Logical_arr * logical_etr, expected1));
      
  std::vector<double> expected2{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"Integer_arr * logical_etr">(compare_result(Integer_arr * logical_etr, expected2));
      
  std::vector<double> expected3{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"Double_arr * logical_etr">(compare_result(Double_arr * logical_etr, expected3));
      
  std::vector<double> expected4{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot4{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: Dual_arr * logical_etr">(compare_result_dual(Dual_arr * logical_etr, expected4, expected_dot4));
        
  std::vector<double> expected5{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * logical_etr">(compare_result(Logical_r_arr * logical_etr, expected5));
      
  std::vector<double> expected6{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"Integer_r_arr * logical_etr">(compare_result(Integer_r_arr * logical_etr, expected6));
      
  std::vector<double> expected7{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"Double_r_arr * logical_etr">(compare_result(Double_r_arr * logical_etr, expected7));
      
  std::vector<double> expected8{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot8{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: Dual_r_arr * logical_etr">(compare_result_dual(Dual_r_arr * logical_etr, expected8, expected_dot8));
        
  std::vector<double> expected9{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * logical_etr">(compare_result(Logical_borrowed_arr * logical_etr, expected9));
      
  std::vector<double> expected10{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"Integer_borrowed_arr * logical_etr">(compare_result(Integer_borrowed_arr * logical_etr, expected10));
      
  std::vector<double> expected11{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"Double_borrowed_arr * logical_etr">(compare_result(Double_borrowed_arr * logical_etr, expected11));
      
  std::vector<double> expected12{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot12{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: Dual_borrowed_arr * logical_etr">(compare_result_dual(Dual_borrowed_arr * logical_etr, expected12, expected_dot12));
        
  std::vector<double> expected13{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"unary * logical_etr">(compare_result(unary * logical_etr, expected13));
      
  std::vector<double> expected14{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"binary * logical_etr">(compare_result(binary * logical_etr, expected14));
      
  std::vector<double> expected15{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"sub * logical_etr">(compare_result(sub * logical_etr, expected15));
      
  std::vector<double> expected16{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"subset(create_r_array(), true, true, true) * logical_etr">(compare_result(subset(create_r_array(), true, true, true) * logical_etr, expected16));
      
  std::vector<double> expected17{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"create_r_array() * logical_etr">(compare_result(create_r_array() * logical_etr, expected17));
      
  std::vector<double> expected18{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"Logical_arr * integer_etr">(compare_result(Logical_arr * integer_etr, expected18));
      
  std::vector<double> expected19{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"Integer_arr * integer_etr">(compare_result(Integer_arr * integer_etr, expected19));
      
  std::vector<double> expected20{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"Double_arr * integer_etr">(compare_result(Double_arr * integer_etr, expected20));
      
  std::vector<double> expected21{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot21{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: Dual_arr * integer_etr">(compare_result_dual(Dual_arr * integer_etr, expected21, expected_dot21));
        
  std::vector<double> expected22{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"Logical_r_arr * integer_etr">(compare_result(Logical_r_arr * integer_etr, expected22));
      
  std::vector<double> expected23{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"Integer_r_arr * integer_etr">(compare_result(Integer_r_arr * integer_etr, expected23));
      
  std::vector<double> expected24{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"Double_r_arr * integer_etr">(compare_result(Double_r_arr * integer_etr, expected24));
      
  std::vector<double> expected25{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot25{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: Dual_r_arr * integer_etr">(compare_result_dual(Dual_r_arr * integer_etr, expected25, expected_dot25));
        
  std::vector<double> expected26{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"Logical_borrowed_arr * integer_etr">(compare_result(Logical_borrowed_arr * integer_etr, expected26));
      
  std::vector<double> expected27{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"Integer_borrowed_arr * integer_etr">(compare_result(Integer_borrowed_arr * integer_etr, expected27));
      
  std::vector<double> expected28{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"Double_borrowed_arr * integer_etr">(compare_result(Double_borrowed_arr * integer_etr, expected28));
      
  std::vector<double> expected29{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot29{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: Dual_borrowed_arr * integer_etr">(compare_result_dual(Dual_borrowed_arr * integer_etr, expected29, expected_dot29));
        
  std::vector<double> expected30{10.0831750813296, 90.011943366205, 87.1841460315362, 4.19964690576234, -82.6459882175054, -93.507282915101, -18.3984129314817, 73.6258730527135, 97.9588708953537, 32.2289345972846, -63.1321355381811, -100.449811408603, -45.4143939179948, 51.3748079016097, 100.93024826354, 57.6908838356589, -38.5892131355849, -99.390565513246, -68.8126903211055, 25.0312550062789, 95.8615799184374, 78.5572103419104, -10.9722961378321, -90.4139241497879, -86.7294072636029, -3.30627331241538, 83.1566330745462, 93.1657145092317, 17.5186676798351, -74.2349614229265, -97.7373093455143, -31.3804257945316, 63.8274765136954, 100.35269127072, 44.6141044735916, -52.1424842280726, -100.959513397833, -56.9548315482765, 39.4138597661026, 99.5456301778539, 68.1556072822806, -25.8963666329348, -96.1393404930434, -77.9922480731323, 11.8605575455367, 90.8088212546028, 86.2678734885226, 2.41264068177662, -83.6607628413322, -92.8168468294954, -16.6375498894404, 74.8382336909737, 97.5080903501039, 30.5294584229464, -64.517816784457, -100.247708779387, -43.8103196385441, 52.9060753363358, 100.980868635856, 56.2143170087052};
  ass<"unary * integer_etr">(compare_result(unary * integer_etr, expected30));
      
  std::vector<double> expected31{20.2, 222.2, 424.2, 626.2, 828.2, 1030.2, 1232.2, 1434.2, 1636.2, 1838.2, 2040.2, 2242.2, 2444.2, 2646.2, 2848.2, 3050.2, 3252.2, 3454.2, 3656.2, 3858.2, 4060.2, 4262.2, 4464.2, 4666.2, 4868.2, 5070.2, 5272.2, 5474.2, 5676.2, 5878.2, 6080.2, 6282.2, 6484.2, 6686.2, 6888.2, 7090.2, 7292.2, 7494.2, 7696.2, 7898.2, 8100.2, 8302.2, 8504.2, 8706.2, 8908.2, 9110.2, 9312.2, 9514.2, 9716.2, 9918.2, 10120.2, 10322.2, 10524.2, 10726.2, 10928.2, 11130.2, 11332.2, 11534.2, 11736.2, 11938.2};
  ass<"binary * integer_etr">(compare_result(binary * integer_etr, expected31));
      
  std::vector<double> expected32{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"sub * integer_etr">(compare_result(sub * integer_etr, expected32));
      
  std::vector<double> expected33{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"subset(create_r_array(), true, true, true) * integer_etr">(compare_result(subset(create_r_array(), true, true, true) * integer_etr, expected33));
      
  std::vector<double> expected34{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"create_r_array() * integer_etr">(compare_result(create_r_array() * integer_etr, expected34));
      
  std::vector<double> expected35{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"Logical_arr * double_etr">(compare_result(Logical_arr * double_etr, expected35));
      
  std::vector<double> expected36{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"Integer_arr * double_etr">(compare_result(Integer_arr * double_etr, expected36));
      
  std::vector<double> expected37{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"Double_arr * double_etr">(compare_result(Double_arr * double_etr, expected37));
      
  std::vector<double> expected38{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot38{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: Dual_arr * double_etr">(compare_result_dual(Dual_arr * double_etr, expected38, expected_dot38));
        
  std::vector<double> expected39{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"Logical_r_arr * double_etr">(compare_result(Logical_r_arr * double_etr, expected39));
      
  std::vector<double> expected40{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"Integer_r_arr * double_etr">(compare_result(Integer_r_arr * double_etr, expected40));
      
  std::vector<double> expected41{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"Double_r_arr * double_etr">(compare_result(Double_r_arr * double_etr, expected41));
      
  std::vector<double> expected42{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot42{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: Dual_r_arr * double_etr">(compare_result_dual(Dual_r_arr * double_etr, expected42, expected_dot42));
        
  std::vector<double> expected43{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"Logical_borrowed_arr * double_etr">(compare_result(Logical_borrowed_arr * double_etr, expected43));
      
  std::vector<double> expected44{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"Integer_borrowed_arr * double_etr">(compare_result(Integer_borrowed_arr * double_etr, expected44));
      
  std::vector<double> expected45{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"Double_borrowed_arr * double_etr">(compare_result(Double_borrowed_arr * double_etr, expected45));
      
  std::vector<double> expected46{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot46{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: Dual_borrowed_arr * double_etr">(compare_result_dual(Dual_borrowed_arr * double_etr, expected46, expected_dot46));
        
  std::vector<double> expected47{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  ass<"unary * double_etr">(compare_result(unary * double_etr, expected47));
      
  std::vector<double> expected48{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  ass<"binary * double_etr">(compare_result(binary * double_etr, expected48));
      
  std::vector<double> expected49{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"sub * double_etr">(compare_result(sub * double_etr, expected49));
      
  std::vector<double> expected50{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"subset(create_r_array(), true, true, true) * double_etr">(compare_result(subset(create_r_array(), true, true, true) * double_etr, expected50));
      
  std::vector<double> expected51{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"create_r_array() * double_etr">(compare_result(create_r_array() * double_etr, expected51));
      
  std::vector<double> expected52{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot52{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * dual_etr">(compare_result_dual(Logical_arr * dual_etr, expected52, expected_dot52));
        
  std::vector<double> expected53{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot53{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * dual_etr">(compare_result_dual(Integer_arr * dual_etr, expected53, expected_dot53));
        
  std::vector<double> expected54{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot54{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * dual_etr">(compare_result_dual(Double_arr * dual_etr, expected54, expected_dot54));
        
  std::vector<double> expected55{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot55{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: Dual_arr * dual_etr">(compare_result_dual(Dual_arr * dual_etr, expected55, expected_dot55));
        
  std::vector<double> expected56{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot56{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * dual_etr">(compare_result_dual(Logical_r_arr * dual_etr, expected56, expected_dot56));
        
  std::vector<double> expected57{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot57{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * dual_etr">(compare_result_dual(Integer_r_arr * dual_etr, expected57, expected_dot57));
        
  std::vector<double> expected58{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot58{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * dual_etr">(compare_result_dual(Double_r_arr * dual_etr, expected58, expected_dot58));
        
  std::vector<double> expected59{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot59{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: Dual_r_arr * dual_etr">(compare_result_dual(Dual_r_arr * dual_etr, expected59, expected_dot59));
        
  std::vector<double> expected60{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot60{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * dual_etr">(compare_result_dual(Logical_borrowed_arr * dual_etr, expected60, expected_dot60));
        
  std::vector<double> expected61{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot61{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * dual_etr">(compare_result_dual(Integer_borrowed_arr * dual_etr, expected61, expected_dot61));
        
  std::vector<double> expected62{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot62{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * dual_etr">(compare_result_dual(Double_borrowed_arr * dual_etr, expected62, expected_dot62));
        
  std::vector<double> expected63{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot63{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: Dual_borrowed_arr * dual_etr">(compare_result_dual(Dual_borrowed_arr * dual_etr, expected63, expected_dot63));
        
  std::vector<double> expected64{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  std::vector<double> expected_dot64{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * dual_etr">(compare_result_dual(unary * dual_etr, expected64, expected_dot64));
        
  std::vector<double> expected65{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  std::vector<double> expected_dot65{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * dual_etr">(compare_result_dual(binary * dual_etr, expected65, expected_dot65));
        
  std::vector<double> expected66{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot66{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * dual_etr">(compare_result_dual(sub * dual_etr, expected66, expected_dot66));
        
  std::vector<double> expected67{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot67{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * dual_etr">(compare_result_dual(subset(create_r_array(), true, true, true) * dual_etr, expected67, expected_dot67));
        
  std::vector<double> expected68{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot68{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * dual_etr">(compare_result_dual(create_r_array() * dual_etr, expected68, expected_dot68));
        
  std::vector<double> expected69{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"logical_etr * Logical_arr">(compare_result(logical_etr * Logical_arr, expected69));
      
  std::vector<double> expected70{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"integer_etr * Logical_arr">(compare_result(integer_etr * Logical_arr, expected70));
      
  std::vector<double> expected71{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"double_etr * Logical_arr">(compare_result(double_etr * Logical_arr, expected71));
      
  std::vector<double> expected72{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot72{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: dual_etr * Logical_arr">(compare_result_dual(dual_etr * Logical_arr, expected72, expected_dot72));
        
  std::vector<double> expected73{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * Logical_arr">(compare_result(Logical_arr * Logical_arr, expected73));
      
  std::vector<double> expected74{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_arr * Logical_arr">(compare_result(Integer_arr * Logical_arr, expected74));
      
  std::vector<double> expected75{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_arr * Logical_arr">(compare_result(Double_arr * Logical_arr, expected75));
      
  std::vector<double> expected76{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot76{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_arr * Logical_arr">(compare_result_dual(Dual_arr * Logical_arr, expected76, expected_dot76));
        
  std::vector<double> expected77{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * Logical_arr">(compare_result(Logical_r_arr * Logical_arr, expected77));
      
  std::vector<double> expected78{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_r_arr * Logical_arr">(compare_result(Integer_r_arr * Logical_arr, expected78));
      
  std::vector<double> expected79{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_r_arr * Logical_arr">(compare_result(Double_r_arr * Logical_arr, expected79));
      
  std::vector<double> expected80{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot80{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_r_arr * Logical_arr">(compare_result_dual(Dual_r_arr * Logical_arr, expected80, expected_dot80));
        
  std::vector<double> expected81{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * Logical_arr">(compare_result(Logical_borrowed_arr * Logical_arr, expected81));
      
  std::vector<double> expected82{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_borrowed_arr * Logical_arr">(compare_result(Integer_borrowed_arr * Logical_arr, expected82));
      
  std::vector<double> expected83{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_borrowed_arr * Logical_arr">(compare_result(Double_borrowed_arr * Logical_arr, expected83));
      
  std::vector<double> expected84{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot84{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_borrowed_arr * Logical_arr">(compare_result_dual(Dual_borrowed_arr * Logical_arr, expected84, expected_dot84));
        
  std::vector<double> expected85{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"unary * Logical_arr">(compare_result(unary * Logical_arr, expected85));
      
  std::vector<double> expected86{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"binary * Logical_arr">(compare_result(binary * Logical_arr, expected86));
      
  std::vector<double> expected87{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"sub * Logical_arr">(compare_result(sub * Logical_arr, expected87));
      
  std::vector<double> expected88{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"subset(create_r_array(), true, true, true) * Logical_arr">(compare_result(subset(create_r_array(), true, true, true) * Logical_arr, expected88));
      
  std::vector<double> expected89{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"create_r_array() * Logical_arr">(compare_result(create_r_array() * Logical_arr, expected89));
      
  std::vector<double> expected90{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"logical_etr * Integer_arr">(compare_result(logical_etr * Integer_arr, expected90));
      
  std::vector<double> expected91{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"integer_etr * Integer_arr">(compare_result(integer_etr * Integer_arr, expected91));
      
  std::vector<double> expected92{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"double_etr * Integer_arr">(compare_result(double_etr * Integer_arr, expected92));
      
  std::vector<double> expected93{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot93{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: dual_etr * Integer_arr">(compare_result_dual(dual_etr * Integer_arr, expected93, expected_dot93));
        
  std::vector<double> expected94{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_arr * Integer_arr">(compare_result(Logical_arr * Integer_arr, expected94));
      
  std::vector<double> expected95{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_arr * Integer_arr">(compare_result(Integer_arr * Integer_arr, expected95));
      
  std::vector<double> expected96{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_arr * Integer_arr">(compare_result(Double_arr * Integer_arr, expected96));
      
  std::vector<double> expected97{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot97{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_arr * Integer_arr">(compare_result_dual(Dual_arr * Integer_arr, expected97, expected_dot97));
        
  std::vector<double> expected98{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_r_arr * Integer_arr">(compare_result(Logical_r_arr * Integer_arr, expected98));
      
  std::vector<double> expected99{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_r_arr * Integer_arr">(compare_result(Integer_r_arr * Integer_arr, expected99));
      
  std::vector<double> expected100{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_r_arr * Integer_arr">(compare_result(Double_r_arr * Integer_arr, expected100));
      
  std::vector<double> expected101{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot101{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_r_arr * Integer_arr">(compare_result_dual(Dual_r_arr * Integer_arr, expected101, expected_dot101));
        
  std::vector<double> expected102{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_borrowed_arr * Integer_arr">(compare_result(Logical_borrowed_arr * Integer_arr, expected102));
      
  std::vector<double> expected103{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_borrowed_arr * Integer_arr">(compare_result(Integer_borrowed_arr * Integer_arr, expected103));
      
  std::vector<double> expected104{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_borrowed_arr * Integer_arr">(compare_result(Double_borrowed_arr * Integer_arr, expected104));
      
  std::vector<double> expected105{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot105{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_borrowed_arr * Integer_arr">(compare_result_dual(Dual_borrowed_arr * Integer_arr, expected105, expected_dot105));
        
  std::vector<double> expected106{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"unary * Integer_arr">(compare_result(unary * Integer_arr, expected106));
      
  std::vector<double> expected107{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"binary * Integer_arr">(compare_result(binary * Integer_arr, expected107));
      
  std::vector<double> expected108{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"sub * Integer_arr">(compare_result(sub * Integer_arr, expected108));
      
  std::vector<double> expected109{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"subset(create_r_array(), true, true, true) * Integer_arr">(compare_result(subset(create_r_array(), true, true, true) * Integer_arr, expected109));
      
  std::vector<double> expected110{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"create_r_array() * Integer_arr">(compare_result(create_r_array() * Integer_arr, expected110));
      
  std::vector<double> expected111{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * Double_arr">(compare_result(logical_etr * Double_arr, expected111));
      
  std::vector<double> expected112{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * Double_arr">(compare_result(integer_etr * Double_arr, expected112));
      
  std::vector<double> expected113{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * Double_arr">(compare_result(double_etr * Double_arr, expected113));
      
  std::vector<double> expected114{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot114{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * Double_arr">(compare_result_dual(dual_etr * Double_arr, expected114, expected_dot114));
        
  std::vector<double> expected115{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * Double_arr">(compare_result(Logical_arr * Double_arr, expected115));
      
  std::vector<double> expected116{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * Double_arr">(compare_result(Integer_arr * Double_arr, expected116));
      
  std::vector<double> expected117{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * Double_arr">(compare_result(Double_arr * Double_arr, expected117));
      
  std::vector<double> expected118{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot118{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * Double_arr">(compare_result_dual(Dual_arr * Double_arr, expected118, expected_dot118));
        
  std::vector<double> expected119{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * Double_arr">(compare_result(Logical_r_arr * Double_arr, expected119));
      
  std::vector<double> expected120{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * Double_arr">(compare_result(Integer_r_arr * Double_arr, expected120));
      
  std::vector<double> expected121{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * Double_arr">(compare_result(Double_r_arr * Double_arr, expected121));
      
  std::vector<double> expected122{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot122{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * Double_arr">(compare_result_dual(Dual_r_arr * Double_arr, expected122, expected_dot122));
        
  std::vector<double> expected123{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * Double_arr">(compare_result(Logical_borrowed_arr * Double_arr, expected123));
      
  std::vector<double> expected124{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * Double_arr">(compare_result(Integer_borrowed_arr * Double_arr, expected124));
      
  std::vector<double> expected125{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * Double_arr">(compare_result(Double_borrowed_arr * Double_arr, expected125));
      
  std::vector<double> expected126{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot126{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * Double_arr">(compare_result_dual(Dual_borrowed_arr * Double_arr, expected126, expected_dot126));
        
  std::vector<double> expected127{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * Double_arr">(compare_result(unary * Double_arr, expected127));
      
  std::vector<double> expected128{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * Double_arr">(compare_result(binary * Double_arr, expected128));
      
  std::vector<double> expected129{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * Double_arr">(compare_result(sub * Double_arr, expected129));
      
  std::vector<double> expected130{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * Double_arr">(compare_result(subset(create_r_array(), true, true, true) * Double_arr, expected130));
      
  std::vector<double> expected131{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * Double_arr">(compare_result(create_r_array() * Double_arr, expected131));
      
  std::vector<double> expected132{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot132{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: logical_etr * Dual_arr">(compare_result_dual(logical_etr * Dual_arr, expected132, expected_dot132));
        
  std::vector<double> expected133{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot133{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: integer_etr * Dual_arr">(compare_result_dual(integer_etr * Dual_arr, expected133, expected_dot133));
        
  std::vector<double> expected134{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot134{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: double_etr * Dual_arr">(compare_result_dual(double_etr * Dual_arr, expected134, expected_dot134));
        
  std::vector<double> expected135{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot135{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: dual_etr * Dual_arr">(compare_result_dual(dual_etr * Dual_arr, expected135, expected_dot135));
        
  std::vector<double> expected136{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot136{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * Dual_arr">(compare_result_dual(Logical_arr * Dual_arr, expected136, expected_dot136));
        
  std::vector<double> expected137{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot137{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * Dual_arr">(compare_result_dual(Integer_arr * Dual_arr, expected137, expected_dot137));
        
  std::vector<double> expected138{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot138{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * Dual_arr">(compare_result_dual(Double_arr * Dual_arr, expected138, expected_dot138));
        
  std::vector<double> expected139{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot139{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * Dual_arr">(compare_result_dual(Dual_arr * Dual_arr, expected139, expected_dot139));
        
  std::vector<double> expected140{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot140{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * Dual_arr">(compare_result_dual(Logical_r_arr * Dual_arr, expected140, expected_dot140));
        
  std::vector<double> expected141{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot141{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * Dual_arr">(compare_result_dual(Integer_r_arr * Dual_arr, expected141, expected_dot141));
        
  std::vector<double> expected142{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot142{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * Dual_arr">(compare_result_dual(Double_r_arr * Dual_arr, expected142, expected_dot142));
        
  std::vector<double> expected143{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot143{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * Dual_arr">(compare_result_dual(Dual_r_arr * Dual_arr, expected143, expected_dot143));
        
  std::vector<double> expected144{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot144{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * Dual_arr">(compare_result_dual(Logical_borrowed_arr * Dual_arr, expected144, expected_dot144));
        
  std::vector<double> expected145{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot145{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * Dual_arr">(compare_result_dual(Integer_borrowed_arr * Dual_arr, expected145, expected_dot145));
        
  std::vector<double> expected146{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot146{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * Dual_arr">(compare_result_dual(Double_borrowed_arr * Dual_arr, expected146, expected_dot146));
        
  std::vector<double> expected147{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot147{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * Dual_arr">(compare_result_dual(Dual_borrowed_arr * Dual_arr, expected147, expected_dot147));
        
  std::vector<double> expected148{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot148{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * Dual_arr">(compare_result_dual(unary * Dual_arr, expected148, expected_dot148));
        
  std::vector<double> expected149{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot149{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * Dual_arr">(compare_result_dual(binary * Dual_arr, expected149, expected_dot149));
        
  std::vector<double> expected150{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot150{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * Dual_arr">(compare_result_dual(sub * Dual_arr, expected150, expected_dot150));
        
  std::vector<double> expected151{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot151{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * Dual_arr">(compare_result_dual(subset(create_r_array(), true, true, true) * Dual_arr, expected151, expected_dot151));
        
  std::vector<double> expected152{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot152{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * Dual_arr">(compare_result_dual(create_r_array() * Dual_arr, expected152, expected_dot152));
        
  std::vector<double> expected153{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"logical_etr * Logical_r_arr">(compare_result(logical_etr * Logical_r_arr, expected153));
      
  std::vector<double> expected154{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"integer_etr * Logical_r_arr">(compare_result(integer_etr * Logical_r_arr, expected154));
      
  std::vector<double> expected155{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"double_etr * Logical_r_arr">(compare_result(double_etr * Logical_r_arr, expected155));
      
  std::vector<double> expected156{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot156{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: dual_etr * Logical_r_arr">(compare_result_dual(dual_etr * Logical_r_arr, expected156, expected_dot156));
        
  std::vector<double> expected157{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * Logical_r_arr">(compare_result(Logical_arr * Logical_r_arr, expected157));
      
  std::vector<double> expected158{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_arr * Logical_r_arr">(compare_result(Integer_arr * Logical_r_arr, expected158));
      
  std::vector<double> expected159{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_arr * Logical_r_arr">(compare_result(Double_arr * Logical_r_arr, expected159));
      
  std::vector<double> expected160{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot160{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_arr * Logical_r_arr">(compare_result_dual(Dual_arr * Logical_r_arr, expected160, expected_dot160));
        
  std::vector<double> expected161{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * Logical_r_arr">(compare_result(Logical_r_arr * Logical_r_arr, expected161));
      
  std::vector<double> expected162{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_r_arr * Logical_r_arr">(compare_result(Integer_r_arr * Logical_r_arr, expected162));
      
  std::vector<double> expected163{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_r_arr * Logical_r_arr">(compare_result(Double_r_arr * Logical_r_arr, expected163));
      
  std::vector<double> expected164{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot164{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_r_arr * Logical_r_arr">(compare_result_dual(Dual_r_arr * Logical_r_arr, expected164, expected_dot164));
        
  std::vector<double> expected165{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * Logical_r_arr">(compare_result(Logical_borrowed_arr * Logical_r_arr, expected165));
      
  std::vector<double> expected166{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_borrowed_arr * Logical_r_arr">(compare_result(Integer_borrowed_arr * Logical_r_arr, expected166));
      
  std::vector<double> expected167{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_borrowed_arr * Logical_r_arr">(compare_result(Double_borrowed_arr * Logical_r_arr, expected167));
      
  std::vector<double> expected168{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot168{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_borrowed_arr * Logical_r_arr">(compare_result_dual(Dual_borrowed_arr * Logical_r_arr, expected168, expected_dot168));
        
  std::vector<double> expected169{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"unary * Logical_r_arr">(compare_result(unary * Logical_r_arr, expected169));
      
  std::vector<double> expected170{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"binary * Logical_r_arr">(compare_result(binary * Logical_r_arr, expected170));
      
  std::vector<double> expected171{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"sub * Logical_r_arr">(compare_result(sub * Logical_r_arr, expected171));
      
  std::vector<double> expected172{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"subset(create_r_array(), true, true, true) * Logical_r_arr">(compare_result(subset(create_r_array(), true, true, true) * Logical_r_arr, expected172));
      
  std::vector<double> expected173{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"create_r_array() * Logical_r_arr">(compare_result(create_r_array() * Logical_r_arr, expected173));
      
  std::vector<double> expected174{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"logical_etr * Integer_r_arr">(compare_result(logical_etr * Integer_r_arr, expected174));
      
  std::vector<double> expected175{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"integer_etr * Integer_r_arr">(compare_result(integer_etr * Integer_r_arr, expected175));
      
  std::vector<double> expected176{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"double_etr * Integer_r_arr">(compare_result(double_etr * Integer_r_arr, expected176));
      
  std::vector<double> expected177{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot177{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: dual_etr * Integer_r_arr">(compare_result_dual(dual_etr * Integer_r_arr, expected177, expected_dot177));
        
  std::vector<double> expected178{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_arr * Integer_r_arr">(compare_result(Logical_arr * Integer_r_arr, expected178));
      
  std::vector<double> expected179{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_arr * Integer_r_arr">(compare_result(Integer_arr * Integer_r_arr, expected179));
      
  std::vector<double> expected180{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_arr * Integer_r_arr">(compare_result(Double_arr * Integer_r_arr, expected180));
      
  std::vector<double> expected181{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot181{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_arr * Integer_r_arr">(compare_result_dual(Dual_arr * Integer_r_arr, expected181, expected_dot181));
        
  std::vector<double> expected182{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_r_arr * Integer_r_arr">(compare_result(Logical_r_arr * Integer_r_arr, expected182));
      
  std::vector<double> expected183{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_r_arr * Integer_r_arr">(compare_result(Integer_r_arr * Integer_r_arr, expected183));
      
  std::vector<double> expected184{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_r_arr * Integer_r_arr">(compare_result(Double_r_arr * Integer_r_arr, expected184));
      
  std::vector<double> expected185{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot185{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_r_arr * Integer_r_arr">(compare_result_dual(Dual_r_arr * Integer_r_arr, expected185, expected_dot185));
        
  std::vector<double> expected186{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_borrowed_arr * Integer_r_arr">(compare_result(Logical_borrowed_arr * Integer_r_arr, expected186));
      
  std::vector<double> expected187{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_borrowed_arr * Integer_r_arr">(compare_result(Integer_borrowed_arr * Integer_r_arr, expected187));
      
  std::vector<double> expected188{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_borrowed_arr * Integer_r_arr">(compare_result(Double_borrowed_arr * Integer_r_arr, expected188));
      
  std::vector<double> expected189{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot189{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_borrowed_arr * Integer_r_arr">(compare_result_dual(Dual_borrowed_arr * Integer_r_arr, expected189, expected_dot189));
        
  std::vector<double> expected190{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"unary * Integer_r_arr">(compare_result(unary * Integer_r_arr, expected190));
      
  std::vector<double> expected191{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"binary * Integer_r_arr">(compare_result(binary * Integer_r_arr, expected191));
      
  std::vector<double> expected192{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"sub * Integer_r_arr">(compare_result(sub * Integer_r_arr, expected192));
      
  std::vector<double> expected193{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"subset(create_r_array(), true, true, true) * Integer_r_arr">(compare_result(subset(create_r_array(), true, true, true) * Integer_r_arr, expected193));
      
  std::vector<double> expected194{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"create_r_array() * Integer_r_arr">(compare_result(create_r_array() * Integer_r_arr, expected194));
      
  std::vector<double> expected195{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * Double_r_arr">(compare_result(logical_etr * Double_r_arr, expected195));
      
  std::vector<double> expected196{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * Double_r_arr">(compare_result(integer_etr * Double_r_arr, expected196));
      
  std::vector<double> expected197{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * Double_r_arr">(compare_result(double_etr * Double_r_arr, expected197));
      
  std::vector<double> expected198{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot198{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * Double_r_arr">(compare_result_dual(dual_etr * Double_r_arr, expected198, expected_dot198));
        
  std::vector<double> expected199{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * Double_r_arr">(compare_result(Logical_arr * Double_r_arr, expected199));
      
  std::vector<double> expected200{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * Double_r_arr">(compare_result(Integer_arr * Double_r_arr, expected200));
      
  std::vector<double> expected201{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * Double_r_arr">(compare_result(Double_arr * Double_r_arr, expected201));
      
  std::vector<double> expected202{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot202{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * Double_r_arr">(compare_result_dual(Dual_arr * Double_r_arr, expected202, expected_dot202));
        
  std::vector<double> expected203{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * Double_r_arr">(compare_result(Logical_r_arr * Double_r_arr, expected203));
      
  std::vector<double> expected204{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * Double_r_arr">(compare_result(Integer_r_arr * Double_r_arr, expected204));
      
  std::vector<double> expected205{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * Double_r_arr">(compare_result(Double_r_arr * Double_r_arr, expected205));
      
  std::vector<double> expected206{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot206{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * Double_r_arr">(compare_result_dual(Dual_r_arr * Double_r_arr, expected206, expected_dot206));
        
  std::vector<double> expected207{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * Double_r_arr">(compare_result(Logical_borrowed_arr * Double_r_arr, expected207));
      
  std::vector<double> expected208{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * Double_r_arr">(compare_result(Integer_borrowed_arr * Double_r_arr, expected208));
      
  std::vector<double> expected209{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * Double_r_arr">(compare_result(Double_borrowed_arr * Double_r_arr, expected209));
      
  std::vector<double> expected210{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot210{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * Double_r_arr">(compare_result_dual(Dual_borrowed_arr * Double_r_arr, expected210, expected_dot210));
        
  std::vector<double> expected211{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * Double_r_arr">(compare_result(unary * Double_r_arr, expected211));
      
  std::vector<double> expected212{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * Double_r_arr">(compare_result(binary * Double_r_arr, expected212));
      
  std::vector<double> expected213{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * Double_r_arr">(compare_result(sub * Double_r_arr, expected213));
      
  std::vector<double> expected214{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * Double_r_arr">(compare_result(subset(create_r_array(), true, true, true) * Double_r_arr, expected214));
      
  std::vector<double> expected215{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * Double_r_arr">(compare_result(create_r_array() * Double_r_arr, expected215));
      
  std::vector<double> expected216{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot216{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: logical_etr * Dual_r_arr">(compare_result_dual(logical_etr * Dual_r_arr, expected216, expected_dot216));
        
  std::vector<double> expected217{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot217{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: integer_etr * Dual_r_arr">(compare_result_dual(integer_etr * Dual_r_arr, expected217, expected_dot217));
        
  std::vector<double> expected218{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot218{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: double_etr * Dual_r_arr">(compare_result_dual(double_etr * Dual_r_arr, expected218, expected_dot218));
        
  std::vector<double> expected219{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot219{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: dual_etr * Dual_r_arr">(compare_result_dual(dual_etr * Dual_r_arr, expected219, expected_dot219));
        
  std::vector<double> expected220{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot220{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * Dual_r_arr">(compare_result_dual(Logical_arr * Dual_r_arr, expected220, expected_dot220));
        
  std::vector<double> expected221{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot221{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * Dual_r_arr">(compare_result_dual(Integer_arr * Dual_r_arr, expected221, expected_dot221));
        
  std::vector<double> expected222{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot222{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * Dual_r_arr">(compare_result_dual(Double_arr * Dual_r_arr, expected222, expected_dot222));
        
  std::vector<double> expected223{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot223{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * Dual_r_arr">(compare_result_dual(Dual_arr * Dual_r_arr, expected223, expected_dot223));
        
  std::vector<double> expected224{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot224{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * Dual_r_arr">(compare_result_dual(Logical_r_arr * Dual_r_arr, expected224, expected_dot224));
        
  std::vector<double> expected225{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot225{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * Dual_r_arr">(compare_result_dual(Integer_r_arr * Dual_r_arr, expected225, expected_dot225));
        
  std::vector<double> expected226{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot226{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * Dual_r_arr">(compare_result_dual(Double_r_arr * Dual_r_arr, expected226, expected_dot226));
        
  std::vector<double> expected227{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot227{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * Dual_r_arr">(compare_result_dual(Dual_r_arr * Dual_r_arr, expected227, expected_dot227));
        
  std::vector<double> expected228{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot228{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * Dual_r_arr">(compare_result_dual(Logical_borrowed_arr * Dual_r_arr, expected228, expected_dot228));
        
  std::vector<double> expected229{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot229{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * Dual_r_arr">(compare_result_dual(Integer_borrowed_arr * Dual_r_arr, expected229, expected_dot229));
        
  std::vector<double> expected230{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot230{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * Dual_r_arr">(compare_result_dual(Double_borrowed_arr * Dual_r_arr, expected230, expected_dot230));
        
  std::vector<double> expected231{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot231{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * Dual_r_arr">(compare_result_dual(Dual_borrowed_arr * Dual_r_arr, expected231, expected_dot231));
        
  std::vector<double> expected232{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot232{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * Dual_r_arr">(compare_result_dual(unary * Dual_r_arr, expected232, expected_dot232));
        
  std::vector<double> expected233{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot233{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * Dual_r_arr">(compare_result_dual(binary * Dual_r_arr, expected233, expected_dot233));
        
  std::vector<double> expected234{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot234{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * Dual_r_arr">(compare_result_dual(sub * Dual_r_arr, expected234, expected_dot234));
        
  std::vector<double> expected235{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot235{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * Dual_r_arr">(compare_result_dual(subset(create_r_array(), true, true, true) * Dual_r_arr, expected235, expected_dot235));
        
  std::vector<double> expected236{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot236{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * Dual_r_arr">(compare_result_dual(create_r_array() * Dual_r_arr, expected236, expected_dot236));
        
  std::vector<double> expected237{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"logical_etr * Logical_borrowed_arr">(compare_result(logical_etr * Logical_borrowed_arr, expected237));
      
  std::vector<double> expected238{101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0, 101, 0, 0};
  ass<"integer_etr * Logical_borrowed_arr">(compare_result(integer_etr * Logical_borrowed_arr, expected238));
      
  std::vector<double> expected239{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  ass<"double_etr * Logical_borrowed_arr">(compare_result(double_etr * Logical_borrowed_arr, expected239));
      
  std::vector<double> expected240{3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0, 3.14, 0, 0};
  std::vector<double> expected_dot240{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: dual_etr * Logical_borrowed_arr">(compare_result_dual(dual_etr * Logical_borrowed_arr, expected240, expected_dot240));
        
  std::vector<double> expected241{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_arr * Logical_borrowed_arr">(compare_result(Logical_arr * Logical_borrowed_arr, expected241));
      
  std::vector<double> expected242{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_arr * Logical_borrowed_arr">(compare_result(Integer_arr * Logical_borrowed_arr, expected242));
      
  std::vector<double> expected243{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_arr * Logical_borrowed_arr">(compare_result(Double_arr * Logical_borrowed_arr, expected243));
      
  std::vector<double> expected244{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot244{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_arr * Logical_borrowed_arr">(compare_result_dual(Dual_arr * Logical_borrowed_arr, expected244, expected_dot244));
        
  std::vector<double> expected245{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_r_arr * Logical_borrowed_arr">(compare_result(Logical_r_arr * Logical_borrowed_arr, expected245));
      
  std::vector<double> expected246{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_r_arr * Logical_borrowed_arr">(compare_result(Integer_r_arr * Logical_borrowed_arr, expected246));
      
  std::vector<double> expected247{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_r_arr * Logical_borrowed_arr">(compare_result(Double_r_arr * Logical_borrowed_arr, expected247));
      
  std::vector<double> expected248{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot248{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_r_arr * Logical_borrowed_arr">(compare_result_dual(Dual_r_arr * Logical_borrowed_arr, expected248, expected_dot248));
        
  std::vector<double> expected249{1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0};
  ass<"Logical_borrowed_arr * Logical_borrowed_arr">(compare_result(Logical_borrowed_arr * Logical_borrowed_arr, expected249));
      
  std::vector<double> expected250{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Integer_borrowed_arr * Logical_borrowed_arr">(compare_result(Integer_borrowed_arr * Logical_borrowed_arr, expected250));
      
  std::vector<double> expected251{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Double_borrowed_arr * Logical_borrowed_arr">(compare_result(Double_borrowed_arr * Logical_borrowed_arr, expected251));
      
  std::vector<double> expected252{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot252{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Dual_borrowed_arr * Logical_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Logical_borrowed_arr, expected252, expected_dot252));
        
  std::vector<double> expected253{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"unary * Logical_borrowed_arr">(compare_result(unary * Logical_borrowed_arr, expected253));
      
  std::vector<double> expected254{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"binary * Logical_borrowed_arr">(compare_result(binary * Logical_borrowed_arr, expected254));
      
  std::vector<double> expected255{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"sub * Logical_borrowed_arr">(compare_result(sub * Logical_borrowed_arr, expected255));
      
  std::vector<double> expected256{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"subset(create_r_array(), true, true, true) * Logical_borrowed_arr">(compare_result(subset(create_r_array(), true, true, true) * Logical_borrowed_arr, expected256));
      
  std::vector<double> expected257{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"create_r_array() * Logical_borrowed_arr">(compare_result(create_r_array() * Logical_borrowed_arr, expected257));
      
  std::vector<double> expected258{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59};
  ass<"logical_etr * Integer_borrowed_arr">(compare_result(logical_etr * Integer_borrowed_arr, expected258));
      
  std::vector<double> expected259{0, 101, 202, 303, 404, 505, 606, 707, 808, 909, 1010, 1111, 1212, 1313, 1414, 1515, 1616, 1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828, 2929, 3030, 3131, 3232, 3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959};
  ass<"integer_etr * Integer_borrowed_arr">(compare_result(integer_etr * Integer_borrowed_arr, expected259));
      
  std::vector<double> expected260{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  ass<"double_etr * Integer_borrowed_arr">(compare_result(double_etr * Integer_borrowed_arr, expected260));
      
  std::vector<double> expected261{0, 3.14, 6.28, 9.42, 12.56, 15.7, 18.84, 21.98, 25.12, 28.26, 31.4, 34.54, 37.68, 40.82, 43.96, 47.1, 50.24, 53.38, 56.52, 59.66, 62.8, 65.94, 69.08, 72.22, 75.36, 78.5, 81.64, 84.78, 87.92, 91.06, 94.2, 97.34, 100.48, 103.62, 106.76, 109.9, 113.04, 116.18, 119.32, 122.46, 125.6, 128.74, 131.88, 135.02, 138.16, 141.3, 144.44, 147.58, 150.72, 153.86, 157, 160.14, 163.28, 166.42, 169.56, 172.7, 175.84, 178.98, 182.12, 185.26};
  std::vector<double> expected_dot261{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: dual_etr * Integer_borrowed_arr">(compare_result_dual(dual_etr * Integer_borrowed_arr, expected261, expected_dot261));
        
  std::vector<double> expected262{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_arr * Integer_borrowed_arr">(compare_result(Logical_arr * Integer_borrowed_arr, expected262));
      
  std::vector<double> expected263{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_arr * Integer_borrowed_arr">(compare_result(Integer_arr * Integer_borrowed_arr, expected263));
      
  std::vector<double> expected264{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_arr * Integer_borrowed_arr">(compare_result(Double_arr * Integer_borrowed_arr, expected264));
      
  std::vector<double> expected265{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot265{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_arr * Integer_borrowed_arr">(compare_result_dual(Dual_arr * Integer_borrowed_arr, expected265, expected_dot265));
        
  std::vector<double> expected266{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_r_arr * Integer_borrowed_arr">(compare_result(Logical_r_arr * Integer_borrowed_arr, expected266));
      
  std::vector<double> expected267{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_r_arr * Integer_borrowed_arr">(compare_result(Integer_r_arr * Integer_borrowed_arr, expected267));
      
  std::vector<double> expected268{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_r_arr * Integer_borrowed_arr">(compare_result(Double_r_arr * Integer_borrowed_arr, expected268));
      
  std::vector<double> expected269{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot269{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_r_arr * Integer_borrowed_arr">(compare_result_dual(Dual_r_arr * Integer_borrowed_arr, expected269, expected_dot269));
        
  std::vector<double> expected270{0, 0, 0, 3, 0, 0, 6, 0, 0, 9, 0, 0, 12, 0, 0, 15, 0, 0, 18, 0, 0, 21, 0, 0, 24, 0, 0, 27, 0, 0, 30, 0, 0, 33, 0, 0, 36, 0, 0, 39, 0, 0, 42, 0, 0, 45, 0, 0, 48, 0, 0, 51, 0, 0, 54, 0, 0, 57, 0, 0};
  ass<"Logical_borrowed_arr * Integer_borrowed_arr">(compare_result(Logical_borrowed_arr * Integer_borrowed_arr, expected270));
      
  std::vector<double> expected271{0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481};
  ass<"Integer_borrowed_arr * Integer_borrowed_arr">(compare_result(Integer_borrowed_arr * Integer_borrowed_arr, expected271));
      
  std::vector<double> expected272{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Double_borrowed_arr * Integer_borrowed_arr">(compare_result(Double_borrowed_arr * Integer_borrowed_arr, expected272));
      
  std::vector<double> expected273{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot273{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Dual_borrowed_arr * Integer_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Integer_borrowed_arr, expected273, expected_dot273));
        
  std::vector<double> expected274{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"unary * Integer_borrowed_arr">(compare_result(unary * Integer_borrowed_arr, expected274));
      
  std::vector<double> expected275{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"binary * Integer_borrowed_arr">(compare_result(binary * Integer_borrowed_arr, expected275));
      
  std::vector<double> expected276{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"sub * Integer_borrowed_arr">(compare_result(sub * Integer_borrowed_arr, expected276));
      
  std::vector<double> expected277{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"subset(create_r_array(), true, true, true) * Integer_borrowed_arr">(compare_result(subset(create_r_array(), true, true, true) * Integer_borrowed_arr, expected277));
      
  std::vector<double> expected278{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"create_r_array() * Integer_borrowed_arr">(compare_result(create_r_array() * Integer_borrowed_arr, expected278));
      
  std::vector<double> expected279{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * Double_borrowed_arr">(compare_result(logical_etr * Double_borrowed_arr, expected279));
      
  std::vector<double> expected280{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * Double_borrowed_arr">(compare_result(integer_etr * Double_borrowed_arr, expected280));
      
  std::vector<double> expected281{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * Double_borrowed_arr">(compare_result(double_etr * Double_borrowed_arr, expected281));
      
  std::vector<double> expected282{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot282{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * Double_borrowed_arr">(compare_result_dual(dual_etr * Double_borrowed_arr, expected282, expected_dot282));
        
  std::vector<double> expected283{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * Double_borrowed_arr">(compare_result(Logical_arr * Double_borrowed_arr, expected283));
      
  std::vector<double> expected284{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * Double_borrowed_arr">(compare_result(Integer_arr * Double_borrowed_arr, expected284));
      
  std::vector<double> expected285{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * Double_borrowed_arr">(compare_result(Double_arr * Double_borrowed_arr, expected285));
      
  std::vector<double> expected286{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot286{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * Double_borrowed_arr">(compare_result_dual(Dual_arr * Double_borrowed_arr, expected286, expected_dot286));
        
  std::vector<double> expected287{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * Double_borrowed_arr">(compare_result(Logical_r_arr * Double_borrowed_arr, expected287));
      
  std::vector<double> expected288{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * Double_borrowed_arr">(compare_result(Integer_r_arr * Double_borrowed_arr, expected288));
      
  std::vector<double> expected289{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * Double_borrowed_arr">(compare_result(Double_r_arr * Double_borrowed_arr, expected289));
      
  std::vector<double> expected290{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot290{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * Double_borrowed_arr">(compare_result_dual(Dual_r_arr * Double_borrowed_arr, expected290, expected_dot290));
        
  std::vector<double> expected291{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * Double_borrowed_arr">(compare_result(Logical_borrowed_arr * Double_borrowed_arr, expected291));
      
  std::vector<double> expected292{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * Double_borrowed_arr">(compare_result(Integer_borrowed_arr * Double_borrowed_arr, expected292));
      
  std::vector<double> expected293{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * Double_borrowed_arr">(compare_result(Double_borrowed_arr * Double_borrowed_arr, expected293));
      
  std::vector<double> expected294{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot294{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * Double_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Double_borrowed_arr, expected294, expected_dot294));
        
  std::vector<double> expected295{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * Double_borrowed_arr">(compare_result(unary * Double_borrowed_arr, expected295));
      
  std::vector<double> expected296{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * Double_borrowed_arr">(compare_result(binary * Double_borrowed_arr, expected296));
      
  std::vector<double> expected297{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * Double_borrowed_arr">(compare_result(sub * Double_borrowed_arr, expected297));
      
  std::vector<double> expected298{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * Double_borrowed_arr">(compare_result(subset(create_r_array(), true, true, true) * Double_borrowed_arr, expected298));
      
  std::vector<double> expected299{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * Double_borrowed_arr">(compare_result(create_r_array() * Double_borrowed_arr, expected299));
      
  std::vector<double> expected300{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  std::vector<double> expected_dot300{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
  ass<"deriv of: logical_etr * Dual_borrowed_arr">(compare_result_dual(logical_etr * Dual_borrowed_arr, expected300, expected_dot300));
        
  std::vector<double> expected301{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  std::vector<double> expected_dot301{202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202, 202};
  ass<"deriv of: integer_etr * Dual_borrowed_arr">(compare_result_dual(integer_etr * Dual_borrowed_arr, expected301, expected_dot301));
        
  std::vector<double> expected302{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot302{6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28, 6.28};
  ass<"deriv of: double_etr * Dual_borrowed_arr">(compare_result_dual(double_etr * Dual_borrowed_arr, expected302, expected_dot302));
        
  std::vector<double> expected303{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot303{6.48, 8.48, 10.48, 12.48, 14.48, 16.48, 18.48, 20.48, 22.48, 24.48, 26.48, 28.48, 30.48, 32.48, 34.48, 36.48, 38.48, 40.48, 42.48, 44.48, 46.48, 48.48, 50.48, 52.48, 54.48, 56.48, 58.48, 60.48, 62.48, 64.48, 66.48, 68.48, 70.48, 72.48, 74.48, 76.48, 78.48, 80.48, 82.48, 84.48, 86.48, 88.48, 90.48, 92.48, 94.48, 96.48, 98.48, 100.48, 102.48, 104.48, 106.48, 108.48, 110.48, 112.48, 114.48, 116.48, 118.48, 120.48, 122.48, 124.48};
  ass<"deriv of: dual_etr * Dual_borrowed_arr">(compare_result_dual(dual_etr * Dual_borrowed_arr, expected303, expected_dot303));
        
  std::vector<double> expected304{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot304{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_arr * Dual_borrowed_arr">(compare_result_dual(Logical_arr * Dual_borrowed_arr, expected304, expected_dot304));
        
  std::vector<double> expected305{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot305{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_arr * Dual_borrowed_arr">(compare_result_dual(Integer_arr * Dual_borrowed_arr, expected305, expected_dot305));
        
  std::vector<double> expected306{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot306{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_arr * Dual_borrowed_arr">(compare_result_dual(Double_arr * Dual_borrowed_arr, expected306, expected_dot306));
        
  std::vector<double> expected307{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot307{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * Dual_borrowed_arr">(compare_result_dual(Dual_arr * Dual_borrowed_arr, expected307, expected_dot307));
        
  std::vector<double> expected308{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot308{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_r_arr * Dual_borrowed_arr">(compare_result_dual(Logical_r_arr * Dual_borrowed_arr, expected308, expected_dot308));
        
  std::vector<double> expected309{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot309{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_r_arr * Dual_borrowed_arr">(compare_result_dual(Integer_r_arr * Dual_borrowed_arr, expected309, expected_dot309));
        
  std::vector<double> expected310{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot310{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_r_arr * Dual_borrowed_arr">(compare_result_dual(Double_r_arr * Dual_borrowed_arr, expected310, expected_dot310));
        
  std::vector<double> expected311{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot311{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * Dual_borrowed_arr">(compare_result_dual(Dual_r_arr * Dual_borrowed_arr, expected311, expected_dot311));
        
  std::vector<double> expected312{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  std::vector<double> expected_dot312{2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0};
  ass<"deriv of: Logical_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Logical_borrowed_arr * Dual_borrowed_arr, expected312, expected_dot312));
        
  std::vector<double> expected313{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  std::vector<double> expected_dot313{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118};
  ass<"deriv of: Integer_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Integer_borrowed_arr * Dual_borrowed_arr, expected313, expected_dot313));
        
  std::vector<double> expected314{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot314{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Double_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Double_borrowed_arr * Dual_borrowed_arr, expected314, expected_dot314));
        
  std::vector<double> expected315{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot315{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * Dual_borrowed_arr">(compare_result_dual(Dual_borrowed_arr * Dual_borrowed_arr, expected315, expected_dot315));
        
  std::vector<double> expected316{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot316{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: unary * Dual_borrowed_arr">(compare_result_dual(unary * Dual_borrowed_arr, expected316, expected_dot316));
        
  std::vector<double> expected317{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot317{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: binary * Dual_borrowed_arr">(compare_result_dual(binary * Dual_borrowed_arr, expected317, expected_dot317));
        
  std::vector<double> expected318{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot318{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: sub * Dual_borrowed_arr">(compare_result_dual(sub * Dual_borrowed_arr, expected318, expected_dot318));
        
  std::vector<double> expected319{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot319{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: subset(create_r_array(), true, true, true) * Dual_borrowed_arr">(compare_result_dual(subset(create_r_array(), true, true, true) * Dual_borrowed_arr, expected319, expected_dot319));
        
  std::vector<double> expected320{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot320{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: create_r_array() * Dual_borrowed_arr">(compare_result_dual(create_r_array() * Dual_borrowed_arr, expected320, expected_dot320));
        
  std::vector<double> expected321{0.0998334166468282, 0.891207360061435, 0.863209366648874, 0.0415806624332905, -0.81827711106441, -0.925814682327732, -0.182162504272096, 0.728969040125876, 0.969889810845086, 0.319098362349352, -0.625070648892882, -0.994552588203989, -0.449647464534601, 0.508661464372374, 0.999309388747918, 0.571196869659989, -0.382071417184009, -0.984065005081643, -0.6813137655555, 0.24783420798296, 0.949124553647895, 0.777794161801093, -0.10863659542408, -0.895187367819682, -0.858707002609929, -0.0327353793308453, 0.823333000738082, 0.922432816923086, 0.173452155245892, -0.734999618048778, -0.967696132133805, -0.310697285094372, 0.631955213006885, 0.993591002680395, 0.441723806669224, -0.516262220079927, -0.999599142552803, -0.563909223250262, 0.390236235307946, 0.985600298790633, 0.674807992893867, -0.256399669633018, -0.951874658346965, -0.772200475971607, 0.117431262827096, 0.899097240144582, 0.854137361272501, 0.0238875315027389, -0.828324384567645, -0.918978681480152, -0.164728216727132, 0.74097261080172, 0.965426637129742, 0.302271865573727, -0.638790265192644, -0.992551572073139, -0.433765540975684, 0.523822528082532, 0.999810580553025, 0.556577396125794};
  ass<"logical_etr * unary">(compare_result(logical_etr * unary, expected321));
      
  std::vector<double> expected322{10.0831750813296, 90.011943366205, 87.1841460315362, 4.19964690576234, -82.6459882175054, -93.507282915101, -18.3984129314817, 73.6258730527135, 97.9588708953537, 32.2289345972846, -63.1321355381811, -100.449811408603, -45.4143939179948, 51.3748079016097, 100.93024826354, 57.6908838356589, -38.5892131355849, -99.390565513246, -68.8126903211055, 25.0312550062789, 95.8615799184374, 78.5572103419104, -10.9722961378321, -90.4139241497879, -86.7294072636029, -3.30627331241538, 83.1566330745462, 93.1657145092317, 17.5186676798351, -74.2349614229265, -97.7373093455143, -31.3804257945316, 63.8274765136954, 100.35269127072, 44.6141044735916, -52.1424842280726, -100.959513397833, -56.9548315482765, 39.4138597661026, 99.5456301778539, 68.1556072822806, -25.8963666329348, -96.1393404930434, -77.9922480731323, 11.8605575455367, 90.8088212546028, 86.2678734885226, 2.41264068177662, -83.6607628413322, -92.8168468294954, -16.6375498894404, 74.8382336909737, 97.5080903501039, 30.5294584229464, -64.517816784457, -100.247708779387, -43.8103196385441, 52.9060753363358, 100.980868635856, 56.2143170087052};
  ass<"integer_etr * unary">(compare_result(integer_etr * unary, expected322));
      
  std::vector<double> expected323{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  ass<"double_etr * unary">(compare_result(double_etr * unary, expected323));
      
  std::vector<double> expected324{0.31347692827104, 2.79839111059291, 2.71047741127746, 0.130563280040532, -2.56939012874225, -2.90705810250908, -0.571990263414381, 2.28896278599525, 3.04545400605357, 1.00196885777697, -1.96272183752365, -3.12289512696053, -1.41189303863865, 1.59719699812925, 3.13783148066846, 1.79355817073236, -1.19970424995779, -3.08996411595636, -2.13932522384427, 0.778199413066494, 2.98025109845439, 2.44227366805543, -0.34111890963161, -2.8108883349538, -2.69633998819518, -0.102789091098854, 2.58526562231758, 2.89643904513849, 0.544639767472101, -2.30789880067316, -3.03856585490015, -0.975589475196329, 1.98433936884162, 3.11987574841644, 1.38701275294136, -1.62106337105097, -3.1387413076158, -1.77067496100582, 1.22534177886695, 3.09478493820259, 2.11889709768674, -0.805094962647677, -2.98888642720947, -2.42470949455085, 0.368734165277081, 2.82316533405399, 2.68199131439565, 0.0750068489186, -2.60093856754241, -2.88559305984768, -0.517246600523195, 2.3266539979174, 3.03143964058739, 0.949133657901502, -2.0058014327049, -3.11661193630966, -1.36202379866365, 1.64480273817915, 3.1394052229365, 1.74765302383499};
  std::vector<double> expected_dot324{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: dual_etr * unary">(compare_result_dual(dual_etr * unary, expected324, expected_dot324));
        
  std::vector<double> expected325{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"Logical_arr * unary">(compare_result(Logical_arr * unary, expected325));
      
  std::vector<double> expected326{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"Integer_arr * unary">(compare_result(Integer_arr * unary, expected326));
      
  std::vector<double> expected327{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"Double_arr * unary">(compare_result(Double_arr * unary, expected327));
      
  std::vector<double> expected328{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot328{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: Dual_arr * unary">(compare_result_dual(Dual_arr * unary, expected328, expected_dot328));
        
  std::vector<double> expected329{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"Logical_r_arr * unary">(compare_result(Logical_r_arr * unary, expected329));
      
  std::vector<double> expected330{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"Integer_r_arr * unary">(compare_result(Integer_r_arr * unary, expected330));
      
  std::vector<double> expected331{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"Double_r_arr * unary">(compare_result(Double_r_arr * unary, expected331));
      
  std::vector<double> expected332{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot332{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: Dual_r_arr * unary">(compare_result_dual(Dual_r_arr * unary, expected332, expected_dot332));
        
  std::vector<double> expected333{0.0998334166468282, 0, 0, 0.0415806624332905, 0, 0, -0.182162504272096, 0, 0, 0.319098362349352, 0, 0, -0.449647464534601, 0, 0, 0.571196869659989, 0, 0, -0.6813137655555, 0, 0, 0.777794161801093, 0, 0, -0.858707002609929, 0, 0, 0.922432816923086, 0, 0, -0.967696132133805, 0, 0, 0.993591002680395, 0, 0, -0.999599142552803, 0, 0, 0.985600298790633, 0, 0, -0.951874658346965, 0, 0, 0.899097240144582, 0, 0, -0.828324384567645, 0, 0, 0.74097261080172, 0, 0, -0.638790265192644, 0, 0, 0.523822528082532, 0, 0};
  ass<"Logical_borrowed_arr * unary">(compare_result(Logical_borrowed_arr * unary, expected333));
      
  std::vector<double> expected334{0, 0.891207360061435, 1.72641873329775, 0.124741987299871, -3.27310844425764, -4.62907341163866, -1.09297502563258, 5.10278328088113, 7.75911848676069, 2.87188526114417, -6.25070648892882, -10.9400784702439, -5.39576957441522, 6.61259903684086, 13.9903314424708, 8.56795304489983, -6.11314267494415, -16.7291050863879, -12.263647779999, 4.70884995167624, 18.9824910729579, 16.3336773978229, -2.39000509932975, -20.5893094598527, -20.6089680626383, -0.818384483271133, 21.4066580191901, 24.9056860569233, 4.85666034688498, -21.3149889234146, -29.0308839640142, -9.63161583792554, 20.2225668162203, 32.788503088453, 15.0186094267536, -18.0691777027974, -35.9855691319009, -20.8646412602597, 14.828976941702, 38.4384116528347, 26.9923197157547, -10.5123864549537, -39.9787356505725, -33.2046204667791, 5.16697556439221, 40.4593758065062, 39.290318618535, 1.12271398062873, -39.759570459247, -45.0299553925274, -8.23641083635661, 37.7896031508877, 50.2021851307466, 16.0204088754075, -34.4946743204028, -54.5903364640226, -24.2908702946383, 29.8578841007043, 57.9890136720755, 32.8380663714218};
  ass<"Integer_borrowed_arr * unary">(compare_result(Integer_borrowed_arr * unary, expected334));
      
  std::vector<double> expected335{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"Double_borrowed_arr * unary">(compare_result(Double_borrowed_arr * unary, expected335));
      
  std::vector<double> expected336{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  std::vector<double> expected_dot336{0.199666833293656, 1.78241472012287, 1.72641873329775, 0.083161324866581, -1.63655422212882, -1.85162936465546, -0.364325008544192, 1.45793808025175, 1.93977962169017, 0.638196724698704, -1.25014129778576, -1.98910517640798, -0.899294929069203, 1.01732292874475, 1.99861877749584, 1.14239373931998, -0.764142834368018, -1.96813001016329, -1.362627531111, 0.49566841596592, 1.89824910729579, 1.55558832360219, -0.21727319084816, -1.79037473563936, -1.71741400521986, -0.0654707586616906, 1.64666600147616, 1.84486563384617, 0.346904310491784, -1.46999923609756, -1.93539226426761, -0.621394570188744, 1.26391042601377, 1.98718200536079, 0.883447613338448, -1.03252444015985, -1.99919828510561, -1.12781844650052, 0.780472470615892, 1.97120059758127, 1.34961598578773, -0.512799339266036, -1.90374931669393, -1.54440095194321, 0.234862525654191, 1.79819448028916, 1.708274722545, 0.0477750630054777, -1.65664876913529, -1.8379573629603, -0.329456433454264, 1.48194522160344, 1.93085327425948, 0.604543731147454, -1.27758053038529, -1.98510314414628, -0.867531081951368, 1.04764505616506, 1.99962116110605, 1.11315479225159};
  ass<"deriv of: Dual_borrowed_arr * unary">(compare_result_dual(Dual_borrowed_arr * unary, expected336, expected_dot336));
        
  std::vector<double> expected337{0.00996671107937919, 0.794250558627673, 0.74513041067035, 0.00172895148839126, 0.669577430491917, 0.8571328260136, 0.0331831779626813, 0.531395861462041, 0.940686245181117, 0.101823764854038, 0.390713316107369, 0.989134850703254, 0.202182842362396, 0.258736485337448, 0.998619254439737, 0.32626586390937, 0.145978567828997, 0.968383934226335, 0.464188447135415, 0.061421794646541, 0.900837418337315, 0.604963758131865, 0.0118019098653352, 0.80136042350393, 0.737377716331329, 0.00107160505993433, 0.677877230104374, 0.850882301736659, 0.0300856501594451, 0.540224438531849, 0.936435804146727, 0.0965328029650136, 0.399367391246577, 0.987223080607432, 0.19511992137835, 0.266526679881855, 0.999198445792299, 0.317993612066714, 0.152284319347319, 0.971407948976185, 0.455365827273449, 0.0657407905879208, 0.906065365203151, 0.596293575090777, 0.0137901014891664, 0.808375847235604, 0.72955063192155, 0.000570614161294341, 0.686121286069369, 0.844521817014999, 0.027135385386101, 0.549040409958317, 0.932048591679642, 0.0913682807174212, 0.408053002904888, 0.985158623224859, 0.188152544537928, 0.274390040926775, 0.999621196985777, 0.309778397878169};
  ass<"unary * unary">(compare_result(unary * unary, expected337));
      
  std::vector<double> expected338{0.0199666833293656, 1.96065619213516, 3.62547933992527, 0.257800107086401, -6.70987231072816, -9.44330975974287, -2.22238255211957, 10.3513603697874, 15.7122149356904, 5.80759019475821, -12.6264271076362, -22.0790674581286, -10.8814686417374, 13.3269303665562, 28.1805247626913, 17.2501454637317, -12.3026996333251, -33.6550231737922, -24.6635583131091, 9.46726674494907, 38.1548070566454, 32.8229136280061, -4.80173751774433, -41.3576563932693, -41.3896775257986, -1.64331604240843, 42.9779826385279, 49.9958586772313, 9.74801112481914, -42.7769777704389, -58.2553071544551, -19.32537113287, 40.571524675042, 65.7757243774421, 30.1255636148411, -36.2416078496109, -72.1710580923124, -41.8420643651695, 29.7360011304655, 77.0739433654275, 54.1196010300881, -21.0760528438341, -80.1478462328144, -66.5636810287525, 10.3574373813498, 81.0985710610413, 78.7514647093246, 2.250205467558, -79.6848057954075, -90.2437065213509, -16.5057673160586, 75.7274008239358, 100.597455588919, 32.1012721239298, -69.1171066938441, -109.37918324246, -48.6684936974718, 59.8205327070252, 116.177989460262, 65.7874482220688};
  ass<"binary * unary">(compare_result(binary * unary, expected338));
      
  std::vector<double> expected339{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"sub * unary">(compare_result(sub * unary, expected339));
      
  std::vector<double> expected340{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"subset(create_r_array(), true, true, true) * unary">(compare_result(subset(create_r_array(), true, true, true) * unary, expected340));
      
  std::vector<double> expected341{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"create_r_array() * unary">(compare_result(create_r_array() * unary, expected341));
      
  std::vector<double> expected342{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"logical_etr * binary">(compare_result(logical_etr * binary, expected342));
      
  std::vector<double> expected343{20.2, 222.2, 424.2, 626.2, 828.2, 1030.2, 1232.2, 1434.2, 1636.2, 1838.2, 2040.2, 2242.2, 2444.2, 2646.2, 2848.2, 3050.2, 3252.2, 3454.2, 3656.2, 3858.2, 4060.2, 4262.2, 4464.2, 4666.2, 4868.2, 5070.2, 5272.2, 5474.2, 5676.2, 5878.2, 6080.2, 6282.2, 6484.2, 6686.2, 6888.2, 7090.2, 7292.2, 7494.2, 7696.2, 7898.2, 8100.2, 8302.2, 8504.2, 8706.2, 8908.2, 9110.2, 9312.2, 9514.2, 9716.2, 9918.2, 10120.2, 10322.2, 10524.2, 10726.2, 10928.2, 11130.2, 11332.2, 11534.2, 11736.2, 11938.2};
  ass<"integer_etr * binary">(compare_result(integer_etr * binary, expected343));
      
  std::vector<double> expected344{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  ass<"double_etr * binary">(compare_result(double_etr * binary, expected344));
      
  std::vector<double> expected345{0.628, 6.908, 13.188, 19.468, 25.748, 32.028, 38.308, 44.588, 50.868, 57.148, 63.428, 69.708, 75.988, 82.268, 88.548, 94.828, 101.108, 107.388, 113.668, 119.948, 126.228, 132.508, 138.788, 145.068, 151.348, 157.628, 163.908, 170.188, 176.468, 182.748, 189.028, 195.308, 201.588, 207.868, 214.148, 220.428, 226.708, 232.988, 239.268, 245.548, 251.828, 258.108, 264.388, 270.668, 276.948, 283.228, 289.508, 295.788, 302.068, 308.348, 314.628, 320.908, 327.188, 333.468, 339.748, 346.028, 352.308, 358.588, 364.868, 371.148};
  std::vector<double> expected_dot345{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: dual_etr * binary">(compare_result_dual(dual_etr * binary, expected345, expected_dot345));
        
  std::vector<double> expected346{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"Logical_arr * binary">(compare_result(Logical_arr * binary, expected346));
      
  std::vector<double> expected347{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"Integer_arr * binary">(compare_result(Integer_arr * binary, expected347));
      
  std::vector<double> expected348{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"Double_arr * binary">(compare_result(Double_arr * binary, expected348));
      
  std::vector<double> expected349{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot349{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_arr * binary">(compare_result_dual(Dual_arr * binary, expected349, expected_dot349));
        
  std::vector<double> expected350{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"Logical_r_arr * binary">(compare_result(Logical_r_arr * binary, expected350));
      
  std::vector<double> expected351{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"Integer_r_arr * binary">(compare_result(Integer_r_arr * binary, expected351));
      
  std::vector<double> expected352{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"Double_r_arr * binary">(compare_result(Double_r_arr * binary, expected352));
      
  std::vector<double> expected353{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot353{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_r_arr * binary">(compare_result_dual(Dual_r_arr * binary, expected353, expected_dot353));
        
  std::vector<double> expected354{0.2, 0, 0, 6.2, 0, 0, 12.2, 0, 0, 18.2, 0, 0, 24.2, 0, 0, 30.2, 0, 0, 36.2, 0, 0, 42.2, 0, 0, 48.2, 0, 0, 54.2, 0, 0, 60.2, 0, 0, 66.2, 0, 0, 72.2, 0, 0, 78.2, 0, 0, 84.2, 0, 0, 90.2, 0, 0, 96.2, 0, 0, 102.2, 0, 0, 108.2, 0, 0, 114.2, 0, 0};
  ass<"Logical_borrowed_arr * binary">(compare_result(Logical_borrowed_arr * binary, expected354));
      
  std::vector<double> expected355{0, 2.2, 8.4, 18.6, 32.8, 51, 73.2, 99.4, 129.6, 163.8, 202, 244.2, 290.4, 340.6, 394.8, 453, 515.2, 581.4, 651.6, 725.8, 804, 886.2, 972.4, 1062.6, 1156.8, 1255, 1357.2, 1463.4, 1573.6, 1687.8, 1806, 1928.2, 2054.4, 2184.6, 2318.8, 2457, 2599.2, 2745.4, 2895.6, 3049.8, 3208, 3370.2, 3536.4, 3706.6, 3880.8, 4059, 4241.2, 4427.4, 4617.6, 4811.8, 5010, 5212.2, 5418.4, 5628.6, 5842.8, 6061, 6283.2, 6509.4, 6739.6, 6973.8};
  ass<"Integer_borrowed_arr * binary">(compare_result(Integer_borrowed_arr * binary, expected355));
      
  std::vector<double> expected356{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"Double_borrowed_arr * binary">(compare_result(Double_borrowed_arr * binary, expected356));
      
  std::vector<double> expected357{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  std::vector<double> expected_dot357{0.4, 4.4, 8.4, 12.4, 16.4, 20.4, 24.4, 28.4, 32.4, 36.4, 40.4, 44.4, 48.4, 52.4, 56.4, 60.4, 64.4, 68.4, 72.4, 76.4, 80.4, 84.4, 88.4, 92.4, 96.4, 100.4, 104.4, 108.4, 112.4, 116.4, 120.4, 124.4, 128.4, 132.4, 136.4, 140.4, 144.4, 148.4, 152.4, 156.4, 160.4, 164.4, 168.4, 172.4, 176.4, 180.4, 184.4, 188.4, 192.4, 196.4, 200.4, 204.4, 208.4, 212.4, 216.4, 220.4, 224.4, 228.4, 232.4, 236.4};
  ass<"deriv of: Dual_borrowed_arr * binary">(compare_result_dual(Dual_borrowed_arr * binary, expected357, expected_dot357));
        
  std::vector<double> expected358{0.0199666833293656, 1.96065619213516, 3.62547933992527, 0.257800107086401, -6.70987231072816, -9.44330975974287, -2.22238255211957, 10.3513603697874, 15.7122149356904, 5.80759019475821, -12.6264271076362, -22.0790674581286, -10.8814686417374, 13.3269303665562, 28.1805247626913, 17.2501454637317, -12.3026996333251, -33.6550231737922, -24.6635583131091, 9.46726674494907, 38.1548070566454, 32.8229136280061, -4.80173751774433, -41.3576563932693, -41.3896775257986, -1.64331604240843, 42.9779826385279, 49.9958586772313, 9.74801112481914, -42.7769777704389, -58.2553071544551, -19.32537113287, 40.571524675042, 65.7757243774421, 30.1255636148411, -36.2416078496109, -72.1710580923124, -41.8420643651695, 29.7360011304655, 77.0739433654275, 54.1196010300881, -21.0760528438341, -80.1478462328144, -66.5636810287525, 10.3574373813498, 81.0985710610413, 78.7514647093246, 2.250205467558, -79.6848057954075, -90.2437065213509, -16.5057673160586, 75.7274008239358, 100.597455588919, 32.1012721239298, -69.1171066938441, -109.37918324246, -48.6684936974718, 59.8205327070252, 116.177989460262, 65.7874482220688};
  ass<"unary * binary">(compare_result(unary * binary, expected358));
      
  std::vector<double> expected359{0.04, 4.84, 17.64, 38.44, 67.24, 104.04, 148.84, 201.64, 262.44, 331.24, 408.04, 492.84, 585.64, 686.44, 795.24, 912.04, 1036.84, 1169.64, 1310.44, 1459.24, 1616.04, 1780.84, 1953.64, 2134.44, 2323.24, 2520.04, 2724.84, 2937.64, 3158.44, 3387.24, 3624.04, 3868.84, 4121.64, 4382.44, 4651.24, 4928.04, 5212.84, 5505.64, 5806.44, 6115.24, 6432.04, 6756.84, 7089.64, 7430.44, 7779.24, 8136.04, 8500.84, 8873.64, 9254.44, 9643.24, 10040.04, 10444.84, 10857.64, 11278.44, 11707.24, 12144.04, 12588.84, 13041.64, 13502.44, 13971.24};
  ass<"binary * binary">(compare_result(binary * binary, expected359));
      
  std::vector<double> expected360{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"sub * binary">(compare_result(sub * binary, expected360));
      
  std::vector<double> expected361{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"subset(create_r_array(), true, true, true) * binary">(compare_result(subset(create_r_array(), true, true, true) * binary, expected361));
      
  std::vector<double> expected362{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"create_r_array() * binary">(compare_result(create_r_array() * binary, expected362));
      
  std::vector<double> expected363{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * sub">(compare_result(logical_etr * sub, expected363));
      
  std::vector<double> expected364{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * sub">(compare_result(integer_etr * sub, expected364));
      
  std::vector<double> expected365{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * sub">(compare_result(double_etr * sub, expected365));
      
  std::vector<double> expected366{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot366{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * sub">(compare_result_dual(dual_etr * sub, expected366, expected_dot366));
        
  std::vector<double> expected367{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * sub">(compare_result(Logical_arr * sub, expected367));
      
  std::vector<double> expected368{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * sub">(compare_result(Integer_arr * sub, expected368));
      
  std::vector<double> expected369{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * sub">(compare_result(Double_arr * sub, expected369));
      
  std::vector<double> expected370{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot370{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * sub">(compare_result_dual(Dual_arr * sub, expected370, expected_dot370));
        
  std::vector<double> expected371{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * sub">(compare_result(Logical_r_arr * sub, expected371));
      
  std::vector<double> expected372{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * sub">(compare_result(Integer_r_arr * sub, expected372));
      
  std::vector<double> expected373{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * sub">(compare_result(Double_r_arr * sub, expected373));
      
  std::vector<double> expected374{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot374{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * sub">(compare_result_dual(Dual_r_arr * sub, expected374, expected_dot374));
        
  std::vector<double> expected375{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * sub">(compare_result(Logical_borrowed_arr * sub, expected375));
      
  std::vector<double> expected376{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * sub">(compare_result(Integer_borrowed_arr * sub, expected376));
      
  std::vector<double> expected377{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * sub">(compare_result(Double_borrowed_arr * sub, expected377));
      
  std::vector<double> expected378{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot378{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * sub">(compare_result_dual(Dual_borrowed_arr * sub, expected378, expected_dot378));
        
  std::vector<double> expected379{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * sub">(compare_result(unary * sub, expected379));
      
  std::vector<double> expected380{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * sub">(compare_result(binary * sub, expected380));
      
  std::vector<double> expected381{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * sub">(compare_result(sub * sub, expected381));
      
  std::vector<double> expected382{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * sub">(compare_result(subset(create_r_array(), true, true, true) * sub, expected382));
      
  std::vector<double> expected383{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * sub">(compare_result(create_r_array() * sub, expected383));
      
  std::vector<double> expected384{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * subset(create_r_array(), true, true, true)">(compare_result(logical_etr * subset(create_r_array(), true, true, true), expected384));
      
  std::vector<double> expected385{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * subset(create_r_array(), true, true, true)">(compare_result(integer_etr * subset(create_r_array(), true, true, true), expected385));
      
  std::vector<double> expected386{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * subset(create_r_array(), true, true, true)">(compare_result(double_etr * subset(create_r_array(), true, true, true), expected386));
      
  std::vector<double> expected387{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot387{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * subset(create_r_array(), true, true, true)">(compare_result_dual(dual_etr * subset(create_r_array(), true, true, true), expected387, expected_dot387));
        
  std::vector<double> expected388{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * subset(create_r_array(), true, true, true)">(compare_result(Logical_arr * subset(create_r_array(), true, true, true), expected388));
      
  std::vector<double> expected389{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * subset(create_r_array(), true, true, true)">(compare_result(Integer_arr * subset(create_r_array(), true, true, true), expected389));
      
  std::vector<double> expected390{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * subset(create_r_array(), true, true, true)">(compare_result(Double_arr * subset(create_r_array(), true, true, true), expected390));
      
  std::vector<double> expected391{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot391{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * subset(create_r_array(), true, true, true)">(compare_result_dual(Dual_arr * subset(create_r_array(), true, true, true), expected391, expected_dot391));
        
  std::vector<double> expected392{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * subset(create_r_array(), true, true, true)">(compare_result(Logical_r_arr * subset(create_r_array(), true, true, true), expected392));
      
  std::vector<double> expected393{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * subset(create_r_array(), true, true, true)">(compare_result(Integer_r_arr * subset(create_r_array(), true, true, true), expected393));
      
  std::vector<double> expected394{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * subset(create_r_array(), true, true, true)">(compare_result(Double_r_arr * subset(create_r_array(), true, true, true), expected394));
      
  std::vector<double> expected395{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot395{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * subset(create_r_array(), true, true, true)">(compare_result_dual(Dual_r_arr * subset(create_r_array(), true, true, true), expected395, expected_dot395));
        
  std::vector<double> expected396{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result(Logical_borrowed_arr * subset(create_r_array(), true, true, true), expected396));
      
  std::vector<double> expected397{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result(Integer_borrowed_arr * subset(create_r_array(), true, true, true), expected397));
      
  std::vector<double> expected398{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result(Double_borrowed_arr * subset(create_r_array(), true, true, true), expected398));
      
  std::vector<double> expected399{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot399{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * subset(create_r_array(), true, true, true)">(compare_result_dual(Dual_borrowed_arr * subset(create_r_array(), true, true, true), expected399, expected_dot399));
        
  std::vector<double> expected400{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * subset(create_r_array(), true, true, true)">(compare_result(unary * subset(create_r_array(), true, true, true), expected400));
      
  std::vector<double> expected401{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * subset(create_r_array(), true, true, true)">(compare_result(binary * subset(create_r_array(), true, true, true), expected401));
      
  std::vector<double> expected402{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * subset(create_r_array(), true, true, true)">(compare_result(sub * subset(create_r_array(), true, true, true), expected402));
      
  std::vector<double> expected403{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * subset(create_r_array(), true, true, true)">(compare_result(subset(create_r_array(), true, true, true) * subset(create_r_array(), true, true, true), expected403));
      
  std::vector<double> expected404{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * subset(create_r_array(), true, true, true)">(compare_result(create_r_array() * subset(create_r_array(), true, true, true), expected404));
      
  std::vector<double> expected405{0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1, 17.1, 18.1, 19.1, 20.1, 21.1, 22.1, 23.1, 24.1, 25.1, 26.1, 27.1, 28.1, 29.1, 30.1, 31.1, 32.1, 33.1, 34.1, 35.1, 36.1, 37.1, 38.1, 39.1, 40.1, 41.1, 42.1, 43.1, 44.1, 45.1, 46.1, 47.1, 48.1, 49.1, 50.1, 51.1, 52.1, 53.1, 54.1, 55.1, 56.1, 57.1, 58.1, 59.1};
  ass<"logical_etr * create_r_array()">(compare_result(logical_etr * create_r_array(), expected405));
      
  std::vector<double> expected406{10.1, 111.1, 212.1, 313.1, 414.1, 515.1, 616.1, 717.1, 818.1, 919.1, 1020.1, 1121.1, 1222.1, 1323.1, 1424.1, 1525.1, 1626.1, 1727.1, 1828.1, 1929.1, 2030.1, 2131.1, 2232.1, 2333.1, 2434.1, 2535.1, 2636.1, 2737.1, 2838.1, 2939.1, 3040.1, 3141.1, 3242.1, 3343.1, 3444.1, 3545.1, 3646.1, 3747.1, 3848.1, 3949.1, 4050.1, 4151.1, 4252.1, 4353.1, 4454.1, 4555.1, 4656.1, 4757.1, 4858.1, 4959.1, 5060.1, 5161.1, 5262.1, 5363.1, 5464.1, 5565.1, 5666.1, 5767.1, 5868.1, 5969.1};
  ass<"integer_etr * create_r_array()">(compare_result(integer_etr * create_r_array(), expected406));
      
  std::vector<double> expected407{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  ass<"double_etr * create_r_array()">(compare_result(double_etr * create_r_array(), expected407));
      
  std::vector<double> expected408{0.314, 3.454, 6.594, 9.734, 12.874, 16.014, 19.154, 22.294, 25.434, 28.574, 31.714, 34.854, 37.994, 41.134, 44.274, 47.414, 50.554, 53.694, 56.834, 59.974, 63.114, 66.254, 69.394, 72.534, 75.674, 78.814, 81.954, 85.094, 88.234, 91.374, 94.514, 97.654, 100.794, 103.934, 107.074, 110.214, 113.354, 116.494, 119.634, 122.774, 125.914, 129.054, 132.194, 135.334, 138.474, 141.614, 144.754, 147.894, 151.034, 154.174, 157.314, 160.454, 163.594, 166.734, 169.874, 173.014, 176.154, 179.294, 182.434, 185.574};
  std::vector<double> expected_dot408{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: dual_etr * create_r_array()">(compare_result_dual(dual_etr * create_r_array(), expected408, expected_dot408));
        
  std::vector<double> expected409{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_arr * create_r_array()">(compare_result(Logical_arr * create_r_array(), expected409));
      
  std::vector<double> expected410{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_arr * create_r_array()">(compare_result(Integer_arr * create_r_array(), expected410));
      
  std::vector<double> expected411{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_arr * create_r_array()">(compare_result(Double_arr * create_r_array(), expected411));
      
  std::vector<double> expected412{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot412{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_arr * create_r_array()">(compare_result_dual(Dual_arr * create_r_array(), expected412, expected_dot412));
        
  std::vector<double> expected413{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_r_arr * create_r_array()">(compare_result(Logical_r_arr * create_r_array(), expected413));
      
  std::vector<double> expected414{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_r_arr * create_r_array()">(compare_result(Integer_r_arr * create_r_array(), expected414));
      
  std::vector<double> expected415{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_r_arr * create_r_array()">(compare_result(Double_r_arr * create_r_array(), expected415));
      
  std::vector<double> expected416{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot416{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_r_arr * create_r_array()">(compare_result_dual(Dual_r_arr * create_r_array(), expected416, expected_dot416));
        
  std::vector<double> expected417{0.1, 0, 0, 3.1, 0, 0, 6.1, 0, 0, 9.1, 0, 0, 12.1, 0, 0, 15.1, 0, 0, 18.1, 0, 0, 21.1, 0, 0, 24.1, 0, 0, 27.1, 0, 0, 30.1, 0, 0, 33.1, 0, 0, 36.1, 0, 0, 39.1, 0, 0, 42.1, 0, 0, 45.1, 0, 0, 48.1, 0, 0, 51.1, 0, 0, 54.1, 0, 0, 57.1, 0, 0};
  ass<"Logical_borrowed_arr * create_r_array()">(compare_result(Logical_borrowed_arr * create_r_array(), expected417));
      
  std::vector<double> expected418{0, 1.1, 4.2, 9.3, 16.4, 25.5, 36.6, 49.7, 64.8, 81.9, 101, 122.1, 145.2, 170.3, 197.4, 226.5, 257.6, 290.7, 325.8, 362.9, 402, 443.1, 486.2, 531.3, 578.4, 627.5, 678.6, 731.7, 786.8, 843.9, 903, 964.1, 1027.2, 1092.3, 1159.4, 1228.5, 1299.6, 1372.7, 1447.8, 1524.9, 1604, 1685.1, 1768.2, 1853.3, 1940.4, 2029.5, 2120.6, 2213.7, 2308.8, 2405.9, 2505, 2606.1, 2709.2, 2814.3, 2921.4, 3030.5, 3141.6, 3254.7, 3369.8, 3486.9};
  ass<"Integer_borrowed_arr * create_r_array()">(compare_result(Integer_borrowed_arr * create_r_array(), expected418));
      
  std::vector<double> expected419{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"Double_borrowed_arr * create_r_array()">(compare_result(Double_borrowed_arr * create_r_array(), expected419));
      
  std::vector<double> expected420{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  std::vector<double> expected_dot420{0.2, 2.2, 4.2, 6.2, 8.2, 10.2, 12.2, 14.2, 16.2, 18.2, 20.2, 22.2, 24.2, 26.2, 28.2, 30.2, 32.2, 34.2, 36.2, 38.2, 40.2, 42.2, 44.2, 46.2, 48.2, 50.2, 52.2, 54.2, 56.2, 58.2, 60.2, 62.2, 64.2, 66.2, 68.2, 70.2, 72.2, 74.2, 76.2, 78.2, 80.2, 82.2, 84.2, 86.2, 88.2, 90.2, 92.2, 94.2, 96.2, 98.2, 100.2, 102.2, 104.2, 106.2, 108.2, 110.2, 112.2, 114.2, 116.2, 118.2};
  ass<"deriv of: Dual_borrowed_arr * create_r_array()">(compare_result_dual(Dual_borrowed_arr * create_r_array(), expected420, expected_dot420));
        
  std::vector<double> expected421{0.00998334166468282, 0.980328096067579, 1.81273966996263, 0.128900053543201, -3.35493615536408, -4.72165487987144, -1.11119127605978, 5.17568018489372, 7.8561074678452, 2.9037950973791, -6.31321355381811, -11.0395337290643, -5.44073432086868, 6.6634651832781, 14.0902623813456, 8.62507273186583, -6.15134981666255, -16.8275115868961, -12.3317791565545, 4.73363337247453, 19.0774035283227, 16.4114568140031, -2.40086875887216, -20.6788281966347, -20.6948387628993, -0.821658021204217, 21.4889913192639, 24.9979293386156, 4.87400556240957, -21.3884888852194, -29.1276535772275, -9.66268556643498, 20.285762337521, 32.8878621887211, 15.0627818074205, -18.1208039248054, -36.0855290461562, -20.9210321825847, 14.8680005652327, 38.5369716827138, 27.0598005150441, -10.538026421917, -40.0739231164072, -33.2818405143763, 5.17871869067492, 40.5492855305206, 39.3757323546623, 1.125102733779, -39.8424028977037, -45.1218532606755, -8.25288365802932, 37.8637004119679, 50.2987277944595, 16.0506360619649, -34.558553346922, -54.6895916212299, -24.3342468487359, 29.9102663535126, 58.0889947301308, 32.8937241110344};
  ass<"unary * create_r_array()">(compare_result(unary * create_r_array(), expected421));
      
  std::vector<double> expected422{0.02, 2.42, 8.82, 19.22, 33.62, 52.02, 74.42, 100.82, 131.22, 165.62, 204.02, 246.42, 292.82, 343.22, 397.62, 456.02, 518.42, 584.82, 655.22, 729.62, 808.02, 890.42, 976.82, 1067.22, 1161.62, 1260.02, 1362.42, 1468.82, 1579.22, 1693.62, 1812.02, 1934.42, 2060.82, 2191.22, 2325.62, 2464.02, 2606.42, 2752.82, 2903.22, 3057.62, 3216.02, 3378.42, 3544.82, 3715.22, 3889.62, 4068.02, 4250.42, 4436.82, 4627.22, 4821.62, 5020.02, 5222.42, 5428.82, 5639.22, 5853.62, 6072.02, 6294.42, 6520.82, 6751.22, 6985.62};
  ass<"binary * create_r_array()">(compare_result(binary * create_r_array(), expected422));
      
  std::vector<double> expected423{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"sub * create_r_array()">(compare_result(sub * create_r_array(), expected423));
      
  std::vector<double> expected424{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"subset(create_r_array(), true, true, true) * create_r_array()">(compare_result(subset(create_r_array(), true, true, true) * create_r_array(), expected424));
      
  std::vector<double> expected425{0.01, 1.21, 4.41, 9.61, 16.81, 26.01, 37.21, 50.41, 65.61, 82.81, 102.01, 123.21, 146.41, 171.61, 198.81, 228.01, 259.21, 292.41, 327.61, 364.81, 404.01, 445.21, 488.41, 533.61, 580.81, 630.01, 681.21, 734.41, 789.61, 846.81, 906.01, 967.21, 1030.41, 1095.61, 1162.81, 1232.01, 1303.21, 1376.41, 1451.61, 1528.81, 1608.01, 1689.21, 1772.41, 1857.61, 1944.81, 2034.01, 2125.21, 2218.41, 2313.61, 2410.81, 2510.01, 2611.21, 2714.41, 2819.61, 2926.81, 3036.01, 3147.21, 3260.41, 3375.61, 3492.81};
  ass<"create_r_array() * create_r_array()">(compare_result(create_r_array() * create_r_array(), expected425));
      
}
